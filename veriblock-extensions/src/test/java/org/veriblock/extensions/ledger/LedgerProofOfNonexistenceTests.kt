package org.veriblock.extensions.ledger

import io.kotest.matchers.collections.shouldContainExactly
import io.kotest.matchers.shouldBe
import io.kotest.matchers.shouldNotBe
import org.junit.Test
import org.veriblock.core.utilities.Utility
import java.lang.IllegalArgumentException
import java.util.*

class LedgerProofOfNonexistenceTests {
    @Test
    fun type1NonexistenceProof_1() {
        // This proof proves that the address VHeyHqn7qLUgS6ZvmcDxjAwHgB5iNL does not exist in the RHT identified by
        // 7BEBDCECA669943E16000F3B657322B7AD0D5DD012660A59 by proving that after routing V, H through the tree,
        // the next node contains "eq..." where it diverges.
        // This proof is pulled from a tree with 1000 addresses in it.
        val verticalLayers = arrayOfNulls<LedgerProofNode>(3)
        verticalLayers[0] = LedgerProofNode(
            "eqQbaP6peSMDDKz8BP7mbW66ZyR6".toCharArray(),
            LedgerValue(1811251, 0, 0)
        )
        verticalLayers[1] = LedgerProofNode(
            "H".toCharArray(),
            Utility.hexToBytes(
                "4D71E470BB01EFD22658E319DD7D0DF552A47C986C2F84BA631B9891C08FBAC141381E1990B3FFA04021680200BABEAB291EDE2BB8683F639A79A321CEA408248874DB69F0F15A7AB88DDBB77D1307BDA82C4D689FD3661371DC04F795F5B24D9E8150E3213F792DEE0C88D09A97346AD84EE4D324DE92E97FF75DD8D6DD298E9CF917E77D3016C2D8AD51C9274CF423C6CD2B621D76959ECB74FC4487F05D7DC38442CA8FF457DA7FA79E26A8A94443604A9195DE3A7AB807849B4D9D38064E469CAD2D065F13CE47273CB8A0B6C86E0BA8C077432B9C2AD0D64F7AECED5F200C24B183E3967A2239E7312612483C730EB460BC047B2C5197B8E24A4123B116AC92644C63529CC0C359AB1828B7917F91D5956B792DA2A677D7E2D0A44BD2F45199FED010E92C94A4BE3A7C8535917DB56DF63E8854EFE295B548F7DCD2EEA6F55568866AE83AB1E99262420F8D56B979FEE0FFA1AF316102FA92D4C03E2D6F888C5107DADEAC49023C36CE5B0CB04CD9D0285A65B3D59240E1186BAD972C70D159FB200A3E38A02D628F95CDD956D7DF19684383A87F8E3AB7F7B393E55021EF8487279DEDAAD970A624DBA3110E3089F776D068CDCE4783EB5933C027E23D4FA88918DBEBD4F615D525E91D79F6A69DB0F651FB5A1346097F2A4007E330A9DEBD5E2C3C0995E323EF54112FDF3909BA634C917E9383BA5C344D1E49E68F990507B2987F92769A210F0F9A5A8B04C77E1054AAEE4716B6E3481F4F67C60333D07E87974C3557B814E7C4CCE65EA924ACE3CF9B0CC53DD05FD3A85777E1DE7921E97CD68BEC80218E0A26933BD03D9FE1F7BFF0A5CAA8924B00E8C640069A2AC490F89FBE207F4ADAE0A8B27E45FB8DE09DCFC7064A8C734867F68ED35B8EE5"
            ),
            Utility.hexToBytes("E73D4AF70718767D475DAF331F53806014BC379FDEBD409D6DAAEF04F15F2A8995D4BBB1ADDA8D672F25E0798E12895D037A24B0AC71A1AB79A19C87FAFD126BB8B1D08A235B0B6AA8765F4673479745999476E5580E4B623D9A00460474E050AA664CFC78460CCD0BA2D27A7DEDEBEC25CDD5A5634802F5867947FF2E1856EB00FBA35BF29D6B56B71C8C66FF2E0C864123C87940907E056689EF9642DE3419CDE99CCE4E0AC76F6DEB7E4EB6BA9CBE0DD846958A56EE59A998094B9E8CD03543890485F71F19D7CCE29E4C493BF8C91BCD21F51D4E082D7CFEBED108EAF6CBBF30A7D0E6CEFD382DA93360B7132A647C34A0B69A9C1A8C9E5A3207B2B46514B2A77A9658D016FD1FF7D4774C2A113CD0CE8F3875EB46C86AB063BCADA0C308F0B4646E88831603354C53D9EE0D8FEA774041E241B9A7A3017E91ADCBA676AE")
        )
        verticalLayers[2] = LedgerProofNode(
            "V".toCharArray(),
            Utility.hexToBytes(
                "5F40073859A8A4E4FEF7DE6BB13902967E491D8471C8DA4B8DD3A95B8755E2E4810C18A5F1D9E9A273931345FF4BDD4F5E64980C861FF74EE7B4AD76A44F043DAA3CD5AD220063907C5B184F1F9045491B01340CF3F422E02FD66C99DCDCE6193CAD49F3136780017ACC39DB6F031041F9DCEF1AE32EFABBA9542EBC94E9A29057F43CD7A164F7A11B75A74949965BE67286AC84EB9AC550D97B7EB229BFDBE1EB4E797DC3CEBE849AA1178E7F93F16108FBB58BDAF0ED8AABFC9C1BE23D7D0DE5E53AA591BCC86380BAC16EFF02A9568C78EC255989D76590C530901BC5EA6E8FAF405AD14082446413616FCC2FAB6C7323A047A9D6EB8A526F9A4CCDB8D811776CE8DC179623C44CCFD25B40226E936D61264D3C74F082D0ADE06DC2F723B3F2699A994E8EFBD93E16C173142F18BC9F19E2066BCB4B2906182D6D03C26EDDE147813A6F09F7FBCA78F0F84D6A1ED75ACDCD21A36A9119BDCB29B53C686C4108CD598E170D6A59717E43B77A58E93D6B7368F95415C38646F9D549051E2E87898E991AC58777A2D25BA0B22B82437788ECD92AB9AF0C47EF8661230F93D799DA0E782C04E011071938664C17166C462D91A6C1C2DEE0A3392A72C83C5FB49515D8BA5FA1D994392B7F2785CDBC08E41A757616B7033EACFA8DC6B2F86F48E2379D2375DCAD289C364CA2051A24B47C843AFD41F69C81D3DAA9FCF934CAA073"
            ),
            Utility.hexToBytes(
                "66E0860795CD4DC38A2414D817174B9562A0E2132C548EC636A7C3806F0058389C37BC421C446FE46B77A0B61E2030E8877028EA5DDB646E9867F392DAE721DAAC0A3EB20885351784A235192BE61D028CDF3505209D97BAFA9B9A00F614862DC82A81DE826CB59DB01796193A1F416C49EE7CA8D2A31C3DEC8D05572B6B20E57E53D8C52EC37FA05EDE4279A2BB249F3BB02AEACE43F9CF47CD4A2338BC35218386E24699961A7C3620780A3FDCA5142E9E3E30B73E228F8C2E8953942F066195D26FE2B8BA6AF5A14AFACA034D6E9FE9BD9DEA58D1AC627B2D3CFD0D4E2C3958335AED080C5E94B2B27341B5894CE9DFCA403C7DB63B0D2FFC2B631A6F46133C3E6D08C5897642C9CE81FA4E450190E4A6044E1B2D34900B2C3ADB64005D974298B367105D6B5EA4346BB65EA95ACAF3C8817135A2D49F501328F064BA85EFEC864C55424FBF0AAA0C8F5E5CDFC7FF4D2A75128F9C2694668219543C907B560CB4D991B29343001D75BA06200290E2302CFBDD7F6172BED18ED6779DCB516F294E5C7CB5F87D5D77FF340A76B2282E9B445FE744F3877CDDD7B2DEA5AA3B6D368448C9E4919516FC596B51BAC0E2E45B7113A70FBBD672013C29F73141382DBF4AB716F8E18B2B38E2D67DC2D1CC3D471C7313A78B36457F660DC71A462F6728EB4DC14D434F06F0450F12DB49D460C819CFDAEE87BF03EABACFA729D2BD47B6B1C3F12B3BF7753DCCA75F87FD6FB5473D7084D8A1FCE62ABE01AA803B605889D98B1E749FC931607103814C0B0525210086853D905D898FCDEC377A106ADB611732B4639BE8B0189A54BC9E17B395DA2DC792342A6BA8498CEBAE814E559938A34A7B25F990C413EF260CAE3DE35119AC6631F81DBA61ACE348BF7732169278F64BD607572625F9A434F7C34F40E336DEBDA27D053E9216305AB1778E19967E51BEE26370B58F2844C40BD6844752CB0F352A34DC851DADC0B85AA239C7BC23932135F3537108415C4BD23B5DFF4D04C63D371D8A0046D946A601CB0841D61CE3C30419B0D4F9FD111B6526675A9109A13079D6E581666574E11DFE1AD5313E5AABDE390C2DE1A8BA9AF6534E80E2AA73F8B64B93C88E2030908C075C6F2A"
            )
        )
        val address = "VHeyHqn7qLUgS6ZvmcDxjAwHgB5iNL"
        val proofOfNonexistence = LedgerProofOfNonexistence(verticalLayers, address)
        proofOfNonexistence.ledgerHash.toList() shouldContainExactly Utility.hexToBytes("7BEBDCECA669943E16000F3B657322B7AD0D5DD012660A59").toList()
        address shouldBe proofOfNonexistence.address
    }

    @Test
    fun type1NonexistenceProof_2() {
        // This proof proves that the address V2cypxmAX9xsbpr6VRTBhofVoBmokp does not exist in the RHT identified by
        // E32D803588EF69C5DD029D97648CC3077BF5B8187A040940 by proving that after routing V, 2, and c through the tree,
        // the next node contains "yq..." where it diverges.
        // This proof is pulled from a tree with 5000 addresses in it.
        val verticalLayers = arrayOfNulls<LedgerProofNode>(4)
        verticalLayers[0] = LedgerProofNode(
            "yq7eoe9dau2GzDVgtsrQZtCAEEm".toCharArray(),
            LedgerValue(4667724, 0, 0)
        )
        verticalLayers[1] = LedgerProofNode(
            "c".toCharArray(),
            Utility.hexToBytes("BF94ECA80529B6A2E75138D14917F92EAF8DC18AF05F046035650170B40A1C2E"), ByteArray(0)
        )
        verticalLayers[2] = LedgerProofNode(
            "2".toCharArray(),
            Utility.hexToBytes(
                "242FB035D460954B0E3C4354F13E6CDA37F72C579C0E633579C97790D8C49C91CC86B725199C13269481869757FAD0DF0A3A8A07FE0B7390FB7017CBC531D84AA662F3488D58B108B84F99BBC35CDB2750A0B3F917CE1523A628DF134C0BDB548063749BF030AF148B24449811EF5FA2B607519C03D0C556E205C2E9CF5F99F81DB5896D9F6E02872902A05258854A483721C767F765CA39FC046C1CBD097DC728A0669598E94AA83BC212740F142CF0C36E5BDA61825E225F957640857E5751F1BE09FEDE4D032C330987F82D0D7D5A715CF1DF5925F7E5BD58F4C4B156D1A9B2ADBBC0BCF254B60C4EF016CBA45DEDBF6AAB1189AAA78002F13B7AE3583424713F803CC92BD9D88D0ECE97062CFF2FAB020DE69AD63C10F39F7E75C29F7B56DBCDB011003A9768F006532B36C1641D145ED9E59568B7660DD74E211930F0B75550320847A9536333A45C9880D440D039248C49F8F430BE794369CF6CF2F140F121D05ABC8253393137F06A00601481895E551D8E4D03FA38986D3EAD78EFFFF159E1FBEC901078EF7BB4050515E7DBA48DF1D1F9B2532BB07CBBDF1453E77511BF7FCC0DDD5AE12596A704CAD289C6BCCE21B05604B8E5E23BE93B3D872BCBD2336D70E1950566183A6B2CBF4022BDE3DE85FAF17AD21CDCE0824EB0B54B54CDD3431FBEE8E0A5067DF2AD037BE33A6BE3CDC239AC97C9B708B0466C29EF7E53B9F0C97D078671A1F53B50E14EB17E81427ACDE0ADE079C65EC426D76A57AE2E1A812544FBEC975B1D5E03A4C9E5E01FB00D8CEA4D56112C4698059217B2E40FE35CB8DCE1F67FC1FADD259CE8595144589A1DDADFCCB9B2838B5ABDD323A5A87AEC454FD0066B3A0E990B8369B3A017A6A40DD38F7BC2E3D103E8FDB16CCE933FF0DA6B98E6AC8FE8D65F3411E4395574EDB75D495D8A8FEBB3FD63380D81615E63504409E06E8898AF776A36DAB0890813B5FB63D03E9F2B0E16ECCB72E7EF68110B19A704FE3DE183F049BF36C6096293BC0CF3B830B57F1FDAB0CBBB94627D4D249A290C9FFA78468C1C9DB3C376978A9ADBE733AF69949ACE0DD41FA5C4AC4675D1F273D494869E99EE882C09E4FC3AC3F0003680E223C1D8A6493E8B95C7C555E0CFEA7DF2A23FBDA21FBA010A5BBFC881A2A12900A1631E651CCAE50B4F2CFD99A98E8DEE95C705F987C26672A90508AED09916B902B4629A7C0E4D6071F37950F7D0347F8614A5A7A07B930649CE9FB1B16C861D0F049113385087008913FD192BB41B7E29B7A1AFFF766E2084A95607CAECCA410F91AD2F3476D4D41FEC1F25F2EA965BB12AB38A7D3E5B4F5EE3EF24917C8D59CA6ECD6475F069A0FDF2F5B1755A1601243AC7FF506CA69FECCBDB86ED3A21D5DB8A478B1D2725215AC17288BD1284463BA7705B2C0C6A0C57FCBF9EF528F2918E12EF3D86175FF711B76FFA1F13B81EF70073544E655BFE48DA591BDC9905CEC325FB555E684ED12B8CDD8669011EE214FE3EF43FADE162BE50D7B16AAEF8F15712CDCD7B6503647ECDDB7B5A3E742C04E0D2C35117A0CC5A580DD949991CBFA1E7ADBDAC2789"
            ),
            Utility.hexToBytes(
                "54384D81E497F9318712E5C86661070CC64EBFA98B283251D61BE919E60294EC70CEEEF4CAC977EAF46A5B8A9FD6BC9929E493AC0B9DB8CA6640A008398619F68E22E93F07ED4704A26DD5B5D90D843DA902EE51EA855E0B6E8FC782F731D84774B77597F5AC180DBFE065DED0C121308201794299BF5D2058EA2885367EBC6F8210F082DB59DB52D740AAA44DEFD5FCD64F00191240A00C407A58D12104EC4FF111229039156023EA9B0EC23AE119F8D809467B6949E3BEC68BA054622340AF06D110A72B9B762E93722A99A1CCF05EF85FC3C56903130D5C2A834E4E01B9024422C2E37EBBFC0653EA68BD5ACAED7F14FA7886CE61DF8EE2230B82F752517692302465D4CBDBFC02FBBC921D8BDFD645D5E6E5C54F801126E6E900A43AFF7710661742B5C972B689363DD7500F1FAD5EA8FC239AB132924FE07CD52ECDB0A9014FF70EFBEA05E9B59FAAC353C974912BA9465495C6B233BFECF52C197487BFED64AF77523312978B97E60E56841DE3167DCC90D068C1DF71ED8491E88420218CEE5B12D38790023CE0BD723BD82248D5DBB9EFFE8C4EC55E95AD3E817DDEFC8792FD784B49814E303B406D131DA71780453C2EFEF4A59700216C4296F4C30A09490D391CD0217FA759FDD1871F0EE78A813E2D3EFF315A731A376A06B8237270181C32F5DE099C8E8B6876826C346C8E0C9F28EA0C7BF1ABB1F82F1EEA89AB3604FC6335AC7B5F77C9ED6FAD078AD684CC7F015D1183C60E437A6E99390A56E37797FB819077F230E76CFFF33ECD0DE99C495A1F76CBDE206A1E0DF272C0F95FF3BD6E8F343B0977B6F48C1D7A4C5C2F1D8D694FD13CF180163A374E30FFB19262B13064D84D3327247DD14EF6E9B1BD60568BD8633A86A4DFD146E24EAA8FBF81C9B23A0325CC4BE8AA76B7BFCCB895A2CE31FE466EF65464C163DDD093C0864A5AB469543DA4A87EB0553A364AB9B10BF1909F141294F82BC398FE372363"
            )
        )
        verticalLayers[3] = LedgerProofNode(
            "V".toCharArray(),
            Utility.hexToBytes("2FEDDA860FE494CBEA85D58387DC5CB70D21231ADCF6930861D42067FDEB2B40"),
            Utility.hexToBytes(
                "9C69530367A44BB5A1F62D0133C80A74C7B9B93259F0D7C6150B85BE1D8C4228CCEB8DACE785FB9FDCF251773BB31257B10E425F0853CF48CE389EB3D9F2DD952275EC5BC412E65DAF37DEB4804498D3F55031D267BD3616449B0B70BCF625A2ECB3FE599B7009EC0DE78ABA6AD820812C3C6E85E52EDC006202BE92C2E238A12FC08C4606888C3392616B1D1E4AC3C690F2A25FDEE357B2E1DA555F6790485C317245FC99B68461A2E71C844295F1DEE2A174D5784FE4DC3B93784D67480382F64F0CF56480554EEEFF6ED91D78398F9DDF103BE1E617CA1ACEAEB16E794C6259CF0DC85152793B55DE495249F26538464BAB9C1C2751F7C5F81BD181FCA93C8D2F86117EA6F109C42B65BBFFB997DCD5DD11A1B2E48B2A2830E71F310666AEEB8DF0A9048602D0844BC435D21B2F97A3F91FB84B70A694F60372DFBDF6AB8AC3777752405873EFF303E16C5EDB7D621785D8826E09DECED9EA6F5BAEC3757AF40FBA4D4F3FDC1D1314B2F8AF752DABD05F5F7AAD1F100F87EF78338C36F509D285AD2B7D390ACC9CC7620BCA7203AE0CA7AC0D8853CF0B8A0533F3B844064C691380080A86D7D0885813064D2A3E0343DE6347ECCEA1BC329714E62290EA554FCC93B5966FD70528D7C8B08480BD8D48F882031A8F9B6A2F58C9A4F3C5DB4CF9B5B1CE64E68E2A98F98292009261412F983C0225B6B97F6F01AF3DCE2BBA183C0D7262EBAC0854392EA4DA3F967639DD053D7CE1700B8B82810AC9A6F8A16CB43C22B2BD5F9F3E5B365F58DD9F0FEF92923509F7D9E0AD59ABD6C96B90D515A45CBDF11D3B58E5EC5877EDF0EECEA864D15CBA46E765F7A660D32A8B05FE329EA662804D064237378F66E55841DC27CB433C822198707B8528F3842F206326D7E4E4E961FE8B959EA103F311D8551C52B149096AE1948D5865299CCB2D8B6F388AC806ED3B84646D0D867721DD16E515997E76728C06A9198B5F2F6DE2CB3362D9F3DE33C0765F21B7E747B59E4F0AB9F156F5238A53A580C3D16DAC202837A2A4DA21AE1795DF3EC388DE8F943AA16AF83D6E2F77499FD371845A5C8549A76E1582365A6E5B225A00E69A9C7547F0414BA6754535AAF5B4D22BAC85D023CC1C51357A90FC9D8D718FB2D48BE252E7AD7AA379756F095F248889C2F2D088350C430B25E75CEDC008686CE6053F892426B6609D1F568DB98C5F6CDE57683CE3C64A1C488DACB6D6108A784154538F3D602857DC0658A375D7570DB1A50ABFACE3F7DAB618F2FE4B80B07F38CD33B2744BDCEF69A906ED2B61806E2FC9E840BD5BA68401C26D7C264F72BA4B6D14EDDEFB22B586C885962365D7B81E36BF41C762636FB5F0DB0221EF8EF2D6745688F7B4894EA60473B79E8BCC9F7D5553E0CD659FF2693B4DB0216B5B15CA998B387F3DBABA8D23A88FA8E7E1F28EB95624F1F7DE0DEA28AA36A9D96BA54154EF98C1C890FDD5A5DCDFAAF9ABBEF3E07C3CF623F25FB81CEF04A0B3CD09E1B8862DF88BC05D20EB0675797853A3765D8520A77721CBF4835D33D8B3440DE18556A8DA828A2BDD06385CA367D8F22923E54C0DA02E3B0560634F37534691FF2B485F80BFDD2A97EF6F129D84C55FC2FB01834020425ECAC530F0B73111067575D11056FAAFE342191A2150984C9258BE80AB41C3CCC885A5573C1CAA5DC9A64F8EC9F5782D0FA7D1A40FDE312BAE37B720CCE6FBDE44079166DEFDD8BAEE80180636B892F03D948A699812CBE6860FC90CDE00B83BA5314CCD60B0D1A96A99F0CF7496674D05489517B5D2222E0A52C72693B8270D2D88F9B57EEB1C352606FD3D1468E8A298A05A67D41C4B88DFB627EB6EF170DB27B42F953E06E95970C7555C857959960B0FED2EBB681E229647012070CE32A63CE0F3644066FF8A561E1ACFA3D9F2F033E2BBF5F28BA3C33F5DB2A252D6CFAC9B2154944FDD289532FD5AA33510D5798F9C11DF2914CA808CF083F896CB44B96AE750D67AD0F6C2719F62B9220546AA8E2EFD59D07F331032100E2D36CC2F9E5C4F4625DE40EACB31A359984F968457968E528B5745FD9B0292A0C6F97CC86C24E98E8382EBB2E89B726BB5FE568957056CFD2AC7DBFF552966C9FF2D63DF9CFFC5BC472B8DB05361E4AB29F279AE0FEE80A3884A737772E9232E54681495E4757765EACE96A96A28DA71614CDA27BF11C4EDCD1E878D0BE05A4FC68CB45830051926202E55804FE9EA37D3F0A4AACF19CCEC7F1FA84DD3DB36F7754068387CA62ED1C66E7149FDC6F14980AB5561F0CACBC55CB8EDD69FE7F2D6377AE566FEDC8D083E406E3D69A880EB40966F0B9F5AAE3D6E2E30CCC0DB07A01DE9A8393E3388BC43C23DBB1BA7C576A708814723FFEC2F0586023BB8615C0D876D55005AF29FCDD6D15D5BC7532A1951B60D695F9FDECFC7F7B605F1799B724DFE86C0DB63BF3C36BF81884B640F0B195724039852E7A8F0D3DA447AB57A15E9E454CE7781119E4FB91810EC16CFC9DB9A55E3B197FDA63C1C35231CCBE2E1162B8A"
            )
        )
        val address = "V2cypxmAX9xsbpr6VRTBhofVoBmokp"
        val proofOfNonexistence = LedgerProofOfNonexistence(verticalLayers, address)
        proofOfNonexistence.ledgerHash.toList() shouldContainExactly Utility.hexToBytes("E32D803588EF69C5DD029D97648CC3077BF5B8187A040940").toList()
    }

    @Test
    fun type1NonexistenceProof_3() {
        // This proof proves that the address VGsgQgHexZAB1vvc5t4eskk4CCNxYp does not exist in the RHT identified by
        // EECD6CDCFAA005F79497540BC3C1B81445814DA9F3CC4A49 by proving that after routing V, G, s through the tree,
        // the next node contains "gX..." where it diverges.
        // This proof is pulled from a tree with 10000 addresses in it.
        val verticalLayers = arrayOfNulls<LedgerProofNode>(4)
        verticalLayers[0] = LedgerProofNode(
            "gXCEkbrhJpy6Jb666afvNEBYa7V".toCharArray(),
            LedgerValue(8386127, 0, 0)
        )
        verticalLayers[1] = LedgerProofNode(
            "s".toCharArray(),
            Utility.hexToBytes("507E3C17DD8081E55C347C7D8BA75933D43E039309CA3DFF2584D7EA2431677D7E2EE2770671947FE208320F95B09DA98766685D42E9BCB99CEFE9E0B1A1B97FDF2EF6177265EA8B63D679B77FCEFA7F5759FF18F04735827B01FD2C72BF80D146F00B5DC9DE27EB4D4F9176655AB4E31977BED9CCA86AB17657BE3A5455D584"),
            Utility.hexToBytes("A73B0363262C980ACB601D8D101CDE85E385E7AAFC25281532008E916783A38402322D1AF3657A65B5E6A32E808F7B6CD3AB73EEBE2826A805C88772F5F2BE75AC465DA7E1AA6BC12DAB1C7FD5156ED5E1F2589946F180BAAB0655C0AA7EE029F358556B8199E3C70B2F438BD452E1752CBCC986BB054FB8FABE188A0ED6176D")
        )
        verticalLayers[2] = LedgerProofNode(
            "G".toCharArray(),
            Utility.hexToBytes(
                "8AD4DB3E4BA958902F9AD296FAD3A71D72155453205830588FB18739E5C59EE6CF032A9334B9EA5BB7CA90372314B66C88B6213C7181CBC8F73B135F1288AF4EE4E4CD151D7A072F52E19D5CD561A4C14B6B85769C20DDCB41162CF52D2B65008D72764C9D2CAFF5D25C2AAD5DE21C39E1D18FBB818FF3293D71C6A4BB97D3EEAC650624AE7A4A976B49D6DB86A71BE13C4DEC63A0B578017627C8C01515A0C8C937843E5C7F5E0DB14AED6F47C6012E69909CFC3BAF94CC6F1CE163A0051790F3E042E68555CF6501AD8F25F6E596D7D9F669EF73EDDC8D65B09B19E429D11AB81FB7BC041C32A5BA5E7785E920951D7606DC5B6F213047E789010BE8151E90D9D1B3B225E74ED23BDA12E8BA540798F02ECF670F1146398C58955A76AF10A9503A1AE8B6397847783095EF5D97E8B8585C10AC267BDFE452005480A874FFF99302C4FDB4E0AE31FFE59112B3A11998B347539CF49DEA6E9FAB7E5F7C486D2D42753B82863242DC1F8877D77E48254D09474ACE7D266EE047F5272FEBFEC989A4BFB643E6AFB3BD930238AD1914978DA779B432421D3ED7048B3D5B11321BF38F0064C817347B8F0C8B9B781D6AF1B43997CE21C01E40A204C4539F64CD38C1F0EE05D1DB09574660C525AA987FEBC832FEB0310C67E547EFC77654C735FD6442C5EB960B28D1679F2ABB030CDF74D19ED859FBAAD9E695E0B75BD693B5B8FE1B9C76E70176755463794FB46981D917C0FAE5CE6CF9EDFB9C9D3F0958916EE3E8002B63683ACD4A12BDA4FFEB220CE76F7130EE89497A1C93F56C4F814FB081D90754BDF7F454F017DADA08998FD62AF0CBB148612C230782A29F0B94FF6C84842B76A1FC9803562FDAC61AC74142C81E8B2A57CEEDEFA8C24E6BD5BF15BFB907A86E92FFC4D0BBC499008DA1299CF06D13E9EE46F510813B7934B78D487C7F42404DE1FAF9EDD47130DF55D83CDA9AEAA3BC785D0EA1237A52559F90B730B79B0C6FCBFAB7DF86E9634E8F80E8B2DDD565AADE7F704A549EAEAF9147377C4A9B4294484EDDCE4FA4BC17AB2C5F8F3706A6E69604C8B978FEE6B3E85FAEEA37BFCBA960567A75DE182429088C50F2B301866EA36C98E78C3C661CA5B0A7CCDF8C3E9B0223B8E5C4147418EF4EBCD5C248E93FAE1536AA5EC08F2E391A19480D11A442EB5F34AC417610392B9A3486B23D21C11B530367C64FDC4C4531287653CD75949571299982E65717FC8E61B2485DCDA4272B5A3EAE5AB01350DBCD88BE30E85708A555CAFF22D4167FD7F79F6A3E1669DA9B6941E9FD36E441A9D4FF08EFA1D0ADD7AF0DB9BCC352F8E7E2386EB3DBB36A1F39D07075F1D63DE426AE81F74F1E566702C4577E64D9C753CD850C0BBC271CD84A86238FB88667260DAA2DE69768780E6C1E73CC3B763CD8705631269F5DDCDF7B7FD6B82CBE8F1B4EA0325F3D467630B2FA1E899C20129E10103074F7E0D2341BA810490E61177035DE53A2DC887D636420AD663540BC35EE702B41CD520C11DFD45C3EE4617CF99410A55CC35048286A825BB8789D737C31E01397F065DDB28B214BBA2BA3692875489ABB73B0007F2A76E190978C0212F40919BBDB14035D45B133595E03B33AD434AD081FF0B5032D35C6FB6351B5075CB2CAFB3B13A8F984CE18E04EBB9CB2FFF71F672C2F753A90868E7B367ADF87FC81496DD617AC674E0F011A1E1DBBC74AE6F4218E4BE232AC9966B1D11F63A5875D106B0BAE50BDB3C06BDD264924718C57AF6836CE6C534D0727B2084751C98FC908B40E1C995DAF3A5B7BF664F490635F578D1B7A011054289800C97D8328B06F455662152EB77DF8E302D89807D1CA01EDCC23350FB1F41CC371926DB3E1037564150E36E2F00547205029073EF6F4B304BE19F77159D784DE84773AD6FC8086FE46F93F615ED9117970CB104EDD2FAF1D9A71246BE0AD6BF950741BD4D2B66A84D29AC1E9B24DAC7A7CD20E410E8C9B117CD064231BC03327E03E1EA6E64DAF9A8C246F5DEBE642FD6C4E457A6A4D7870C410927454FECDA0A21E8335C9F0128A114EF9FBFAFA09899B0AF762E3D122C271064248C3C346B5A62A73BDBF1509E17BCF9FD78E2CB93FD3B3138B6B98E4E2C680888DC666F91642A608EE3FBFDBE4229EEEDD4D26061E43D41FCDC304EE58FA8C261BB2B75E75938FE84FABB215349013A980700032B29E4F4F42E79F2B612052D6D5DFBF27B59659C0EA3892AA8570AB39460A0BF09EDC3B76B2B9DBF1A9"
            ),
            Utility.hexToBytes("D92B8D778C944788C74BEAFC44DAC5604760F5B8B0A3FDE384C5EAC942D69A058A2886D7F3AB7926D140F6D74EA87C932041AD2F5C0DD516E525BE885911480C2B02CA13BBDF2104C7F2B16F28B7184C54FD44B6D80E59C27B69872E3CE6C08F8211BDDB98B83A3F3FE177CE6B515969526A134F32A86A504C7FF27A733AD5C1C3609698E1EA9F8E36DC400CF4E27C31FFA28A118AC90BDB44DB1998C1EBA1EDE6CB4FF692A3097262342AFDA1FF19B4270DD96597E8F99BB6F12EDAE163AC31A32C2374FF3310F1445DD127A96A26511874B7649FBBE1BCC680EDEB1548D692")
        )
        verticalLayers[3] = LedgerProofNode(
            "V".toCharArray(),
            Utility.hexToBytes("66DE1FAD343704D4B3EFFFC83E067AA028346983C95D062D5C998421D8721BF4BA95587E5027CF3EB74830A1918D8A510A83C1979835F047864EB9307468045CB06A256DCACCE4B3731A1C4BE4C4114917230B1CA3B940365A133555270BFE7BAFBD6788822C2A7F4CB92A196E5E4FF283E07FCC5C4F6E02DEF210D40D0B904C5BD9238425E44A7BD2C6305DCEC1151453801DDA2009FE61C80AD741B9B7BE4329C4D9C7F48139CC621CA27244C6E699AD5F287C43D739042AF7531A62326E41C1AE3C2D6E38267F5F4F33E218B121F34E70C4A72DF6D173717F86902ACEAB10CF986151285B13007FF2874C47CEE738293C78CC18CF515D8509684FAB7669331BF82D22FF923BA43970A311AEEC4A08547B4470B27CA315714DA25EB5142C759EE587B7B72CAD8C46D24D47BF45238BFF6827845BCE3A5D29BBE52ADF65428F73DB1FE6190428C345D442EFA3BECCE630262FCF2E316C67C90E1E22BD3826C4D98D91A621C411D5A79565A0502B0233F2F6C449DA16CF65F6CF41C2E2F9F56A86030A07CA801A8503EF564628235494B938E97E4887A9C4E90464387BDACDFD3640969A80573575622156C8F84D4D2F33E5D08A281B7E391C4A7A6B3A3FB6ADA3619D2460BFFB70C3F1C4D54560BB5D20BEEC0A18990CEA682B6428316AB51A"),
            Utility.hexToBytes(
                "693F7F701ABF857ED07E98DEAC776B08E69E4085043D30C9972A201590312765EE7176322828FF87F97B4FB0EEC433A84E26611827D0510B50A0F11B76A7C74C277794D2E9C34C13DA35CC172FDD895A66B0A30EC38E5DEB1847DB63B66E85A40D672EDE00AAC7FF914CCD838F7E5CC890B8B711E7A02D3CAE83794510D3576F7C3113DEADE193464A9735DD841B39CB9F1473C2882D5878AA0FFEFD9DC4E9BBB9F40CD453D6149EF872B5E8F3890EF2612C38B315960BAE85BC1A7AEF451ECBE188EC5D86BBB2A1BBD2FD0FB33B39BA47A4E4390CDB6BC5C4E9AEBA03FF505AD0CEB390FB5B2356996C207E4C73E7D57D67A486C3092A2C5B380BF8B39465E1EB308E03F2D289D343297600B687380FD3C47A82D3BA4AC643BDF54C73526987DBCADBC80B3118B35A75326C861335207B78D50D314ADF3CDC8432D3682755D6B2E5F6A3DB80FE7293568DCE1D1025E4F414ED5CAEE1BB0DCDBF3EF7C50E6E43CCDE51285F69100FAA89A784CF5577533490C96186DFE865F9BA2CF6A1AA8657E2854B5A3F8F943C5705C104993B36549EA3F7F3FE44464F983D6E9860CE526AAE7BB18E2DED837537145D56F9FD51F3E2E577DEBCCCC5F9CFED1760804669A023EE7066654A7FE42EA24F2EA82FBFC096878364536FA014B9CC79EB608117697273D7DD487D6D7A2A3E401905A62138296385A56CED8F6B283C5C8D25E3AE16435F58DB5ECBEA3CB5D7F75470955512EE8A9E6AFD7E228A356369925E6AA5A158F82C7C730DC1A69AAD071B2743BF6E39607DFDA0C8F6CA8B6741517C7A38BF6920D804F2A6BF64761608AB91DE7AAAEB504A937F974C643AED4287DA05B240718156F6E4536BA212BD1A95322557FCADA88914CABDEC3AA00CB835CC764E881171AB5C25E6AD6ECCDF051526CFC4D3C79098E2C0ABC9B417D8FE1870641A38EE71ABFEE7CE26D7C6EBAD4031E55BB087AB6AD517A6A14C772E33BA3CFB7BEE885443DE6CE42511AA1D90412718F0DB0A01026D593B582488835503254D1A2E63AD2E9C30C9A16F3291DB7DD0C9CA8B15101C4C74514A43478AE498DBEEF20DCBD810A683015DD33663FC50B481D92C6248D0DCFC2E9104DB4FF5AF83AF6E68AED9E2D3A6CE3DBFEDB0F7EDACE41DF7DC442B3456FA1EEE6EE09A6413FA87525F314B3544D97F2707751051C950A5462FEF739D68C68126BDAEECC87BDB602B8576B27CFD23D14202A321F4BC0C7A7325F6204869E5C3E86473C750C74085D771C4E457F0B2762CD20BFBC54BFA5F2C18C420CAA4B4E972222A834DA464EC3BA6ACDB4CF05F00E4468F5D6E721F8A78BDFE7B9516593EF03FA79CF24A65DD4E666ADA7E271BB844300CBC8748C444228F0B93C7573E2519DB1CCDFC0E1F076BB5FFC02EDD894A9063335513F40914A24B05BA79FA174DD78918C18385A499C2DD7D685B99C019D3D26F3DD5E3B49384A6BAE4747E469FAA59AF023916B243E9434F812C0EEA4714D2A6CB96EC3CB1CA5E4D4436CCFE55A18EF6FCD21674BA6C3D8D565B1FE692913DE97DA1DDE31CB044CFB166C7C3939E2191E776C24A1E9D38D2783ECD7B365D353F0F0FC2B8923EE356FF88EA805BE23276AE11972FA9F839F7898BDFBEB863286B0634EAF89D8FC6AD37A8C9D72839C7A2669EE80805FBF0790F9831DA59F1A1C397127F5FC78B7180817D58897B98AFBCA76E7861514EFD0F732952A42A94714EEDDC468D8A3D5709CEB23530F6BA1A9A474E913B4405124FC60DFB66ECCC2BBD5A2259BE4AEF77BA43C29B0B3F037BC8A0B9CD92B2D8A010A9D3453BAC26E0AAB0C63EB6DC260B772EB0E1E900C8B81FE00F94B80978AFFB0ED60C283ADD36582A0FB73492AD95B1C4CF4F578E851BAFEAF3296D4ACB"
            )
        )
        val address = "VGsgQgHexZAB1vvc5t4eskk4CCNxYp"
        val proofOfNonexistence = LedgerProofOfNonexistence(verticalLayers, address)
        proofOfNonexistence.ledgerHash.toList() shouldContainExactly Utility.hexToBytes("EECD6CDCFAA005F79497540BC3C1B81445814DA9F3CC4A49").toList()
        address shouldBe proofOfNonexistence.address
    }

    @Test
    fun type1NonexistenceProof_4() {
        // This proof proves that the address VGWhkrXnkps1gweGR1h23e9YQ44fEt does not exist in the RHT identified by
        // 806013B302BE45009DC09223AE252A66B917E0F7648B2D1A by proving that after routing V, G, W through the tree,
        // the next node contains "hH..." where it diverges.
        // This proof is pulled from a tree with 100000 addresses in it.
        val verticalLayers = arrayOfNulls<LedgerProofNode>(4)
        verticalLayers[0] = LedgerProofNode(
            "hHMKbRkxDMBymuUnT1Qorm8WJEf".toCharArray(),
            LedgerValue(344113, 0, 0)
        )
        verticalLayers[1] = LedgerProofNode(
            "W".toCharArray(),
            Utility.hexToBytes(
                "C8AF3B1BB4F17BC85D8E38CBEE3B8DC983D7BADFB1499D678157D131FCD5228F76228465AC14621099E353A4F544AACD46D4D4D52A93B992E718527D3EDD35532BD04C99B5F392EFF1B41672DF2E7664A3FC41E5D9CF21CCDD116E24EF61EDB1B83393A96159850DC8117B2546B012709977F57235A9F320BB172DA44B3752D8BEB72014AEBF721EB7E6AFE3156B0DFE5D792B464F15B30681A693B02E1F42BC2CE3FBE9E3FF8A8FB452789E68DB1701BF8874A5213360E540232145E96E30F769D9337600CF73AA51945C4206F121448F8FD7DB1C4D9FF61DB98FFC2BF28E5014E3B1510F0E9EAB89750A290714B5011C63AE613E7111854BA2C46C566D888EA16C24F481920EA0A0F30B7A0993F6F40B672E2B1820258524B0EC0A1DEFB1DB97C34C612E0F445974269618A16E8DD06557A3EFD90D3207D7851C4CBB93224852BD681F2D5C3C52618C8C667B583E412508BF04111E3409B33B870FE860EA3D1059F59E636B1190DA4FA7CDD965A0AA253269FE5C88368444EA464F845D1B3C7255964B453000BB8F6656AEE6D083959F1D6363F44A07D2F9CA6A63045E7A5134625650FA374C0CBE2493CE1D9CC356EA5B443C8F019506567617CE7E2EEA162DB0750D0F167F0669A3F04E5FFE7CD8A7847B7CE6098DA78387C71DE6DBC058B669DDF315E819E7DCF70AD09DCCE7BCFFBE2730FE674174D98612D104DF099EB710368EDEEFBE066C64F121B3CADCB4090D85709C4338A5279E5F1830E3FF974BD06E61E54E3D9EA34B73CAA6D0D30D3151ECD3509D87207C7BA6A9EB9CFB924FFA49C70047E061B33F34FDE6572B5B34034AE621DD4B78830B3285A008840084CC41DD04CCC5427CE390F827BA844727010A5E1B8FAF05412A651CB7110C90AD195B41A40236C4E1EDCF8998B72A78EEFA45C6C6565A19B9E4FD13C8C40950BE157E3E39830DCC4AA7785174807C30CEDCDB57E40978E96C8EB49C4F3004EAA6B4D9BEAB30A9635EFB74EC18A16EA487816251CC840FF4ABCEB1CE7CF5FA47F6A449FAB1635B8A5DE0D127EFB4BC8952CF1DE16E7D05C71FA2251BD1ED6AFD62E82A434CC4F86FC2520757C5BD1C793B97189F3E11DB336703218C3A30C8B07BC1BBACD47F4F2F835FAD4647D66F2955EB08727DBF6EA2C9D2FC7566ED5998643BB2603E4B6F873DB129FB5FDA1CD75179552F3A05B4E1B414C4449BE992E22A354CCF66658CDA8B802F1A35F54180B8178EEB07E6F2AC5829DC400D0CAD8EC9362CA8F624ECB874209BA794C67D04E093EC575A17AA7CF854BD42FA0A522ABA4D860A323B0B5F88AB71DE81A269584CCC15AB99AFA91AA2F027303B0F78B5207C5E0AC2A4F98703FFC3401CFBEC995BB10F81F6B9FCC3D9610C96BD9F8EBECEF58B8343A05B7F34A85DA24D1D632073F64F7C1372E24DA6C904EA9B3EFD8143510563B35E74088642D0DBD43B600B189017117A1BC6C1DBF3CA488988F9AE"
            ),
            Utility.hexToBytes("600F3D59FD14717AC8B25D0A11308076F1EB1C20CDAF30BDC85F1CD183708621B10E2C779012CFDF6EF16DAD9F19EA77DDE32FE52ED61825FE9CE29DB1A66F4A5E0DA0E430715586AD5C2FA56B0F9285FA4A7254A69CA715322907D741B9240F508222B55C15432B446690E2AB449FD888EACEAEDBEC0FB1D3FC3B64D722787E78CE8C4595BA159AD38252DFD68D3C46793C23AB2EBBEC8C5C2E39A2A1BA7F1CF1FC07293107328FE8000EC58593B434BF73586A873A2F128CCE982B8191E67B4CC9F290A48F513A8E9BA2745B24534050AD9CC2F6C02CDDCEA11D48C480FBF0B379B662A62549A88F69F50E5F4D16F8DD6D1413E0E0C8CB74F22F91BAC30D16E79F11C94EDA31B26E1B0BED33DD6FD27D60162AC8D6B74BA799BA0FDBEAB78A28210DFE4E32409B93381C08FED8F844DE184023672A6E40CAFC0D382EB60128E82A658E69FFBD6915FF5B2EF9618A37C2E498AB50BEB62DA59F813AC197198CD2D9BD88E25B56C8736D0B0F3FBA103D8B68A41D300A392506B00E0DE7C8471198C35745E3BAA9C422096925AEBE13E0A7DF06B29B828C68E5DBDD9B2A3B3E884F9286FF07AEF7CB78201EE0F3F052810E8FEA49A2D8D69673458228AAD75723E4A2DAE8098BFEB215CF0FE5BEAF2352E2306F59E290A6B280A68C1E79A65238")
        )
        verticalLayers[2] = LedgerProofNode(
            "G".toCharArray(),
            Utility.hexToBytes(
                "29ED6D89D0EDEB87CF5630A95018BB9211DE90EC3AFB69D136A1D77AA769A3DADB4825F213E76A4EB69EC90D42A0D979AE4B36D38A0AA0A192A8F897F78D99EFC68508E4FD7F03114994FAEEFCCAA2215D9AE77E294712338581FC82A2309D447CC75ACD6F0303EEA9C6667DA20DA1AE5658757EC16D37EC650CE030D25A427BCFF5F5E831344EF9251F2E2BBDE1B7D6F8332B9EA4022B27FDB394424176DDBEB44C498FB187AA1EFD7A5050C673FBB5E41C3AEDD3D58645F659882646266E46D061955BF69C610E14C8D293FAFE27BA3A27D5E7D9AE7ABB6AD57638C3664B5894CF3A5A35E0F3F2EE529169053EE015CD110371A4B71F0DB2F583A92267A6B417608A6301F96DA9ACE23A8C9CD74EC822C6C1610522B794E0B8A5861380907CABB5A73555A65943AD968E7476A0370DAD04FE9AB778E3002A2A2DA5B91C457A8A8BFCE3EB112CB9E62C6117B04368711EF401D4D73DC5725FA7373B255ABC0541FA8AC56DE0F082FBD072957FA4699B7110FA66746D47B048CB07E25C87B0A21CF5BAABF704580AC3D28AF3903D25E051183349B19A4F469B2884DA03D2F2A53D61D77381C6A769B703F9D4AA6C6B179F1F7F1BE5C767594B7E5DA15C12E86605EE411FD86E0239639F15DE7B745B7D0C6404A2AC78B6B5A3C4EDAD1D93B40804113369A893529B639226147AC4ADA816A495BF0CB81DAA84CCA8D4DC1114142CDF5B4EC2FE09067D34C79D934F62A6818F54498390590CB5F3FAB8581152EE0C02A0A08CD760A3029B1A1E32945701D7B15ECBF245A2D50139552CE818C5AFD2B08856D3FE0647C0648053876B0BBCB8E4017A10823C61D02FAFBB5A4D128A5D88137AA447592DA94860C70BC3CF1C802A3E1AD036C87A60D465C3A9F1CC85C36A7B52F8C91551217EE5B7052DBE70827FD869F0A746B82F194944F4B02E34E1A9FD960BE3716FE71F04062DBA054423129C64C04D3F190FE6A5ED80B3BA6CA167052BF4A1568DEEDD13636365CD4976514A97C5F928A82DCE479BF918CCE6478BE4CF82A6445C946DD4892CF1460E9497E3FEFBC64695B132EAC4ACDED844948A36587AF57549EA6E12B5DB8A2A5F934FA9A8AC1211172C968035FAA4B3BE46789B9B664FA5745B4CFE8E2FAA5FF8DFC75B03EAA5698E7876A6EA96337CE48696F8B7B56AD9E4F9CC7FD76D9826A621DBE79F0D45F45076F3AC2FB1217999CAD051EDAA6FD676E595A2C39CD11FC475307CB69314A3529B1E67080D4A39508D97B4D57AF1B81C38E810622BDCE7ECA2468016A5A40E29FA46FBED910F9FE8"
            ),
            Utility.hexToBytes(
                "676C4551FC844A8C7B292947ED56F30337C65FC06DE08CF05EAE177EF957C9465DD8A9B76814A0B5C1D7309CE8AA81BD54FD9BE2D00A866D061351F62F6090B650A819D929892853A985EB64041B0ABAC7444000614C2759884AC8F7C9DCF30834C40A531AC58A1F75525B6D48D430B9218052F75CE41EBA28A938C7BA6A490C264F4C5F25DC1B5CCB89471FC52C5F576B4368A967A1DE0E215676E195EE95C615AEF9F5C4E5EDD3228D1C0ADA84719CE595D5D5DDB989E086DD4C52ED8E7EFE5AA4A7387F861A75D1B46505E8697615A19BBEBD327B4FFDD9EA77BB3A65D68D77BE4402A4F3EB6D9B23FEF47E59E387A88D622F25EFDC8BE2082383613DE12EFE6716A184C2B29B4751243F1345396222377AC45D56BBBE5AADBB637EE454693667C1E9372B4B514E6D218FB4F753E6BD129B8116D72963D6375B4BC5DDB20689422BE1610E1283A88EF3439710FCBF49076990F2C73544D95725515A886992DAB9E0BC6AB1CCF1C1C2F786D4D07B4CF0FFB72E353B79C3B99C65E5D360277A61D4152D95357B7078E8A7497A9D6DC3915DD6BE542D6C3A99408647220B42B6AECBF91EBFC195316F2D64E566C374EB221BF0FFEC3DFDC4947B2BA19DECEE16ED40782DB4D4405C9BBA9A6219DEBC546553A4F6F956CC7A0F8F2948474C415B02A141DDFE6CC825D7027132B01CAEFF4E0B6E651720EB9DBA56BF1E52A6FCBFA03721D771653901B881CD3EB89AC9FD95914AF5AA83881E10C7006426DC4BFEAB728EFA3247F05E1229D3659379AE4617F268C7965EF8749AE53ED5EAB7A9A44F829E34F56A3404700124D7EA516B692A0BFB61F7A5CA37B0AB7BE833BB4BB8D6C0205ADE82A9DF0B064659812095C8264D453FAC7AD90DB7A18B065B9B1FA2FAC14D895BA932E3427F4D1C7CC799C5A3F533E124A618D563F2F254150A5BB10D171BEE0698797F4CEC3AD9A3E6C4DC31EAE918558C6106151047451816D0B9151D5EB7AE98B96599977DD881FBFEFA2DA3EBF658F1D3A0DC5FD3613AF65AACBD556F5CD48E0841E3E3DB5A63ECF037490F4BC7861E77C751CE86E2A57DC41DDAF02F93492039744971E42C5D3C21586E951B18B5FC54B1B07B0DE01A1F29B25DFD4AE3A252FB1FF88BBD083EEE0A7908F791EB03B8669384E396E81CD50283FF5EB8F1C07423B4E329EA70FBE78AF11554A6B59949033A170FCCF94C247D9F21C4D7A22DFAD8D8C3D0819C1CABA107B724F4606F3EBAC076D1EE4C8D507121"
            )
        )
        verticalLayers[3] = LedgerProofNode(
            "V".toCharArray(),
            Utility.hexToBytes("18A480E67D28718FD25B5C8835EEC67A839109D67EDAFB7ABA68C59543958E95D9B675B3891BAE33F745E9850ED63AEDD7D0AC2A734425E71A20B57D2863BEB8EDAFB723BE2A802AF3303A52D8FEEE9295C1F54389AEDCA98CB128FAC9BB5EA1CF2777F3D2B76AA30D878F194840CB9558FF5AB3056C45F467BBB3580943F7AE2E0CE4AF262373D40C35DD18E7B9BD74B70F8333A9BD4D298AE6AA9C566F27F56533016F4F3E73779D4B9C1D3FDA3247D76347E93730060794B34A5A838B605B4C39A189ACA2EB5ACBEB01B986FB48D181E38861800737C260BA51BD70A220A1CE212CEA7DD2F0894530A923EB63709880E21E965AAF91B85D7F2FC74C75737D28DCC98B1A9A386BE5324B8B3F5D95C1DB676FAA9728CAA021F8516055FDA3725E70FAC9AD75D9A16D065187A6534C0301CEE3453B835B9A6300CE9345714CFAD6FDED82B80C2DA3E01CE1B71ED3CB783292C32F70B971D635E38974F4D7FE460250EE306CF109D7F43084529878B19CE2319BC4AD25F8ACDD18D253C1DC9709F81F5AFDA5202224876B5E7FA53B28ACAB9213B10128F2491239890337E2673FFEBCA3E47C1145025CC0F02366848D365C048C34A13034E98E877A1B0E3EAF8752EC91AB22118DA126567F21BC5FEC0EA8D2447EBB1E4253782F9279F66BD773"),
            Utility.hexToBytes(
                "A7515F86DA3CBCDF50865A21E26EB0C21D76A86FB31D523EA2965071BFE23E071F36EAE4DFD6F3A2532519637C5BB50F8BD4C837FBB5DB7B8229A2C482A1686B07C1A81174908E056E8FCFDF38467436B145B862FEEC363B12BD3BCE141BF8B9E5925A4B30AD8D32634FA9C87D18193AE5A79B6F39D2577DA200704240644E280CBD3B7C3893B2A06199CE438EAC494BCF728B470C941F070527B445B7FD0CFEB5AE6408FDA41CDB143DB0027479762D00334D89A28649555DFD16BCA3E42B71BFD44AE6671A26E55E315A90841B86019BA8C3DDF245F62657F756EEC4B47D9EAC7026973590961E56502DB75379792CF6E742D6E3CE4C647A16D1B776446C62CA191EBAFD44FF99434A2D42195AC5549C89C94162ED1CBB52BCE705317C80A7616BDD2D27C1D851A8E876DD4EDC1EF0197478257EB71D36694029ECB8D0BDD342914F46CC60018A9E69C2A46BECAD61F1559117C598640AC2856CF7B7FB27FD6D4EF43B00419EB0795ACA392CBDFA1DAAF8A9A3AEF2CE77D3B011D3C24A5B8C16802EFE031220208CCBE09E1E804A97C20DFA93C8B4C8A39A3134861EBD746433D96E1A72B9D445A8537ADD5D5CD6E900F8A1DD30F7AD923AF6EE19BF2722CB654C0B0DB45B5BE511B3A581449F48029DE1D35D69339C2A399547CEA7B6E662A234AC73FCCA727264E692DD7CA91FD65C8926C7216D4DEF81BA56D844BE9D2FA075105D7FFA6A17B5928A1DF85EC4274F7568F175071AA937B43342BB9C9FD24A63B5DD40F345C2F6AE71EE46B6FE0223A78E9FAD980CA419F4C2A6F1AAAF1B31A1797E4C0C609230D175B42BE1FEE288E10D89A8A0E52A62A7028220E441A1A176C9BCB0493A165A05CA7FFD79DACE5BBCDD1D7DDFDD5EC7C275DF719757667C030FD91DB2411EAC608E5EAA4A365ACA60676DBD2E9B01E74596097FF5F3028B73614F9DAC4E392D70A66FBD30C2A29BA78FFDAE8B2EAFBA2B03D80F44ABF3D798A30E5A984AA774E020456C573B2561DCC121C773CFF0ACE5A9890FCC5C2492802128EA89ECAE0CEE61C99D859A1C2FDD9F511C82027C79BF12AE29D03E025906CA4B8E45D2258B49EBE3508383DE60FB6348B14347E0E13F9455D743EE1F7E1107B2B47BC016753A678723341EE596E66346CF2B1555BA7148E10598E400DB1A887E3104833449AD5A599CF6BC611B1301111995DE845A0B63F1F5F5CD28D37A90C27A71A67B27F4B049BE45BBA164AD7767ED0753AA98741FC3E40974D515510ADAE85CE2A3A0F122754F331EB3DDC885B4A420C270AE0E3C63D361A9529EAC4E1CD950CACC4E8E0A63EB4679C9D3BDDCD74DCE852DD5226F26E015A19EA8FB4E54C654B583A3FB093B2B2020CED4F20217C3DA2D0EE8787097B21B89AC26352E0AD9494A16D230C5EF7F082057A747C9BE6279B615AC517454948138D5151FE89D5373E8123470AB1D68AADCEFB885F4AADF9DF53E03E4F5FF3594D5969DE6CD7A7F70E43240A81FF128B003A6D46433FB0CE74BFE22AC6FDB33406EC4D5DEE6953F29402D076757A021E6EABC83AE73CA5B03444235B7B7BBFCE35152D49DDE9DC0FDA5FFD48DA113C6683415E96ED0705A25B51720F13682223091AFEA2CFC00B495A595A5C167C965C7C1D0BA16AC2F22EB6D6AEC1D1E6EBB5BF234C48402E5D0D5E2020CBDFE0185FDC661ACB1A9DF38320D52B26135C06248EB6B930AA5B34745CD9D27111DFD153E6531585F632C2048863D58E3C87BC736F002B21C2124776F8410B5236FFACE73453E423C0C5B00336C875E444FEA2A4B706731D0E1B3FF7975E2AAF3988ED2D6A1BE32D6F2BBC2ED9C07F31CA57D15B9666FE06C69AD67C190D363A640B813086C0A7796C25008B269A1B3530D4B2143F5A1"
            )
        )
        val address = "VGWhkrXnkps1gweGR1h23e9YQ44fEt"
        val proofOfNonexistence = LedgerProofOfNonexistence(verticalLayers, address)
        proofOfNonexistence.ledgerHash.toList() shouldContainExactly Utility.hexToBytes("806013B302BE45009DC09223AE252A66B917E0F7648B2D1A").toList()
        address shouldBe proofOfNonexistence.address
    }

    @Test
    fun type1NonexistenceProof_5() {
        // This proof proves that the address V7phxmUtHMffRSE2R7unrXZH4E7hX1 does not exist in the RHT identified by
        // 912703605340B1AED1F430C38C8DBF9D2F1021F244CF9EAF by proving that after routing V, 7, p, h through the tree,
        // the next node contains "xc..." where it diverges.
        // This proof is pulled from a tree with 1000000 addresses in it.
        val verticalLayers = arrayOfNulls<LedgerProofNode>(5)
        verticalLayers[0] = LedgerProofNode(
            "xc89w5Bn4qaZQJCGRbw3uH7wYk".toCharArray(),
            LedgerValue(7111257, 0, 0)
        )
        verticalLayers[1] = LedgerProofNode(
            "h".toCharArray(),
            Utility.hexToBytes(
                "DC28029D42D8CCADAE89526B101950E2A7B25BD8F9A1653D32B0327B90D2837876FEBB8E0DB22716DDF04D395353D41A35C4CA371C8BFF4AB8D70470178AADBC051FA99F6818E4EEFDA3701BC4D9F3ABBCDC5AA3702E03EF9E5CA2F3A3322291BA83183A25F6FBD76535EF689B99DD4D4C5D68536B4829896F1EE3A9D533D51AFFAFEB21884CC4397EC2CA21D6821BCC45DEAFBD9B297160100DAD9E9452C64663A229DFC0762270B0A8F58F8F8329E074AB0592EAA4D4D7FFB75C1697399150BA43DF62A8BCDC0E2FD1CBF9AF647C19A98DF87887EC7E71F93D497187E3215980753EFA1A6C0AED5A37640ABEB95DF91016AC3575958784867DAE1CF2E736D39A75504671E7D12380DB38AFBA1D6A3CFE93DAC02ACBC89E04A0D0DBE0DCFAECA0EC66783618AB892CAC864CE735283F36243494FD4B5C0FBB4A193C874420D2AE45DAD267F1771FFC3F735DF75FD4410CB407D0A38D703B139A00BD67E47AE65F179EA04B0FF89708A00A7D43FEDE289E585466295715D05CB716EC2A3F20BA7A45AA47050AD7AD6D79F75CCF22AC6284C898586E11DB7130BECAB168D8B89BF4130495B5B6771B60F9B5B36DA255550BB600BF46BC20204334576093EDD34DF763D8922FF7324B3E49C579D06AC34D7671B035D40D7184E49210274A197029F42FE99F9631CFD41024F71D128991F921C903974AA2C1667B0AE36788DB267F"
            ),
            Utility.hexToBytes("")
        )
        verticalLayers[2] = LedgerProofNode(
            "p".toCharArray(),
            Utility.hexToBytes(
                "C41BDA85B7BB15AEBC3780996A856FB27EC25D77C069B0F255ABE86593C353DF73D033C6C165EEC88C733E2E5403B55883FB9F66E127F7727D161792934ECFF80A0D95C5071003D0B6C19B1D4D0B747689E09E8B330085803872A1B98B1885DA39F5724FC212C1232DC7667B6F5BC7652CD268F055E3F9404B8B1EF506D191A27D95A180B0953B3D045242B38DD17809A0099896019989C88957AB5F4AA2391064239223637E0AFF74A2D7D3DE74547C79C77E3886D4819969B1AC190BB59B39D93DAD44861E97B1037504EE1FA280731A1FA94ED95BF1B8218FEA919777225C6148FF897FF25F9059A02FEFA4422608C2C7A5E8BF9A9AE4724BAF7E2ED9EB0BBCA69BDFD91C0CC6FABC50906730FA091A1B3733B53AEDCF31098D69C90C2F3B782A05682ECC3F3FBE5FFA5FB8ED2112CF5A612ACB67430DB8239383B62587E2D7492A929576205D7FD1B14C58B8EB73B727860878D647DCE897C9FEA21E9B62BE2D06FC1E9B75187CE5B7D11288867E46ABAEBC24A5FC70E4E4AA71F3F55DF9BA474332A36E146885AFDC509D91746D5368E6886969D2A8B6C327C4F9ADA942C464023C3BBA5B2233BFB402D50CDE2B75284D7CDAA4D3B84BA8C347EA75B80479DCA42EA9B82620AE30A92AA2D62499D835E615D1BB057253CB3C61CB123452C6C59A6F47A7822F5E9554722C0D27DE0A2056140940EF0FDC32DF227419A98683D5DFA882D79066D0CF8E4BCDBB761634842FE5C591C9F6FFDC8290215404B3285A13B35046B00820DABF499806D70EA355BD2C74640C208BFE8D88CE71A3AAE194EB8F10A57EECC6A6D68A54C5035FD418A22BD898703EC9B13F85463273542B3982CD2F5497F89AA23966D5BAE81D73357870F4850EAC18AC8B8E9D359AA8183844E7072A9BA3150E6FDEC3E86EDE79F3D683382A7AA86CE4FC229FF33D76D7E3CDCF466D60F2FF81477B799E1BBA3CE23421799C29A165CFEED8DE085960D8F3163DFD9FD2932E29B84106D74F5B5CBB29AE58C54C8F9D64954DD9C5B0327DBE78B96EC68D76350F23FA99B6A3A53C65CE3EE3A39F103F2572539C700F2BB6214CDDC93628461242F1D10FF670AFFF13ABEBEA9F919EF4FE89FD77715290E1B403104E57C8370F2885A697C830C1759AC454DF6529E01A8A262F013C0929C21374F811B2785CFF6A1956321AB161A448E2E3178DC22E00B2256D01BD2FC8A5DDBE6E448E90D4431C018C3E80BC1490727B6E0F1EE8E6CB535429F79DCE40A1F35BCCFF6CA9C1A36D5E13E929EBAA0E7CA8DF07B760DBCB4BBD3E9462EDF47FCDA88E11B12B4EE21F548C9261BD12B2BC026149922CFD8B7370D9D2406D6BEB84C3DFF7E9255D930E71CB44AEEAC22DD74EA2CA932CEE250F683946A2AC6011CB9D86D040060592CC7FDB00F4B5140F94161E556D302A044AFA04E02284A834CD23572DB7B716BA4764E403BD29D51A993A112C6BDD49A365FEFC86BD9CF9FDA42B606BC2C75E082536BB169F40B85C293F751D0B2FACACFE3B6563B4BDF417E8A3A399241A5C77117179543ADFA604DFDF4EB0CA93F0483CD5A0E9635BAE6DEDF888D4CCEE07568C6B7E3B472E18135C1FE48EBCC7B3064EBBF47BF25573205DC04BCD19E70ED4A998C39282FDCF7367E9C9C50E6FAA0493B6A865644B0F367D129EAAA7E7D9DD8EB6AB40E14A601526B5FB93138AC475C22B60291F048B981EF2140E58DB18441091FE6CA66CB3D1BD6B5515EE596C59F29C0E79562C973FE233D3D3A90639C42FB245983CB16098EF876D4777341E5DC64296B6354B69"
            ),
            Utility.hexToBytes(
                "4DD280B6C25D72F90056C870301EBC317E675E869D5E8523AD3023A0B34241C185DD902321027EBFD157C32C309F2C9B2A184FEA31E9830A9AC8A77AE80ACFF3EBFE5D1D7D77191B23CF0E0ECCA8B86335F8C47CD313D8F2450A2E6D278FF76A12FDD68786884CBBD50A978111932011041BA29AB6479D654F2B8BE7D468308FB841DAFDFD7D7D69CCA992639B2A0E9365D648817407EF34EEC0FC35D5C2D491E59DCB59FA4EF7577AB7A74E4868D7A41A377BC6B2A18C1AA64AEF2E315D8B2C1E48A4D76A746FECFB08A2347C29FE9A1FA8A995800E59496F02B1E6F79301C17DE08EA858380566C4300FF22663C7DBCB7410640179AC2EB1608F542BBA3EA3A480BFF695216AAD05E5A3A688395B1ED6CCB5FB45CB4796DF63B74B0E3E71BEF88D8C901EAB4BBCAEFEB319DF3E3B848F3954797358A3F9B164B4C093F0CAB20B079EEF2A2FFADBAE355A8B26CF267D26E35D887D9FE51557DD56B3725C43EB074B9C304FB0EAAC5DAB4DD668164902398B5140929F06C685574F7A0E8030B59EAD9EFA7EE8A2FC10ED84A4DC9142CD14FBA7D803BAC6D0B137969152313704A3E4336001C028878A0D05490CAD929BC4A03FBE4CB62154EEFB059ACE52061B6760F1D264F559DAC160B2A392F35C7C1AF5DFA677E55B754A41BD18FDA06A7E655497226EBA30F9F95A87E918C2BB0686FC07D627014642B92844154AF0A3A7F5DAC4D1C04CDB66585D7D6B6A79A6167D7F117638F79D0CF428C36D295124C5"
            )
        )
        verticalLayers[3] = LedgerProofNode(
            "7".toCharArray(),
            Utility.hexToBytes(
                "EE20586B2EBBF43BEC28D872F75836CB2B72CD81C2D830A87F51BBD291E72E27D39934C425DBCE8A5292A62D76E12C4A61526E534A73D2A4E699524D6C0658481165C1C2A9AA1816EB9E01B4968C0C589FE35FBE158F8DCA55FB07206E300D5FC1C11297C5CA3E54AE729150EDB3D7E3158AFA98BBEEEF538415018A67FD18DBBBF4D273E8C9FBC8CE718804D46ECB6787A4D656B9B5C6A4F27EC51C67DE1FB3D6547B586A5B1574F6A717EC4B7FD88937C75F2FBBBAC81CE9659A213D3045093FD2B1E8605E6B9EC7927796735143E9ED13645433F51133AFA0F735D15B3713ED1C780BBDB79C7B4C94FFD89C90547AD635A95D4250993A59410A865AF27517952CAC440D639C2A94F736FFC67DC0A291321B9F6DF4D77C5861ADEA39B1CFD9655B6B76F996FD75506A5BBE5974C1E0EAB7DC951D57F1FC86384A9F2FE0C66C01B483ED7FCBEAFCAC341A863271296FC667C40D1710EAF1F4F5B398C76C1905EA4B1284B3DA0BE667EE6CF0C376D051BC0995399342B85569098BDC4C9F5CFA4BFBD930604C735972340BE2E9E77C9386E53866B60F85DAC7137AEFE9B84069A466FAE1E662036B5D65F6BF1916275E426F48078C55C207F6211754D3CDB6A9705D41A0F14423B015FA23C006757989E65A585F4F910A3BB65C3967AD547F2039B891C00C1D7C5552F54146A9080B47AC9F63C941AE3B554A29B32D9E2EF7E9B57411AC170E3E37DCAD035BDAE3F44E41AABA04AE1AB5598A7E4E8CF32ACA8AD4E423E836CBAD7C6E7AAE0C475209FAA8A1F0455307770E5C3A4568440B3547E89FE2FAB252E8787B66649238EF2CDCF9EE2DC921E8DA401FBA0C92097732FC37E42997DF64D28E105629E0A2A9145A40CADF5BC326A227D45C385F9A0E8EFE25AAC37166B48F09D1CFD0FB5D4B4F695377FC55D29F77FD7DBE6C463FF7A3BF8E0042FC51C02D4FCB34806E0A2D98FAB8F979DD04F67A158CFB89BEAE94E9D717E564BC69A8BA38FFD18AA50937829EA6C13B5D486E05CF85300CC0743C22D439911C9E661DDB9668C0C8FAE0A7786D7C1E32D1B82488C497EC1A2A08E63B6649EEF29A8B7E7EC814B4BBC27A650EDDBE78355F2DAE732986CA60EA572DA9E73DC2AC22D005DED82CDB926B63D761A16F3BFCD6E7DF9BC8797979379BB58A2FD6C48696BE893C76F71C683B7C173D298A333AB9ACDAC8075FCB629E7E45577A8E5ED4E6FD072F37712C88D8500D27BE3DF8672BD065319A65E9063161E95A807C7DF4155F5C1D2FE61FEDB748B4BCF4B1B99E91614021987B7924E2370B14DAC2F792E13C2755A13350FF874AEA1B2E95FB0B3C0E52984D10B4385737C16B7BA26FB17E613834CAA230E358DB7C740FC6624097C4E941B4A481E5428A40F640243357759A59BD55E29A9998C5B0EFA5D9C0982D0E135DC2CD8894D8C00C84FFDF193FFE2E6F3596AED0CF6F1746952EEDB91A0B89D62D7CF7BBF0EA8E9F0A673E52743FA15AEF97098941B4795C8F3103C59B5942F2F0D4ED4553EB48C5EDD0173C73A48EA4800ED37413299123CF7352BB3890451F2BF57A294579B156DFA06207546DCF976333FC8C3B8D6323181E27306D36D7541D4FF44D00F64BAC09CFE9AC6C2DFCB5991683030214869482EAF8DD98A76E8B8EA75CB45244597CDF09017933846B94ED8231741AD5CA11AB6AFF6661B5FDCA6B4B0F108FEF509E10A981D831578A20672707A0CFD9594154BA9B6E1CF59A1D6ACBB55F4A0C3520A5A4A746EE1195E1A3A4F7B30B5B045DA4454AADD8C7BC247DE84C957748F7A275598D08449EAFE38F24AFA8B7A921C4DD3EB4F45051BCE51F7F09F59FE58DFC5A769705E95B48F10A24E998F1C0110613BB9E381ADE59521F495FB841AF42883D5E1AE714C9743BCA70D3F9752BF03DD608AECAE9976F528C83F3BE8525A16F5F52464130B68B31D1651B986B1A2252BDCD480478A5108EA8154C1506B87C2EFB14B34242532B2507F00A5902DEB9ECFF03E4AF5AACA50E318AE7E983CDB371D47A7AA60C2F9D9451EAD07ED597CFF86608F9DAEA045BDF3EC33C5D9E0AEB64E459242D149A4059D31010C747B30730062FCFCD8DABFDB9061C22300F8E1387ED1E"
            ),
            Utility.hexToBytes("2BC8F3B4F4934B258A624AB6ACC92B45C8E5C2B753B2CEDA9342CB761B2A0C4F4B5EFD0D67C618671F6EFF01ED60005A1840D30783ADC67538A8A5A2AA1E1CD2B201D5A21ED2787D5F6064447626D86D94C27526D38BA0D1818606926FE434356E1C464F13423019DF2F8D42A004D9CDCB0FC2E8E79888B5A0375C43F2B4A77E081220C6391C459464E1406146144680197B9D66F00B13143990C49CA411DDBF8A61BEF1432FBA06A555B190A79CB345E15C44AADBD21E8895943A3FD1234E8E495341AB7ECD10197A97EE7B6642EC5575C7E751DBCEFD4F07FFDEDDE487E06C99F73C04E291F20EA6F6239867F027266EECB04F7B17D1BC7B0D0077A6AFEBB787426AB28B6DD7AE3A050BF1ED98FA4239AF746730F6424C4FFAA92BEEB6E80961C91BF64EABEAED38D48227D0C9B0A718DFA1DA85EED1E44B5EBD6E8E693686")
        )
        verticalLayers[4] = LedgerProofNode(
            "V".toCharArray(),
            Utility.hexToBytes("767083A9B847CB3994D674D0C6EA95C5574F55C6A1CAB6EA506CE9BF19EF71E55971F601E2A468D2708102B45355BB3D0B5B12EABF64958CF41E0432C844E615D8963CC16D6ECC584C2C858F17E78608898E00D4D9D23049232EF3899C879C6E3FC80E2CF536B9B54BF98040697022E72BA2432981C2F6F0DB4A96B24316D179C0CBA514942B848DD5B2360CD90821DE355DF584B8FC39C9CDCE20A3184A8B9E1371696C1404AB63D20C852166B9F0AC38EA4A0EED4834D6FBBF24525CB0209D"),
            Utility.hexToBytes(
                "CF4DDDA97355C2D164B0B13EDD8A2299F72E14B0C3AD11BB3760ED6FACFD47B874CD51C6C21EAE527EBD70871D16F654C8A7D5230630B508B30C87C34C8E57FBC6940AFEDDD4E7C73A74A172C1CA3BDB9857E48BAA5A0EE3BAC392D40C44584D4F0311B691DB23D370B415EB78CE0F1B71DB327217F258E0D53D686C8D30EFA2197C3052C6373E5DEF5FBCF8BE684309CB6376981AAB74F68A4B2CF7F340285D2D8BF5AD37337F77C7ED24CC51F351E155454081203A9B3936D6C93EC91AE316FCBFF55BEA0A3A009979A8D214326F7C079AA4C96C389B24FAF4418C7E6A6F97EAB11963005151DF21C02CB9397053612D0EF816C2F26CF32850941A10CE2B4EE93F6C3C581EDFC99237A285718D5573C8A40C4BA1AB02EFE6951ABD8F25BCB553C8BA40CFB0B65B3AAD75670B64E93305677CC6019F9269DD4EFBEBE495AC09ECD484208BAA744689E12600C6EF863881B740DE259D82CD86765BDBC97CDCC7388B22810C460B7AE486DFCD5E7B6805F7DE036FF2F56295E9653FE2BA7FFEE9855D6FB3F0CBABEF7A1F4C2A52001F47E7DC0602E622A632F8F5820256BFCDD20E739F144C4AC07E6F1B4D42309A11E445F97870F1A22B8E2CA332C93E40295278227970977E5E7088D1D1B5705B5F2844A26ABF9A506D6045E42668613C7976775714D6CDB79C32C975B7A160722E642A25848911DBC8450256E63C15B3061DD39509FDC865EE6DE1D46A6EFDA4CFCA515D407F6FBD918FB746582D5B54E947BA27E1D5CF9032DC3150C08E44DDA2A6366A9A449FCCDF0E4E91B0A81C666CF10AE33B23EC2E36CA2B421B605AA63AECE683E8CD08EA58ABDED3308B55143FEA2F18050581BB01843F5290FE8E7466892950E9F8084A25BA9AB4C5F463E442B6DCCFF76CA36783484AB9EBDF388F4330B70E1D496D080447673FB484C042A93A404215991649657FB944D094AB6F0F579DEE9C78B56A89EB611668BAD076882C64A2E094E7DD4549DC0504AD15A7F4F7F011C8ED88916B0D3CE96DDF0F14E996D4E115B5A6001EF1B96B1FBBFEB212BD054CB2EFAD080AA261F9E7D3B4F780DF80F4CD9385795510C8FFDAA04B81FC8A6D63843E850CBEA035FC55CF206B3C3CE0840C9EF06F5B8112D3FB7A61581F6CE0DDF5D4F5FD37C93C33A8EF0D1C498F1238680FAABC0642B926AEC9FCA020F6A9EBFB11FED686F91E8C5BA767FF322122B727E981A63C284E8C0916CB5E6B264E15D6955B7B3B205DA42B1D3B720F20B5DF54E352CBF858985A4B95F3CE2F64014E50B9AB903BB4D665AB9826FCE0BFF7FFF3D19555733637135124ABCF178F5A671E43DF4ADAFABFA11578B82A7428683D24B51A98ECBF20A35DF5D6C796D8E305F0B6CEF988660A12AB0A8532FA76AD4C284CE7636375DD68B696031776389A520E81E8C0193A29CA5A2D4E4D0DD8C72999DF5E166412B0D363718C9260D29D276E56C8BC95914735C4F5C70E97657DDBAEDA13EBDE6D8D0FC51470C3F337B7218CC490F661BB7B47CFAC9C4587706CB1A711E389FACD5013EA7B7315AABB897F661C2195BF2630A6840007A8CE4C82231337F1909DB45BBB2F7950DC8640A7535FBD3176F9B15314269885881BDE8CC0506D274035EFEBAD6706D78A32B3F40374B80B1772A3C7CC404B950602FE83D8D72911AB1556BBC0EB564CD762941CD303E71D2E6EE8C648B66F5337A58F577DE980BC76DF5A9522C5BC40D1446BA14046CBD2F5B0A7FCDCF19116276556FD8C3786B7100C90D615A817C7DF58988C6BFBD6D36250C2A26DB4B1DD72B1F2368B36409FCCD28A1EF18FC970EBE7C5C9B404D09FA3AEC7666AD012B07B29B7A6635CAE1609F5065DA963AE56B8FAC5DB4CDCF0526A9C7B49F4A7B4D5B8E6791912D91E5484CFEB4857FDBBFD4C7A19D0ECABE030E133F384B14BE2D2B2042590E0AC7BBB5F2937022317DDF6F0508206B586069EED18689B6ACCF75CBAEF3F19DFE0E69686FF4F14079A27CDD021CB741EA8E5C535094815762DF45E90D618F269BECA1E04E7C3F3D40344A801C4EE5EBC139EF15C4A1E04B4ECD3862CC241088416F58A925F4F3653C305111D6E0B6C18727860E3AC323A6DD5053D46076DC6EE6893B6ECECAA1A1F362DF6077930F3F5E9E9EBF6757A7C8B6911E746D51E27E4FF9D1D0A47F657A6C936212FEDD6009E46D9A0993345337B26AE42FA69B597E3A0849E116921842CC05C81BE62398DDCB6D71E05B54084D48E1D6E09E810F8D4D11A918822AFB7EF2C5EB22242964323F81F7CAE9040B93E506323096A9F"
            )
        )
        val address = "V7phxmUtHMffRSE2R7unrXZH4E7hX1"
        val proofOfNonexistence = LedgerProofOfNonexistence(verticalLayers, address)
        proofOfNonexistence.ledgerHash.toList() shouldContainExactly Utility.hexToBytes("912703605340B1AED1F430C38C8DBF9D2F1021F244CF9EAF").toList()
        address shouldBe proofOfNonexistence.address
    }

    @Test
    fun type1NonexistenceProof_6() {
        // This proof proves that the address V3vCteZeC77sPAMstFttHZNFj4TjcC does not exist in the RHT identified by
        // 29302920416723E3FACA5E1073A971C3BE5020242CD75F93 by proving that after routing V, 3, v, C through the tree,
        // the next node contains "tJ..." where it diverges.
        // This proof is pulled from a tree with 10000000 addresses in it.
        val verticalLayers = arrayOfNulls<LedgerProofNode>(5)
        verticalLayers[0] = LedgerProofNode(
            "tJwx7xui1Bo1SVKwwNsYw3Wn7Y".toCharArray(),
            LedgerValue(5764087, 0, 0)
        )
        verticalLayers[1] = LedgerProofNode(
            "C".toCharArray(),
            Utility.hexToBytes(
                "965771583CF7F48B6899A0A5AD49FE36750F3F3C4C39D4E84A3F055751D9E241F957FCA4AF4E9805301AB4680ECC1DEA45C31F95712E4C237E9CB201F58E08C3F1D8802691D4BD75B354BF4FE756E8B602BBFE0EC05D0B589D6D543FFA3C250E6A6E42626102C6AB029280BD1FD0F34A20EEF88572E592AF419F5B33218CC530C3DC7509F00CD883CED81F3DFD7FE30ED14C8A11F1F8A5ED84623C53BDA42A89FD88574396C296AEEC1276EB7813115A320DD999A274FBC9D724C507DA3D7C5BC7A67DEC5FFD4EC9C19D978C6ED4978EBF2D5ADB35BF736B58F0147961EA98154E4C041E146D5BF9EF77385F33773AFBD086D45541C99EA0B7DEF8E0699CC2E606F17E06AEC648FE9D7094FA232345D4EBAB7ACCF9BE3B49AB53065BD1904602325D1EAEAD5F5488F61A22175BB0BD7784150FA2849590CD2EB463E7FFBFE519D00EFBC6C2987DF661824785CFDA869A96AC83F98A76753AC2C2A41359994EA30154804C7699A2D0CFCD7565DB04A7CA8EECE2A14EEFEEB68480CF26AA1B9573949781E0EF08EDE3C0248FB398BEBE9C07080795E02E40D96DE17CE9D002DE58697D339D507CFA2D18B3DB627CD9173F109D28D2169FCBB5208C9259AC55BA3CD182D500CA7CFFAA025F35142D2BF7E510CBE472188376792F180E3A0199A17877080251B3676771C521D2E1CF97455A8162842EC543D6A726CBCD1F061DD628819B3182B7A0FFED2EE4A1D369E0B9143F6DBF6ACECABE98F650F501A1FC75927FF9D8780249020A28593F2B694020180168184DA141135217D9F450B237091B6420508ED4D781A6CBEBA91B18B00261EAA48135FF8596E3DE59ED8C5AE8792A0EE6FFA382765873AFEEBF7E6032E00B81670CD5DFED687DBCDC3038207DE55EE73561A90B8545FDA80536E41BB9F8BDF88D4F713DD03A99AA3231C425A54E1E364378BD694FF1BEA74FE31C77CA455027CBB6FEE97F8E3FEBA67499E2A5ED682DB394E460DCDC5E15A9B110F2433FAF3FA07D6436E2EA4EF3B920752CB9FAF4288C9FC94A4CEF1B47A22F3B8D4630AE163608CDFD5AFA9CDB00E6042CEB1A48B7CD41AB80851C8745375D28075A461D4B6B1DA5C64492DB0CE8C7F67580B4737A1E8B2A37A269A0D6296A08D0097E982B0C64C382FA5B0B042F275C1B90ED387B9E30F491DA3687753702592383679B174B24A280B41927A010ACDB6FA67A54650493C7025A9FD120AA5EB4C7265762E9F49CB4CD226DE72E14784EC27E24573F054DC910E91C64E46EDBF983754211948FA368B3CAA29A71D4094726FB32F5F99ADA72D1B5C832D1B73D208C37DA6EBBC1B3A29D51F04AEB444B973AE376614398A1ABA68783C00497C53B3D8EA852C95FD1243D2ECE69074B7B0C9E19503BED6532E6F1F0DB900C73ED7ACC69BC678D2C0B906537775E85B93B8FFA04D5EE1A43BDFD2D521D2C4C27E3F87490FCACCCEB9261D17EF166CAABB6A92C1DF4E38C3331FDD47A5C59F6706F8DB95AD8C1C7F12BB2D793A4316362F8DEEB292BD3983E7DB31BB0053A9B87B1ED3B7DBE835837E26189D3520CD722A619464F9F9201DA9DC8AA91E82CA332E72F5DA01931916C4BF0F9CF590A852C0E87DA5DF802BE5A6F9F4D77D8363DD7CFE9EE8447AE5C05515E791B0FEB3C8A62F4F5191A9BCD777E9AFC63225DF58883293D90F6E7F8136D502206647228F24854B3136758BF1DEBD608E04FD8EB745B5DA70FD84D1B0E855F7BCB951F09538D00A1CB494C8E5E8B13CBE4A8360ADC0D5C7F258AEBB06574D327D1D3FC81B00D3D3417250D5BE40B87DD2E8A058898E5357A04953CE8A5D8679453902BDA7CE05B3F50D935983A0B8EC00FE7CE95DA6BAF799D363ADB00E22240FE5AF50DA05A26196C754122A11D2A62C22C1E4982A283A89CCE685528BBD5543400214921F62B1E08585C0E4FCDAC6B589C26B7E77CBC493CE8E3D95B7352FA56B727E6665F4A3818BF8632037EAE63111423BF20259F14E3DD563EBA2E2DAB3C45417BE4DB1E8EF8978F0F58721B29FDE820BD52EE51AAC1C9034B286256F729A38C98F93C1706562C81CCA03023ACDBD603F2168516856AA9851B0B5B63DCEE71FAFE3860910FD54EB085020249CEFBAFB40EC7282AF5E7865D00CB4CC0CD727B484C76E63E4FA0F2A77655C0DAB817EF1061253207CBCD0868274BB1D9A8519249A5212188F55332C3"
            ),
            Utility.hexToBytes("B808A985EB400F58EFCB88D06FDFF2BA7127FD0AB7F0E0E00B5F3E080321B308A4A887D36E8623EEED4AC2E210412730F1148A6EB3BC65DCAAE41BB174A1693ECAFA860CE5C217AD9FCF6609C98A22AE9F8A7C573A4CE794E66488D4D75020B593D5F0F1910BC69D0C86EBB262D4BCFF5B0B8E96D22F6D9166FA869B34768AD5494A741CC591F5D176322A283EEBBF2CC6B0B22D9D3B193DD79E77B2C52E2E37D7B8F0BF01780CC5BDAFC160619BDF6B1EFC5236CA809C3690388B663623E344")
        )
        verticalLayers[2] = LedgerProofNode(
            "v".toCharArray(),
            Utility.hexToBytes("CBAAB1B170338AB23AE8DBDC220E201B6BB4843254337B4FA0BA9205625C6ACE39213ECD91617B7DE1D4FFAD6B9A35A2F06622C8005709870B54B0401A27729FB0A0F9ACAEB4A82551451F2B7F9BEC2FB8AAC55863871E0EC3B0D9F628E7BC08BC2366B9CE334CBB6557546221F5E6F68F7BAD4CA59EFFB781F3E6521E13626A37B7C5160B6EF0B462432F8159F5B7B670C88145DD5A870DCC230213C73E082F5A89BAE62844C0EF767FBC328385539374245AF4BAA7A4375163573541036EB30D18D212689C1B111FC599309EC0649491AAF47E9F1580BE1E41D4A3423AC8F64EC55D4C16D4B9ADD2809C4F04C86C4A7519E353F3161E9E9362383FD78068E1CE31696FCA88DAC686BA6582B7CF9C7EDFD12BF3C5852AAB920F3FF847AC6020328C8EFBD6E99E8982087F42BDFCA6B6BCDF6F15F79CA8FABF0FB77F3CB9219C7AF6B50C74DC8B5D2392F367951B6F2A78601CF417B191BADDA0BF9E1FD22895"),
            Utility.hexToBytes(
                "F2629DEF177B12AA8AFA88A428DC92819E352135F99149DFC6AE091F5A1E99E18ED8F810FA1C985B19D9147AC5DC0D1AE47427A6AA7EC7B2E6C98EFA86A391C5C22442F3CC1DDEB88BAF220DE82B154A73F9B141C063937D77A96727917C9E8371973BCE8D6821C5A10444D7E399E82B6943D9A32C42A53666F2F935A76CBB1ED7222FEF5B88689704133D23C72693C284D430F6211D888FCA0D664EFA517684C9600A76D200F03483A25F44D79A7762688367D1EFE93DA0CFC034E122DF38B781DB4E60249EB81279114F0CC7C3D87C3F8670E7EFCBF1311EE1F03C0EEE71C5DAEB7961949E03A860475AC5F9D0438DC976D127E3EC5FCC77EA6E6D161F11FEDADAD373BE252210109018EE15A9CB6B4FEA6627191742DF8AF7EDCD5AD3603B7AEE115B4117FB43D836AB314319A6DAA1D363B8238EB42616F857B77C87E17B8CF8FA41477165CD329546F50AF30C8FA90ED69E946B106C8F847539A00B05D54D9103FCBF8352F297604DC23FD645420684C24F950CA9DDCFA195E03DC32C726291926C48FB750F1D870720D9BEB31FBD7E8C4E7F962D430286694166FCB4C1F9379B6BA6026ECEABEF2DBCAB98AF82B2D8CD23EEBBD617D8C7A0E5972C2E4E74603B63C9334BB1970672E7F3940E11AEF2B23E9B0A96354EA68E241F5582768382DE8917009FF74A0099974DC35F7DA82477C134CF60D905CF92C820C78553E74FC26B30C3D053C99BB859CD54DA314A8913537A364404081DEB7599E7D0E84E248DF25F33D49926C96CF9835DFEF47A40AB3F56E4604E1F6CF926335934355317C10DE2EDD75F3CAB1B99168317E616FF3239D9069EF2088DE1698286ECF440CFF86E1F00994EF01173A50DE54AD299C0907904F9C7188D2B0CCD75534C034E473497AD6685476EABD6BFDDD591664395390BC9D53F86E5DB32D2BBAF4C2580674E3313635B46EB53B00E0053DF2762BBA6014B87C467B0990E23E8EF1F3CA142A0CB9CE0F71AF475824912D4D4A1660820CBDD7C3ED09067CB1F6CF574C49E6BBCCC80C92C49BD64721643EF05A103DA22869AE39DBCED6069CFD3AB484AF9818C719A2ADF496A757EF9929EF541099CAAA915EE4697FF7A03EC47745803F26E11C7B2FE7F0A1D17952B299F45F7A6057264B305C056D8F6BD761D6672A1CE4E9F4E4963D20C140109353562C61BC4A320E73D461A4CD1AF5132E052617ACB1B708E2C3E6B1C8C39110869BF9D68F0A23E5465EFF4A671B4A4FB3FDE21785ED1ECA57C50403672AFF8C41C713CE0192BFB4A4C02E1576F1B7C67227F42D1ED16EE3239BCCFD052985E95F286AE47B3C6961C5802FCD88F8E2A837B22266ED57D4055172844CC2DEE125B3804FE5A88CBF08BAD6518E79693B25B142D648BE27425C3BD1142FFAB6434D0FDCCF373374296C917A2587DB7EBDF717C4840E1A65B35EFDAB84C56AF9A6491F7233BADC92996D9F0A0B2971F1A6120ABE711640BBBA510B3D4ADFD8D84BB7373E4E3EB9DC9DEC693B18C58A82FAB42D85ACA358AA62EC0D8045748BB216F12D29076E45015D15F6D68F1105B4F4178DA61DC2F3D39D97A8C8687DD8E284F5CC3C7320AB697BDB45648DD87642B69AEAFD8D1BD45EDF52E334D31ED03BBD160AB642ECED4857501852A810E0735985A17AB152ABB4E854B72EC1E46C7159BFF6E109EB67F2F0B0CC7C4E1E6B4F48FB0C1681BEE55CCC9AA526F70B3BF9899158D496ED8C62A8FB8D1776833D7D11094B8F5D5D31B638AFE6DBC057EF1E38DA1CB4247BCE80C7ECB4D9ACA23C46F3619CEA3C5F3906A6BD39159281AD40044CC1D6AE02DE147A2C780C38594C6BCE54C77F9082019B7C40095FEF8ECC722032310D325A47F9D4802FBC812CD58690F0857A57477F4B35B9BE8712A925702898BD3A4960778083AAF8B861D1A8D89C9220FA52AF3F29FAEE07A13ECD5A24A7F314D317F9C19079762DC2AD71360B0DDFA362E8D15B73C1FE9C3C6EA53ED78991C782AF6E97B287011AA35E33AAB2BCB88D012F9CDC704640FFE1309DC17788AF7E5802D1A324E400CD04BA1C844448BDFF2C3F2FF"
            )
        )
        verticalLayers[3] = LedgerProofNode(
            "3".toCharArray(),
            Utility.hexToBytes(
                "737792B1C2E0C8A346545B64799BAF67D30AC753C33102647E6C2889016810181A6B6C4D9BD270E0221082C550A67703994F39DDB2F7B6BD981C18343B378DE8C9DA3122D1DF4BF3B6BA646C1C826990A0B309E6A99BAD5591B512F893E07C6D84B0278A5A6B3FB234F64EA0DDAA671A25B75E0FB6B8D1B64372D28612282E5F7CEA345CA939B4AFF0089B2E16DF3986C69CC5584B85362E2A11F6B1ADB4EE7F64518D902D0F341EA243F30925BF1DEB129795936509F4A45CB682F943FDC6580D7557C0C10AC6BFAABF0041B6F5A9B27A1CAEAE64A4ABE4023C91624C567424E6444A4A85EFBB4C954E6A15D8236BFB38AA247AEEF2F2665996527E6C427391574B79F85D0DF3FE5C279E56447FBFA62D9BCD0B0DA3233DD75EA4F363815ACF5C59D78EA073A8124FC6F952A043ADBFD81AE45021118334DB57D4F9E2338410E63411F50D62485C06F53127729BC8018A63C179A07E256CB17A898B158214F04EE56E904BF2C7EE0E00A9785E00E5CE0A8B4F94FEC2563CC2058E41EB2D29E932B233DBBC162A1A96EB8399AEFE36470E0208EE8026BCD2A887ED70B3588746919B8CD3EA98CDCAFBFB89B05F4DE5E52E24A772F1A628F07725693D6648CE08621B7871FD35555CCEF95BFC093A128070026987F1D486C9439628E4A08B2E353423CB3F4ADC84C60C561369C52A43D9B692600D1FF2FB1C8A77279B4E96A029F0F6CD6BF12A097F0B89293FE49EB5182941740573F9931C86D2F5F744439D8019E98EC8508AF2748FF3777A7D2F01A9E97E7A3491084B27D8B34B0EF12A607B9F21DC9F108625E1B139E7FAE4B780D6718CDE19FC1A287FA1187B8A9EEBE1AF5C1A33E1C8C83A65FE27C4F45B052389DD9A107EA328AE9671A4A8B918C0403E5201433EC954AF8A37B309870A5C2B837F006A71E36B39D738BE97B012DA26DA53DA0F15A785C7434F260E73712EE17404EBA565A60B1E214DD941637E156BE1803F29F4CE13FF8ABDD2459FFC83640991E51B9B0B17EFA563A82752039EF695503B9A7D4396C3FB27053D405137202DBA45A3F32FFA457848AE4EFA7F7A0CB441E18E6AE381ED6DF89A652122404BA9D6D20EA365E71EC45A1D4CD51A83FF11028FAA106D7A962758C96D5BDA4E477A2C521AEFB4FC2B1893C5F6E4B430F761D21CC1D63C210F4C3BB3AB2CD3F610C0841473B64672A264BFD41DF97A6B63332DBAF922BF2617059309DEBA6818C078CA943EFDA9A5DEBB1169D632453E28F77224BC2403AAF05C495767AC232A1970666C7D6007E836E840B5C6395C975DF7780348AB398E4B4AA90ABB7C8B89961A8B6CCC52220C106BDB50E6BBB4801E68A9C06F4692297C9DD3E14792363E85A3A080571A2B5EEB175ED5345F16EC5407E357234D0A2000D337F8C3A9D65FA0023E4E5ADC148197F93054AE9F7D4D7396EEC06710DB9F6EC2478145F4B3980CF81DAFF9915202E10EFD4A20B5EEF6F0F7FF1AFE33EA4BAC8CC2CB96719CB20DC715EE991459731FF4FA5CA0704DEFE74486B211ACEDE322FAF60DDE60D26235192837EB1BF4DC95FD81CAE7CB6F00328A0458FF95D59C62A1E4F10089D3C39F095AB0F037F70CFB3D9EF0C3179EEA90ED8AF1A97234621799BCFE4A51A3E588E28867189BD40B2B78347A4F7745C3D98B0DBF63CB89942196F3B553C3B2CF53A93788714B6065CC7F72FF51834AA4827C906235478D616B4E7853EF5FD95CB05FD260650172810B37919EF777D45F8DE739721D250394E6F0341D6BB805E691EB6B02CFA94D0822380351229EF05D4B40A14435ADE2AE4A63C3AFA5F514E5DFAD72E9D141744ED2A92DE0F8CED9C3825ECBA3793C997B12C2D911F8D7FE762349D2D47243004100927FA544DDAE1D15451F8BDC39F00D80AA0E0C5B5A3CEE0FC536A6868EB638446F359BBD16AE26823DCF9C4B04565B6FC0EF191FA277D0073252B3ACDB4A16035CE25342C46222BCB2E57A0CE3A04AA6FEC58B4F22AC282C48C448AC52CBF73F341F9D5C8F3883BCDA66D6CF04378328F444B036C49B7DE1122C870FE90A8E54D4E54F946B40C0935993D325CA9D0A5D30E8F40AACC70F3ADF8498F2966B273B49151A8113A138A645EBD2646A7626B411A643B9FD0F06FBD0933E59E8570DBC50D31EB2B8D8487D01BB3FD425DAD287DA22ACD494EC85512EC3089D113A40066D3BF972BC0699320060BF60704A188F07CC899A3EA48279FF04AAEC5ABB832535011494F1FCE457BED6D5BCE8E8FBC6DA279A3622D3E8D52E7B3CA3C2E02B26ADA4014E5A29B7D2D438D841AEBB70CF4FA9D40670278837B0B2397F2555F5F77357057818A8901F18500E70DDBE10FD3CA6F1450460E1166E3A09415BD4AC261718A1E5AA80F9E3CE"
            ),
            Utility.hexToBytes("A0B373643F8C5C9A89698D13A6851A77A3E33BA6EB9975E5252F184334A1390B3F2BA89C6DC0B8509E96C34E5710562F628554A9FBAEE404530B1F7F7BD2465B51DE3B5DFCE7035E8DC9CDD34111EB6CD268FCC429810BBC857D59520685E653741439A0935B06E286B63F835E215E6216A1DD7C1A3B962D5AAD972708F29056")
        )
        verticalLayers[4] = LedgerProofNode(
            "V".toCharArray(),
            Utility.hexToBytes("8F5E14D78890B7E269E74F15ED15D7ECB011EF330B7CC3389FCA7435FBDC6C10C2AD5C26C7913F4A8053CFCE8B60AB1BFE34976D0DDA2BB68663ED74D2D13984"),
            Utility.hexToBytes(
                "C169286DF14D52ED8E2E243966FF5DF0A660526960799D7B05297B2AC6D39F676684F81F1EB3DB3A5EA244A1B1195E9690BA6B21FA4DCAEB7E20CFC29F953CD0B4381B6D06E54BDC6FC0A837014920F50EBE6458DE880540D26BA485927F779F81233EC6711D6001C892ED215C0A4D8EA8ADD80875C2A9D1542A780D3573E98FB98F5570B3011A43E7B6AB0913C141C479CCD5A4E901180F58398D6C70062586D7CB440AFBC8F24C68B9D863FBD3B70F53D59D7F408579C876C7FF531287CEEC9ADBAB81B677B3BEC60680909A23D7010F0B63BD3891953AD8C79F8090BDDAF171F9F6D10186390DAEBABAD1D35F4F26F4AAB46212D824E795FF487071A7D975592F59C2FF61623A3B539AD77F5560ABB6A59733E37D2F612FB57E71D74F7D89B6271930503E7EF9E7F698CF80165D29677FB74B8062E704D6E8231CA39D19A4BF4530D7AFA0A86D76CE959953E7720DA580214EDFD55BD179F0AD41270E814EA9257E55A6C2F9AA3E0B2A61DD247CA0807F61700DFC8244237924E7A99590436FEF19030F6098C68A3D8B39F420FA409C3DA2491521102D73C44902700CCF63F242BD42BE47C9B57EFA59B31FF5E163F245C8CDB7F389E4B7B7DDE12B84BD25C716B3C4D243550607439F5CC5F6FC31EDAD2F56D080740FED06E524382A62193CDC8BFAD1E3CDCFA3EFF2F2903DA1446608A52A665160CFDB72CA27D25424A5E71483DC0B194FB962783FF939BADC7C0F8025E9A1B6953A5B845FAC9B85E3C80E8A4BC3A528FA48B535390801B302A3AC7C268B25D7A012284D5DA058F5E6FA91D3F0AFD3F158E14D84EB8E89E1F27ED511BCB529FDB1E1D3520A29BF15A47216E5FFB531A5472920FF31598C15C5F46F057B4581844D71012144ABFB011B51B6BF90297D6D1C44568C3F7698B2402DB791EF708F85EB0B37FE1DE91E70EF6C1AFEAFEDF25C7A9A2060FD5F3D71053001FC760D50BDC62FCC3C3C57B287B69EF10BCED060AA9798409162E2CF8B9DDA050A8FEC2BF6BAB2C2D7B194D7A4599F73183D386FC19277B61130591A283C630AE19D57CC5C8CBA34CC5D0E85D26D1357CEE0FB695DA69D5F1D9F37B9D48907DE31D6092CE2AB2A32E7AF161C3BA41E717F0DEB6BF48ED65E6591D124E601DB537E721170F969D20A81F8699BD3C4A143B9DB5361B8E5A0033065EE136FCF1C3854C97B64B1E0D6A1351559D44E5027516ADC211C0EE21E2F5ACC9CA3E0A7311E0C72D0264DE370CABB61100F9C728ED506D3CB2883E16EEA919E80D41607573737CC33F1B14ED09F758292F89901EAB425B8B5C7BF1927B4CE6DCAF2C83560DB8A2720E1E4104445065BC5DB8C4807F53B6715994E9DF95B09BE835D74CF312DF9978C4E14BF68590B4E948845C6473BFA6C0A073507E8D9CBFE2A8626D2FDEB3022BF74F2E598810666AE2BFD0791BED238C36C5A7A22F934BA6FDCA234A4DE1FB47B5196A8C108DFC4C66F0CB316951258013663BABEF0CFCE30C91E1C7B3C16B00976CC24431DE83D83DB7C7368F9FA6DF24C951327C0007736EAC3EAA56A6C448762FAE8060D43C799E9ABEC3F292D4A78F68030B2AF7A473E84D45E3CFF0319DE24E7958B52EAED05746AC268DEFF20D37D57B553A08A976F1DEB647FCAA99AE84354AA0A6744A386F64978A3CD05ECBDE7D5281B07E65B4439C54F9EAD5A308517816691FAC30C5DB17A4C0E54DC9A112692510E11CDBE4C1B272EF9058482434A72B3E4284EA548D3DB24588B5583D6E01F10619B400070E8D771D919BD9737EBCB51D8D63DB1E77B78B971BE75AEA690EF19C4074CC00C7D05292D70ED5C90C1E81FA4CA3DC1872685AB3128F03118E0CFB222F78A51B1BB3E838E4105A878133DC08272517D1F3861ECBE4D6874F9137A56288D7894E8928D6E5196BC16806D7DF3E99DD128D67DE156FACBBF86F8ACC7D38822EACDCE61C0D0D3FD608529E1AEF3C5E41583216D6295360F36131415E628904746817E77796B9E0BFB4E90C5B11EDE42727F10AD1B8F1DE8621EC1BFD3652BB3266324B3FC494B89AE9D1B99C6C125F8E994AE26F502CE06BA9BD030957C16E82DD6EE08F2308740E8CB15B92EA34C4585AEA863249F62FD3D717F07652303E5353706971D87E763BEC59FEF983F2140FB1A78EF22A5DCF96F52E9BD57BF7D51483FF21324679854F40A116A76832864E674D93D3D292ADE3C1D218EC83E0872A635CD86ED8DEB5A5CD669F9D022B569B5054A8E347B2FDDE47C54F7928C9AEC61175D486F2B70970600C2A956DBB1AF2DEFCCE7B783F5D1CBEE7840F6C07D12EEBD7CEC97B3401B8EED12F576016AEF472FB9C53137395D1B3333D1FA1AE7EF25817A6C82E4D11BC2090170040DA5289A638547E7F6CBBF8290B60F72E4F62B45176ACF1806EEA7305FB06D55BEF796B3E11CDD2BCF365BD632DAD3CBA89EC46E990939371409ED67C6205B8C6192F1A21FF3B9EDACB4"
            )
        )
        val address = "V3vCteZeC77sPAMstFttHZNFj4TjcC"
        val proofOfNonexistence = LedgerProofOfNonexistence(verticalLayers, address)
        proofOfNonexistence.ledgerHash.toList() shouldContainExactly Utility.hexToBytes("29302920416723E3FACA5E1073A971C3BE5020242CD75F93").toList()
        address shouldBe proofOfNonexistence.address
    }

    @Test
    fun type1NonexistenceProof_7() {
        // This proof proves that the address VCCCCCCCCCAAAAAAAAAAAAAAA7V8Gw does not exist in the RHT identified by
        // C9F8E72C773F3745DB07E0D0F0A81523B6193A53A63C81E7 by proving that after routing V, C, C, C, C, C, C, C,
        // the next node contains "CA..." where it diverges.
        // This proof is pulled from a specially-crafted tree where the path VCCCCCCCC is heavily crowded.
        val verticalLayers = arrayOfNulls<LedgerProofNode>(9)
        verticalLayers[0] = LedgerProofNode(
            "CAAAAAAAAAAAAAAAAAGuKM".toCharArray(),
            LedgerValue(100, 0, 0)
        )
        verticalLayers[1] = LedgerProofNode(
            "C".toCharArray(),
            Utility.hexToBytes("038EF46F430479A936678855A65076E3B01691D73C5164E15245E808CD393CB7A38FAD5C4B87480C6BAB6568165B3E24364042BD9756F856EAF6D0E4D3A28CD7"),
            Utility.hexToBytes("F1060DC28BB382B62D6BFF09DB86129B9C987C1EB944A6D5BED45CBBC05EB99CFA3B93271A8D28CA1BA8FD5C9EC24228F6A24877A3D013E9F8512A35601A44C3")
        )
        verticalLayers[2] = LedgerProofNode(
            "C".toCharArray(),
            Utility.hexToBytes("432153776E126065FC28E5A1A2BA8A0987BDE5CB80B04FDBC20E3DDE7B19F6F48D8CE4B1F9A2056229B414BCD360913A62F434E8B81635C8909256409A477478"),
            Utility.hexToBytes("9142E7BD8A1B8AD55744FA0F4002A201AB08F0F7F26D61192C9A076270A49F1BFD18EF80199DDED2E0242D38D28952B2BC4E29855B5A8787C7D06F28606C4AF2")
        )
        verticalLayers[3] = LedgerProofNode(
            "C".toCharArray(),
            Utility.hexToBytes("30A378227B0BC0CD1ABFD353639BF4206461D040322979E33781532112FE0EC3"),
            Utility.hexToBytes("")
        )
        verticalLayers[4] = LedgerProofNode(
            "C".toCharArray(),
            Utility.hexToBytes("FBC97EA60D3B73C1A50DC1871F554E6BDD75C26DB52483A6FE79E852D5E5A699DF8AC78792576B92D446D2A3A5BDADD0990AC821697F469DE262B6CC52A8655E"),
            Utility.hexToBytes("5F0607C6037D4460B4B9E45B9A0F3E1B5CE5F10C9F83758EC3ED5CCA4AFDD9C63D95087C088FD5C9D49A765E1AE2C257CB181A86F688880B17F41B7EB0762BD0")
        )
        verticalLayers[5] = LedgerProofNode(
            "C".toCharArray(),
            Utility.hexToBytes("61B115A2300EB01294D251DB3A652A86493BE22F08EAB26C2969AA57D7BE3572"),
            Utility.hexToBytes("")
        )
        verticalLayers[6] = LedgerProofNode(
            "C".toCharArray(),
            Utility.hexToBytes("632CD30CA641FD3929D6CA8A4055136A868FE973EEB003D8340146CBB9617E3014B05F418CEF42C4517DCC50928E1020DDB2AEC653044442064C0460AD38D6358FCC4E5CCDDE9187326E43EF802EE03686608EA80075E558C1585FCCE48AABCF"),
            Utility.hexToBytes("C44E22901463226A7F1589AE1F16C8737A002092A8C821A1C17AC062F74B4060CD42C1B04753D07B566CFF6053BA51DB56395AEBCE881D7663FFF93D20A7D43A099E2DF59DA9D906554DC5CB2BD7E8188CE3B3CDB4B88208C02407AF194D551651EF3661DBADAC2F74064BEA142452026FC38A003E7FCBD01AC05DC6A67D0AF11232EA3D770971243F6AE8DFF57978717C27FC7FEF52A88A71A542027181EA38BFBA863B5C75970DD8FE5B689A461176AAB661B23A1A2FEB9D87F5620929E0C94775188BC8E9E61A0C6FF86F42E5E212081A456B4AA8CFB3151B69C2B19F78F0")
        )
        verticalLayers[7] = LedgerProofNode(
            "C".toCharArray(),
            Utility.hexToBytes("955B76C881B4C73601E5E1310008EFDA46A9D259298C12E688510BE115ACC326B85A12C648A582DB7212EE572B164D26E37089F3F208DEF53A2D8C676B0FA46AF7C47A88F2152529C36F9DD62919D1C7203AAD4BBDB450A908B63995A157ED1D854B37CDF2F4393F701985AA8BDA1B0F1EB2C783CDAD1B19780DFB84752CCAC5F26A35E1D65D505468285EC38C6D680CD6A6A545D8E977C0FEB38B32EB6A3607FA47060807ED906A1FC59CF3FCCCAEB1947ED729A38943BFD27C10A36C98C50D4C3B287AD6CFC8D19F8C972A6961C8590FCDB9B86F8BEF343AE4C7411AF9588788F1B7B4B9829C40F1D1C63E53F091D097E53F5E0E7438B97ECC38F8786F4A6A793E62473516320B900B658912DFB90874AC4BC791837B8DF0565344D7A7B7BFB19CF07E60AA9342271D90F49B360E692B746631A1F4227C04789A1B8CB08FBCBF2A365BFF51EE2200EE83D88A9230F735BE5A12FC954C108291347384951218"),
            Utility.hexToBytes(
                "857B96BEC99DD6710EEFE30AB3D1EC4767792A3CD4FC4A096329968DB7A4A8B501390C1994CBCDA1DA8E61706AC2B48D6B6FE80EBCDE4EC166AA0A88BF09BFBCA3A87B5C963277A04C739C5194A170D7ED2E3A50F921C45D5B4682A18FD2CB9F1AFF04347B78AB9A433913BCFA3E77618541467F24873FA8C4DFAC03155D4130CF26956D4ADA897F8D2C7641110420B3200A020E712F29A95DC13E3DAC61A583372ECEB4B531EA9B094C0ECB31DE2EDBEE756D3DB358FAF2256D8160256B929E164BD4AAE198334E92EBDFF04803F087E1812877CA6B0F7C75F0D68D35A819361807C257158F1109CE475E828A4E445FF13C8204FE8180C98687706D8CB8851E76CED7C7A58A50F31264F19A8F2D8AB08597D4551D7BB42C4AF17C071EDB8505D7150805341882FD829D43A7121F87A27C525DE9F43F879EB9587AC92D3F2C072D1904A68C48FF70D28CFEACD0540D3A2215B8320AF70C6A17F77AC8B8544DB2362AC2A5E2E5C93D4C9E7F07817813ADCBCFA96648429224546D85B63EF1CF2A5CE532407B7A5C7CBF07E0B1F15CD0FEDECE4ECDE5973B24F32A372488921A6A217287B9384B5167FC98C181881E7F8ACF1DFFE96850CEA9020491AA0D66A156656CE46F52468734214795E311C055A9020E3BA1189CE4E53F89A3BB9829A3AE03992F0CB811B960F11EA202383053AFF558F2302BB0F94BDC0CE59DCD29E8F742699C00683331606C082B2D06CD3ED3B747AFA6595C35BAD12D2DA0D4EED894DC219BD25E6F6A70168927BCFA7160D0FFF4A18761C6FEE6952D4C82FAF6D6EBDD0F76776ED3617BA1D51BF683163494321276F06AF77B1ADC15B36B910146A73DD42A06D8938FBDFED3F252B18968E51E0208840E0AF91A922AEFCE169098F13EF9BC87EFC6078F29E2B65BE3634C707E67562A14684E308B9FAEBE36ADC35995B5A0B3B2DB8C3460D3520220AA9F321D0C3FB400776A476342233EB2E35DE55769207A2E37A36DBA0B3B8B263133DA6312004037F82ADD1391884BF3FCA517FAC0501606CDD1FDB7302B79D5868CB725D8C2CDC76A8248F2AC20957A23D64D9DF30745FAA32724B8E1CC67E1DA9011E36410123A536C9F3764EC7CEEF3BA58DA924B24AC67A25E97BC22E53F2205EABEA474FD0CA51D98715F2AECA3FF9840EF24EBB02B64B61D242BD166198FC7EA51AAC0C14B5BC4F0E86FC913B419B8EE6ADBCB9AE91707D33D20A0C8BA00B7EF097E849ED009857810573E7D4CCA76B096EDF528EEF111BF8071E3ED084BC46709E2C8C6090F0C0D3C94DB1F89BFB4522C2432E70FD52F4881A55584405455DBE3BAB8D6AB06215EEDEF6DE87CF32F48596C070B52874F2CC9FB4DBC47A5F2D45B5B1EC21C35950954847488DD0998FA01B7E2B596D0BA6FBC385D49176797352A8F348D008D21343661678F90285E52EAE83E5FE81BA7E932A0B25531708BC6635D4B166FDE711D47F57226C086C952BC8EC6CE091684815AB717E8EF9B96517D1B38130BE6E79839C97375E51D1E13C09F5AADC928B8942CC33C451167C0B966D1B901C9541A2CDD36AA075C3C65A7A468975C7996281FB58904AC42B3184F72A655850E70FEDACD6E674C0A986C020ABF9FF27BDA357B26DFD35F52359413E11C746113A5D16716FF772B36C45617B0C8D3E55272E2C37CB466B0412167D7E39F547668681BA5C9BCEF282F082F18C19AEF4B0FCC7B86F4B83EF62E314929535503A1F86F16EC2666ED2040BFAACFD98895DD12274725A66CA2F8AC2A7E5A0D76A1E7D5C7B128D90A02ABFB3C1EA133408B148DAA5CAE89687676BA6E3C6BAEB5CDDBD7000CD21DF0AE554725CA01075C8EBF815B8D3DEBC809AF12195F4460C424FA8C302D6E955A972B83499CD967D7C6C789D54D1ADADACF58F78510DF88B58999C1DB05DA0E488D82DF5B9FF15D74707859AA80C8245D25A1DD1260365B2A0D7B261A044C10FE3B3E51F449B7904007F39E9CD8519BB8849D38F9E45359169FDE54D5FA0B29910FBB9C09C96FA09A2A7C8EBFC91D06D6E741B8677B3158B138DE0A3E65F8CAEEB908CC946A90"
            )
        )
        verticalLayers[8] = LedgerProofNode(
            "V".toCharArray(),
            Utility.hexToBytes("2FEDDA860FE494CBEA85D58387DC5CB70D21231ADCF6930861D42067FDEB2B40FF637E9104EBB28052EB26693E318158F2E2510149BCE84ACC79C73872AA05879C69530367A44BB5A1F62D0133C80A74C7B9B93259F0D7C6150B85BE1D8C4228CCEB8DACE785FB9FDCF251773BB31257B10E425F0853CF48CE389EB3D9F2DD952275EC5BC412E65DAF37DEB4804498D3F55031D267BD3616449B0B70BCF625A2ECB3FE599B7009EC0DE78ABA6AD820812C3C6E85E52EDC006202BE92C2E238A12FC08C4606888C3392616B1D1E4AC3C690F2A25FDEE357B2E1DA555F6790485C317245FC99B68461A2E71C844295F1DEE2A174D5784FE4DC3B93784D67480382F64F0CF56480554EEEFF6ED91D78398F9DDF103BE1E617CA1ACEAEB16E794C62F5DDA72B01F747641AF676650B9D6335A12BA0A7D9ED2D6EDA38FD56EFF3EBCC584332A0C1481AB96F975208E69E6B805B09BBFDA117685D3749DCEB90A5D1DF"),
            Utility.hexToBytes(
                "725C883F414B8EB7952AFB79858ED479E1FA0EC302BCAA73605C59CE4D518CC7B6342C8989ED03DED655278AAE270AA3A858EEF5C0A2CC0565B229DBE81BF24AD1B049BD5E6EF96593708D282B68CBD391ABBAF5E3A4E9015C1A611D68A1899285A755D94A64A69FBA1B352F3A226A9A08555FA2AA625E82DB48D44D9BF0D8364FCC93B5966FD70528D7C8B08480BD8D48F882031A8F9B6A2F58C9A4F3C5DB4CF9B5B1CE64E68E2A98F98292009261412F983C0225B6B97F6F01AF3DCE2BBA183C0D7262EBAC0854392EA4DA3F967639DD053D7CE1700B8B82810AC9A6F8A16CB43C22B2BD5F9F3E5B365F58DD9F0FEF92923509F7D9E0AD59ABD6C96B90D515A45CBDF11D3B58E5EC5877EDF0EECEA864D15CBA46E765F7A660D32A8B05FE329EA662804D064237378F66E55841DC27CB433C822198707B8528F3842F206326D7E4E4E961FE8B959EA103F311D8551C52B149096AE1948D5865299CCB2D8B6F388AC806ED3B84646D0D867721DD16E515997E76728C06A9198B5F2F6DE2CB3362D9F3DE33C0765F21B7E747B59E4F0AB9F156F5238A53A580C3D16DAC202837A2A4DA21AE1795DF3EC388DE8F943AA16AF83D6E2F77499FD371845A5C8549A76E1582365A6E5B225A00E69A9C7547F0414BA6754535AAF5B4D22BAC85D023CC1C51357A90FC9D8D718FB2D48BE252E7AD7AA379756F095F248889C2F2D088350C430B25E75CEDC008686CE6053F892426B6609D1F568DB98C5F6CDE57683CE3C64A1C488DACB6D6108A784154538F3D602857DC0658A375D7570DB1A50ABFACE3F7DAB618F2FE4B80B07F38CD33B2744BDCEF69A906ED2B61806E2FC9E840BD5BA68401C26D7C264F72BA4B6D14EDDEFB22B586C885962365D7B81E36BF41C762636FB5F0DB0221EF8EF2D6745688F7B4894EA60473B79E8BCC9F7D5553E0CD659FF2693B4DB0216B5B15CA998B387F3DBABA8D23A88FA8E7E1F28EB95624F1F7DE0DEA28AA36A9D96BA54154EF98C1C890FDD5A5DCDFAAF9ABBEF3E07C3CF623F25FB81CEF04A0B3CD09E1B8862DF88BC05D20EB0675797853A3765D8520A77721CBF4835D33D8B3440DE18556A8DA828A2BDD06385CA367D8F22923E54C0DA02E3B0560634F37534691FF2B485F80BFDD2A97EF6F129D84C55FC2FB01834020425ECAC530F0B73111067575D11056FAAFE342191A2150984C9258BE80AB41C3CCC885A5573C1CAA5DC9A64F8EC9F5782D0FA7D1A40FDE312BAE37B720CCE6FBDE44079166DEFDD8BAEE80180636B892F03D948A699812CBE6860FC90CDE00B83BA5314CCD60B0D1A96A99F0CF7496674D05489517B5D2222E0A52C72693B8270D2D88F9B57EEB1C352606FD3D1468E8A298A05A67D41C4B88DFB627EB6EF170DB27B42F953E06E95970C7555C857959960B0FED2EBB681E229647012070CE32A63CE0F3644066FF8A561E1ACFA3D9F2F033E2BBF5F28BA3C33F5DB2A252D6CFAC9B2154944FDD289532FD5AA33510D5798F9C11DF2914CA808CF083F896CB44B96AE750D67AD0F6C2719F62B9220546AA8E2EFD59D07F331032100E2D36CC2F9E5C4F4625DE40EACB31A359984F968457968E528B5745FD9B0292A0C6F97CC86C24E98E8382EBB2E89B726BB5FE568957056CFD2AC7DBFF552966C9FF2D63DF9CFFC5BC472B8DB05361E4AB29F279AE0FEE80A3884A737772E9232E54681495E4757765EACE96A96A28DA71614CDA27BF11C4EDCD1E878D0BE05A4FC68CB45830051926202E55804FE9EA37D3F0A4AACF19CCEC7F1FA84DD3DB36F7754068387CA62ED1C66E7149FDC6F14980AB5561F0CACBC55CB8EDD69FE7F2D6377AE566FEDC8D083E406E3D69A880EB40966F0B9F5AAE3D6E2E30CCC0DB07A01DE9A8393E3388BC43C23DBB1BA7C576A708814723FFEC2F0586023BB8615C0D876D55005AF29FCDD6D15D5BC7532A1951B60D695F9FDECFC7F7B605F1799B724DFE86C0DB63BF3C36BF81884B640F0B195724039852E7A8F0D3DA447AB57A15E9E454CE7781119E4FB91810EC16CFC9DB9A55E3B197FDA63C1C35231CCBE2E1162B8A"
            )
        )
        val address = "VCCCCCCCCCAAAAAAAAAAAAAAA7V8Gw"
        val proofOfNonexistence = LedgerProofOfNonexistence(verticalLayers, address)
        proofOfNonexistence.ledgerHash.toList() shouldContainExactly Utility.hexToBytes("C9F8E72C773F3745DB07E0D0F0A81523B6193A53A63C81E7").toList()
        address shouldBe proofOfNonexistence.address
    }

    @Test
    fun invalidType1NonexistenceProof_1() {
        val verticalLayers = arrayOfNulls<LedgerProofNode>(3)

        // Invalid signature index
        verticalLayers[0] = LedgerProofNode(
            "eqQbaP6peSMDDKz8BP7mbW66ZyR6".toCharArray(),
            LedgerValue(1811251, 0, 1)
        )
        verticalLayers[1] = LedgerProofNode(
            "H".toCharArray(),
            Utility.hexToBytes(
                "4D71E470BB01EFD22658E319DD7D0DF552A47C986C2F84BA631B9891C08FBAC141381E1990B3FFA04021680200BABEAB291EDE2BB8683F639A79A321CEA408248874DB69F0F15A7AB88DDBB77D1307BDA82C4D689FD3661371DC04F795F5B24D9E8150E3213F792DEE0C88D09A97346AD84EE4D324DE92E97FF75DD8D6DD298E9CF917E77D3016C2D8AD51C9274CF423C6CD2B621D76959ECB74FC4487F05D7DC38442CA8FF457DA7FA79E26A8A94443604A9195DE3A7AB807849B4D9D38064E469CAD2D065F13CE47273CB8A0B6C86E0BA8C077432B9C2AD0D64F7AECED5F200C24B183E3967A2239E7312612483C730EB460BC047B2C5197B8E24A4123B116AC92644C63529CC0C359AB1828B7917F91D5956B792DA2A677D7E2D0A44BD2F45199FED010E92C94A4BE3A7C8535917DB56DF63E8854EFE295B548F7DCD2EEA6F55568866AE83AB1E99262420F8D56B979FEE0FFA1AF316102FA92D4C03E2D6F888C5107DADEAC49023C36CE5B0CB04CD9D0285A65B3D59240E1186BAD972C70D159FB200A3E38A02D628F95CDD956D7DF19684383A87F8E3AB7F7B393E55021EF8487279DEDAAD970A624DBA3110E3089F776D068CDCE4783EB5933C027E23D4FA88918DBEBD4F615D525E91D79F6A69DB0F651FB5A1346097F2A4007E330A9DEBD5E2C3C0995E323EF54112FDF3909BA634C917E9383BA5C344D1E49E68F990507B2987F92769A210F0F9A5A8B04C77E1054AAEE4716B6E3481F4F67C60333D07E87974C3557B814E7C4CCE65EA924ACE3CF9B0CC53DD05FD3A85777E1DE7921E97CD68BEC80218E0A26933BD03D9FE1F7BFF0A5CAA8924B00E8C640069A2AC490F89FBE207F4ADAE0A8B27E45FB8DE09DCFC7064A8C734867F68ED35B8EE5"
            ),
            Utility.hexToBytes("E73D4AF70718767D475DAF331F53806014BC379FDEBD409D6DAAEF04F15F2A8995D4BBB1ADDA8D672F25E0798E12895D037A24B0AC71A1AB79A19C87FAFD126BB8B1D08A235B0B6AA8765F4673479745999476E5580E4B623D9A00460474E050AA664CFC78460CCD0BA2D27A7DEDEBEC25CDD5A5634802F5867947FF2E1856EB00FBA35BF29D6B56B71C8C66FF2E0C864123C87940907E056689EF9642DE3419CDE99CCE4E0AC76F6DEB7E4EB6BA9CBE0DD846958A56EE59A998094B9E8CD03543890485F71F19D7CCE29E4C493BF8C91BCD21F51D4E082D7CFEBED108EAF6CBBF30A7D0E6CEFD382DA93360B7132A647C34A0B69A9C1A8C9E5A3207B2B46514B2A77A9658D016FD1FF7D4774C2A113CD0CE8F3875EB46C86AB063BCADA0C308F0B4646E88831603354C53D9EE0D8FEA774041E241B9A7A3017E91ADCBA676AE")
        )
        verticalLayers[2] = LedgerProofNode(
            "V".toCharArray(),
            Utility.hexToBytes(
                "5F40073859A8A4E4FEF7DE6BB13902967E491D8471C8DA4B8DD3A95B8755E2E4810C18A5F1D9E9A273931345FF4BDD4F5E64980C861FF74EE7B4AD76A44F043DAA3CD5AD220063907C5B184F1F9045491B01340CF3F422E02FD66C99DCDCE6193CAD49F3136780017ACC39DB6F031041F9DCEF1AE32EFABBA9542EBC94E9A29057F43CD7A164F7A11B75A74949965BE67286AC84EB9AC550D97B7EB229BFDBE1EB4E797DC3CEBE849AA1178E7F93F16108FBB58BDAF0ED8AABFC9C1BE23D7D0DE5E53AA591BCC86380BAC16EFF02A9568C78EC255989D76590C530901BC5EA6E8FAF405AD14082446413616FCC2FAB6C7323A047A9D6EB8A526F9A4CCDB8D811776CE8DC179623C44CCFD25B40226E936D61264D3C74F082D0ADE06DC2F723B3F2699A994E8EFBD93E16C173142F18BC9F19E2066BCB4B2906182D6D03C26EDDE147813A6F09F7FBCA78F0F84D6A1ED75ACDCD21A36A9119BDCB29B53C686C4108CD598E170D6A59717E43B77A58E93D6B7368F95415C38646F9D549051E2E87898E991AC58777A2D25BA0B22B82437788ECD92AB9AF0C47EF8661230F93D799DA0E782C04E011071938664C17166C462D91A6C1C2DEE0A3392A72C83C5FB49515D8BA5FA1D994392B7F2785CDBC08E41A757616B7033EACFA8DC6B2F86F48E2379D2375DCAD289C364CA2051A24B47C843AFD41F69C81D3DAA9FCF934CAA073"
            ),
            Utility.hexToBytes(
                "66E0860795CD4DC38A2414D817174B9562A0E2132C548EC636A7C3806F0058389C37BC421C446FE46B77A0B61E2030E8877028EA5DDB646E9867F392DAE721DAAC0A3EB20885351784A235192BE61D028CDF3505209D97BAFA9B9A00F614862DC82A81DE826CB59DB01796193A1F416C49EE7CA8D2A31C3DEC8D05572B6B20E57E53D8C52EC37FA05EDE4279A2BB249F3BB02AEACE43F9CF47CD4A2338BC35218386E24699961A7C3620780A3FDCA5142E9E3E30B73E228F8C2E8953942F066195D26FE2B8BA6AF5A14AFACA034D6E9FE9BD9DEA58D1AC627B2D3CFD0D4E2C3958335AED080C5E94B2B27341B5894CE9DFCA403C7DB63B0D2FFC2B631A6F46133C3E6D08C5897642C9CE81FA4E450190E4A6044E1B2D34900B2C3ADB64005D974298B367105D6B5EA4346BB65EA95ACAF3C8817135A2D49F501328F064BA85EFEC864C55424FBF0AAA0C8F5E5CDFC7FF4D2A75128F9C2694668219543C907B560CB4D991B29343001D75BA06200290E2302CFBDD7F6172BED18ED6779DCB516F294E5C7CB5F87D5D77FF340A76B2282E9B445FE744F3877CDDD7B2DEA5AA3B6D368448C9E4919516FC596B51BAC0E2E45B7113A70FBBD672013C29F73141382DBF4AB716F8E18B2B38E2D67DC2D1CC3D471C7313A78B36457F660DC71A462F6728EB4DC14D434F06F0450F12DB49D460C819CFDAEE87BF03EABACFA729D2BD47B6B1C3F12B3BF7753DCCA75F87FD6FB5473D7084D8A1FCE62ABE01AA803B605889D98B1E749FC931607103814C0B0525210086853D905D898FCDEC377A106ADB611732B4639BE8B0189A54BC9E17B395DA2DC792342A6BA8498CEBAE814E559938A34A7B25F990C413EF260CAE3DE35119AC6631F81DBA61ACE348BF7732169278F64BD607572625F9A434F7C34F40E336DEBDA27D053E9216305AB1778E19967E51BEE26370B58F2844C40BD6844752CB0F352A34DC851DADC0B85AA239C7BC23932135F3537108415C4BD23B5DFF4D04C63D371D8A0046D946A601CB0841D61CE3C30419B0D4F9FD111B6526675A9109A13079D6E581666574E11DFE1AD5313E5AABDE390C2DE1A8BA9AF6534E80E2AA73F8B64B93C88E2030908C075C6F2A"
            )
        )
        val address = "VHeyHqn7qLUgS6ZvmcDxjAwHgB5iNL"
        val proofOfNonexistence = LedgerProofOfNonexistence(verticalLayers, address)
        Utility.bytesToHex(proofOfNonexistence.ledgerHash)
            .uppercase(Locale.getDefault()) shouldNotBe "7BEBDCECA669943E16000F3B657322B7AD0D5DD012660A59"
    }

    @Test
    fun invalidType1NonexistenceProof_2() {
        val verticalLayers = arrayOfNulls<LedgerProofNode>(3)

        // Invalid balance
        verticalLayers[0] = LedgerProofNode(
            "eqQbaP6peSMDDKz8BP7mbW66ZyR6".toCharArray(),
            LedgerValue(1811250, 0, 0)
        )
        verticalLayers[1] = LedgerProofNode(
            "H".toCharArray(),
            Utility.hexToBytes(
                "4D71E470BB01EFD22658E319DD7D0DF552A47C986C2F84BA631B9891C08FBAC141381E1990B3FFA04021680200BABEAB291EDE2BB8683F639A79A321CEA408248874DB69F0F15A7AB88DDBB77D1307BDA82C4D689FD3661371DC04F795F5B24D9E8150E3213F792DEE0C88D09A97346AD84EE4D324DE92E97FF75DD8D6DD298E9CF917E77D3016C2D8AD51C9274CF423C6CD2B621D76959ECB74FC4487F05D7DC38442CA8FF457DA7FA79E26A8A94443604A9195DE3A7AB807849B4D9D38064E469CAD2D065F13CE47273CB8A0B6C86E0BA8C077432B9C2AD0D64F7AECED5F200C24B183E3967A2239E7312612483C730EB460BC047B2C5197B8E24A4123B116AC92644C63529CC0C359AB1828B7917F91D5956B792DA2A677D7E2D0A44BD2F45199FED010E92C94A4BE3A7C8535917DB56DF63E8854EFE295B548F7DCD2EEA6F55568866AE83AB1E99262420F8D56B979FEE0FFA1AF316102FA92D4C03E2D6F888C5107DADEAC49023C36CE5B0CB04CD9D0285A65B3D59240E1186BAD972C70D159FB200A3E38A02D628F95CDD956D7DF19684383A87F8E3AB7F7B393E55021EF8487279DEDAAD970A624DBA3110E3089F776D068CDCE4783EB5933C027E23D4FA88918DBEBD4F615D525E91D79F6A69DB0F651FB5A1346097F2A4007E330A9DEBD5E2C3C0995E323EF54112FDF3909BA634C917E9383BA5C344D1E49E68F990507B2987F92769A210F0F9A5A8B04C77E1054AAEE4716B6E3481F4F67C60333D07E87974C3557B814E7C4CCE65EA924ACE3CF9B0CC53DD05FD3A85777E1DE7921E97CD68BEC80218E0A26933BD03D9FE1F7BFF0A5CAA8924B00E8C640069A2AC490F89FBE207F4ADAE0A8B27E45FB8DE09DCFC7064A8C734867F68ED35B8EE5"
            ),
            Utility.hexToBytes("E73D4AF70718767D475DAF331F53806014BC379FDEBD409D6DAAEF04F15F2A8995D4BBB1ADDA8D672F25E0798E12895D037A24B0AC71A1AB79A19C87FAFD126BB8B1D08A235B0B6AA8765F4673479745999476E5580E4B623D9A00460474E050AA664CFC78460CCD0BA2D27A7DEDEBEC25CDD5A5634802F5867947FF2E1856EB00FBA35BF29D6B56B71C8C66FF2E0C864123C87940907E056689EF9642DE3419CDE99CCE4E0AC76F6DEB7E4EB6BA9CBE0DD846958A56EE59A998094B9E8CD03543890485F71F19D7CCE29E4C493BF8C91BCD21F51D4E082D7CFEBED108EAF6CBBF30A7D0E6CEFD382DA93360B7132A647C34A0B69A9C1A8C9E5A3207B2B46514B2A77A9658D016FD1FF7D4774C2A113CD0CE8F3875EB46C86AB063BCADA0C308F0B4646E88831603354C53D9EE0D8FEA774041E241B9A7A3017E91ADCBA676AE")
        )
        verticalLayers[2] = LedgerProofNode(
            "V".toCharArray(),
            Utility.hexToBytes(
                "5F40073859A8A4E4FEF7DE6BB13902967E491D8471C8DA4B8DD3A95B8755E2E4810C18A5F1D9E9A273931345FF4BDD4F5E64980C861FF74EE7B4AD76A44F043DAA3CD5AD220063907C5B184F1F9045491B01340CF3F422E02FD66C99DCDCE6193CAD49F3136780017ACC39DB6F031041F9DCEF1AE32EFABBA9542EBC94E9A29057F43CD7A164F7A11B75A74949965BE67286AC84EB9AC550D97B7EB229BFDBE1EB4E797DC3CEBE849AA1178E7F93F16108FBB58BDAF0ED8AABFC9C1BE23D7D0DE5E53AA591BCC86380BAC16EFF02A9568C78EC255989D76590C530901BC5EA6E8FAF405AD14082446413616FCC2FAB6C7323A047A9D6EB8A526F9A4CCDB8D811776CE8DC179623C44CCFD25B40226E936D61264D3C74F082D0ADE06DC2F723B3F2699A994E8EFBD93E16C173142F18BC9F19E2066BCB4B2906182D6D03C26EDDE147813A6F09F7FBCA78F0F84D6A1ED75ACDCD21A36A9119BDCB29B53C686C4108CD598E170D6A59717E43B77A58E93D6B7368F95415C38646F9D549051E2E87898E991AC58777A2D25BA0B22B82437788ECD92AB9AF0C47EF8661230F93D799DA0E782C04E011071938664C17166C462D91A6C1C2DEE0A3392A72C83C5FB49515D8BA5FA1D994392B7F2785CDBC08E41A757616B7033EACFA8DC6B2F86F48E2379D2375DCAD289C364CA2051A24B47C843AFD41F69C81D3DAA9FCF934CAA073"
            ),
            Utility.hexToBytes(
                "66E0860795CD4DC38A2414D817174B9562A0E2132C548EC636A7C3806F0058389C37BC421C446FE46B77A0B61E2030E8877028EA5DDB646E9867F392DAE721DAAC0A3EB20885351784A235192BE61D028CDF3505209D97BAFA9B9A00F614862DC82A81DE826CB59DB01796193A1F416C49EE7CA8D2A31C3DEC8D05572B6B20E57E53D8C52EC37FA05EDE4279A2BB249F3BB02AEACE43F9CF47CD4A2338BC35218386E24699961A7C3620780A3FDCA5142E9E3E30B73E228F8C2E8953942F066195D26FE2B8BA6AF5A14AFACA034D6E9FE9BD9DEA58D1AC627B2D3CFD0D4E2C3958335AED080C5E94B2B27341B5894CE9DFCA403C7DB63B0D2FFC2B631A6F46133C3E6D08C5897642C9CE81FA4E450190E4A6044E1B2D34900B2C3ADB64005D974298B367105D6B5EA4346BB65EA95ACAF3C8817135A2D49F501328F064BA85EFEC864C55424FBF0AAA0C8F5E5CDFC7FF4D2A75128F9C2694668219543C907B560CB4D991B29343001D75BA06200290E2302CFBDD7F6172BED18ED6779DCB516F294E5C7CB5F87D5D77FF340A76B2282E9B445FE744F3877CDDD7B2DEA5AA3B6D368448C9E4919516FC596B51BAC0E2E45B7113A70FBBD672013C29F73141382DBF4AB716F8E18B2B38E2D67DC2D1CC3D471C7313A78B36457F660DC71A462F6728EB4DC14D434F06F0450F12DB49D460C819CFDAEE87BF03EABACFA729D2BD47B6B1C3F12B3BF7753DCCA75F87FD6FB5473D7084D8A1FCE62ABE01AA803B605889D98B1E749FC931607103814C0B0525210086853D905D898FCDEC377A106ADB611732B4639BE8B0189A54BC9E17B395DA2DC792342A6BA8498CEBAE814E559938A34A7B25F990C413EF260CAE3DE35119AC6631F81DBA61ACE348BF7732169278F64BD607572625F9A434F7C34F40E336DEBDA27D053E9216305AB1778E19967E51BEE26370B58F2844C40BD6844752CB0F352A34DC851DADC0B85AA239C7BC23932135F3537108415C4BD23B5DFF4D04C63D371D8A0046D946A601CB0841D61CE3C30419B0D4F9FD111B6526675A9109A13079D6E581666574E11DFE1AD5313E5AABDE390C2DE1A8BA9AF6534E80E2AA73F8B64B93C88E2030908C075C6F2A"
            )
        )
        val address = "VHeyHqn7qLUgS6ZvmcDxjAwHgB5iNL"
        val proofOfNonexistence = LedgerProofOfNonexistence(verticalLayers, address)
        Utility.bytesToHex(proofOfNonexistence.ledgerHash)
            .uppercase(Locale.getDefault()) shouldNotBe "7BEBDCECA669943E16000F3B657322B7AD0D5DD012660A59"
    }

    @Test(expected = IllegalArgumentException::class)
    fun invalidType1NonexistenceProof_3() {
        val verticalLayers = arrayOfNulls<LedgerProofNode>(3)

        // Invalid route
        verticalLayers[0] = LedgerProofNode(
            "EqQbaP6peSMDDKz8BP7mbW66ZyR6".toCharArray(),
            LedgerValue(1811251, 0, 0)
        )
        verticalLayers[1] = LedgerProofNode(
            "H".toCharArray(),
            Utility.hexToBytes(
                "4D71E470BB01EFD22658E319DD7D0DF552A47C986C2F84BA631B9891C08FBAC141381E1990B3FFA04021680200BABEAB291EDE2BB8683F639A79A321CEA408248874DB69F0F15A7AB88DDBB77D1307BDA82C4D689FD3661371DC04F795F5B24D9E8150E3213F792DEE0C88D09A97346AD84EE4D324DE92E97FF75DD8D6DD298E9CF917E77D3016C2D8AD51C9274CF423C6CD2B621D76959ECB74FC4487F05D7DC38442CA8FF457DA7FA79E26A8A94443604A9195DE3A7AB807849B4D9D38064E469CAD2D065F13CE47273CB8A0B6C86E0BA8C077432B9C2AD0D64F7AECED5F200C24B183E3967A2239E7312612483C730EB460BC047B2C5197B8E24A4123B116AC92644C63529CC0C359AB1828B7917F91D5956B792DA2A677D7E2D0A44BD2F45199FED010E92C94A4BE3A7C8535917DB56DF63E8854EFE295B548F7DCD2EEA6F55568866AE83AB1E99262420F8D56B979FEE0FFA1AF316102FA92D4C03E2D6F888C5107DADEAC49023C36CE5B0CB04CD9D0285A65B3D59240E1186BAD972C70D159FB200A3E38A02D628F95CDD956D7DF19684383A87F8E3AB7F7B393E55021EF8487279DEDAAD970A624DBA3110E3089F776D068CDCE4783EB5933C027E23D4FA88918DBEBD4F615D525E91D79F6A69DB0F651FB5A1346097F2A4007E330A9DEBD5E2C3C0995E323EF54112FDF3909BA634C917E9383BA5C344D1E49E68F990507B2987F92769A210F0F9A5A8B04C77E1054AAEE4716B6E3481F4F67C60333D07E87974C3557B814E7C4CCE65EA924ACE3CF9B0CC53DD05FD3A85777E1DE7921E97CD68BEC80218E0A26933BD03D9FE1F7BFF0A5CAA8924B00E8C640069A2AC490F89FBE207F4ADAE0A8B27E45FB8DE09DCFC7064A8C734867F68ED35B8EE5"
            ),
            Utility.hexToBytes("E73D4AF70718767D475DAF331F53806014BC379FDEBD409D6DAAEF04F15F2A8995D4BBB1ADDA8D672F25E0798E12895D037A24B0AC71A1AB79A19C87FAFD126BB8B1D08A235B0B6AA8765F4673479745999476E5580E4B623D9A00460474E050AA664CFC78460CCD0BA2D27A7DEDEBEC25CDD5A5634802F5867947FF2E1856EB00FBA35BF29D6B56B71C8C66FF2E0C864123C87940907E056689EF9642DE3419CDE99CCE4E0AC76F6DEB7E4EB6BA9CBE0DD846958A56EE59A998094B9E8CD03543890485F71F19D7CCE29E4C493BF8C91BCD21F51D4E082D7CFEBED108EAF6CBBF30A7D0E6CEFD382DA93360B7132A647C34A0B69A9C1A8C9E5A3207B2B46514B2A77A9658D016FD1FF7D4774C2A113CD0CE8F3875EB46C86AB063BCADA0C308F0B4646E88831603354C53D9EE0D8FEA774041E241B9A7A3017E91ADCBA676AE")
        )
        verticalLayers[2] = LedgerProofNode(
            "V".toCharArray(),
            Utility.hexToBytes(
                "5F40073859A8A4E4FEF7DE6BB13902967E491D8471C8DA4B8DD3A95B8755E2E4810C18A5F1D9E9A273931345FF4BDD4F5E64980C861FF74EE7B4AD76A44F043DAA3CD5AD220063907C5B184F1F9045491B01340CF3F422E02FD66C99DCDCE6193CAD49F3136780017ACC39DB6F031041F9DCEF1AE32EFABBA9542EBC94E9A29057F43CD7A164F7A11B75A74949965BE67286AC84EB9AC550D97B7EB229BFDBE1EB4E797DC3CEBE849AA1178E7F93F16108FBB58BDAF0ED8AABFC9C1BE23D7D0DE5E53AA591BCC86380BAC16EFF02A9568C78EC255989D76590C530901BC5EA6E8FAF405AD14082446413616FCC2FAB6C7323A047A9D6EB8A526F9A4CCDB8D811776CE8DC179623C44CCFD25B40226E936D61264D3C74F082D0ADE06DC2F723B3F2699A994E8EFBD93E16C173142F18BC9F19E2066BCB4B2906182D6D03C26EDDE147813A6F09F7FBCA78F0F84D6A1ED75ACDCD21A36A9119BDCB29B53C686C4108CD598E170D6A59717E43B77A58E93D6B7368F95415C38646F9D549051E2E87898E991AC58777A2D25BA0B22B82437788ECD92AB9AF0C47EF8661230F93D799DA0E782C04E011071938664C17166C462D91A6C1C2DEE0A3392A72C83C5FB49515D8BA5FA1D994392B7F2785CDBC08E41A757616B7033EACFA8DC6B2F86F48E2379D2375DCAD289C364CA2051A24B47C843AFD41F69C81D3DAA9FCF934CAA073"
            ),
            Utility.hexToBytes(
                "66E0860795CD4DC38A2414D817174B9562A0E2132C548EC636A7C3806F0058389C37BC421C446FE46B77A0B61E2030E8877028EA5DDB646E9867F392DAE721DAAC0A3EB20885351784A235192BE61D028CDF3505209D97BAFA9B9A00F614862DC82A81DE826CB59DB01796193A1F416C49EE7CA8D2A31C3DEC8D05572B6B20E57E53D8C52EC37FA05EDE4279A2BB249F3BB02AEACE43F9CF47CD4A2338BC35218386E24699961A7C3620780A3FDCA5142E9E3E30B73E228F8C2E8953942F066195D26FE2B8BA6AF5A14AFACA034D6E9FE9BD9DEA58D1AC627B2D3CFD0D4E2C3958335AED080C5E94B2B27341B5894CE9DFCA403C7DB63B0D2FFC2B631A6F46133C3E6D08C5897642C9CE81FA4E450190E4A6044E1B2D34900B2C3ADB64005D974298B367105D6B5EA4346BB65EA95ACAF3C8817135A2D49F501328F064BA85EFEC864C55424FBF0AAA0C8F5E5CDFC7FF4D2A75128F9C2694668219543C907B560CB4D991B29343001D75BA06200290E2302CFBDD7F6172BED18ED6779DCB516F294E5C7CB5F87D5D77FF340A76B2282E9B445FE744F3877CDDD7B2DEA5AA3B6D368448C9E4919516FC596B51BAC0E2E45B7113A70FBBD672013C29F73141382DBF4AB716F8E18B2B38E2D67DC2D1CC3D471C7313A78B36457F660DC71A462F6728EB4DC14D434F06F0450F12DB49D460C819CFDAEE87BF03EABACFA729D2BD47B6B1C3F12B3BF7753DCCA75F87FD6FB5473D7084D8A1FCE62ABE01AA803B605889D98B1E749FC931607103814C0B0525210086853D905D898FCDEC377A106ADB611732B4639BE8B0189A54BC9E17B395DA2DC792342A6BA8498CEBAE814E559938A34A7B25F990C413EF260CAE3DE35119AC6631F81DBA61ACE348BF7732169278F64BD607572625F9A434F7C34F40E336DEBDA27D053E9216305AB1778E19967E51BEE26370B58F2844C40BD6844752CB0F352A34DC851DADC0B85AA239C7BC23932135F3537108415C4BD23B5DFF4D04C63D371D8A0046D946A601CB0841D61CE3C30419B0D4F9FD111B6526675A9109A13079D6E581666574E11DFE1AD5313E5AABDE390C2DE1A8BA9AF6534E80E2AA73F8B64B93C88E2030908C075C6F2A"
            )
        )
        val address = "VHeyHqn7qLUgS6ZvmcDxjAwHgB5iNL"
        val proofOfNonexistence = LedgerProofOfNonexistence(verticalLayers, address)
        Utility.bytesToHex(proofOfNonexistence.ledgerHash)
            .uppercase(Locale.getDefault()) shouldNotBe "7BEBDCECA669943E16000F3B657322B7AD0D5DD012660A59"
    }

    @Test
    fun invalidType1NonexistenceProof_4() {
        val verticalLayers = arrayOfNulls<LedgerProofNode>(3)
        verticalLayers[0] = LedgerProofNode(
            "eqQbaP6peSMDDKz8BP7mbW66ZyR6".toCharArray(),
            LedgerValue(1811251, 0, 0)
        )

        // Invalid left child hash
        verticalLayers[1] = LedgerProofNode(
            "H".toCharArray(),
            Utility.hexToBytes(
                "3D71E470BB01EFD22658E319DD7D0DF552A47C986C2F84BA631B9891C08FBAC141381E1990B3FFA04021680200BABEAB291EDE2BB8683F639A79A321CEA408248874DB69F0F15A7AB88DDBB77D1307BDA82C4D689FD3661371DC04F795F5B24D9E8150E3213F792DEE0C88D09A97346AD84EE4D324DE92E97FF75DD8D6DD298E9CF917E77D3016C2D8AD51C9274CF423C6CD2B621D76959ECB74FC4487F05D7DC38442CA8FF457DA7FA79E26A8A94443604A9195DE3A7AB807849B4D9D38064E469CAD2D065F13CE47273CB8A0B6C86E0BA8C077432B9C2AD0D64F7AECED5F200C24B183E3967A2239E7312612483C730EB460BC047B2C5197B8E24A4123B116AC92644C63529CC0C359AB1828B7917F91D5956B792DA2A677D7E2D0A44BD2F45199FED010E92C94A4BE3A7C8535917DB56DF63E8854EFE295B548F7DCD2EEA6F55568866AE83AB1E99262420F8D56B979FEE0FFA1AF316102FA92D4C03E2D6F888C5107DADEAC49023C36CE5B0CB04CD9D0285A65B3D59240E1186BAD972C70D159FB200A3E38A02D628F95CDD956D7DF19684383A87F8E3AB7F7B393E55021EF8487279DEDAAD970A624DBA3110E3089F776D068CDCE4783EB5933C027E23D4FA88918DBEBD4F615D525E91D79F6A69DB0F651FB5A1346097F2A4007E330A9DEBD5E2C3C0995E323EF54112FDF3909BA634C917E9383BA5C344D1E49E68F990507B2987F92769A210F0F9A5A8B04C77E1054AAEE4716B6E3481F4F67C60333D07E87974C3557B814E7C4CCE65EA924ACE3CF9B0CC53DD05FD3A85777E1DE7921E97CD68BEC80218E0A26933BD03D9FE1F7BFF0A5CAA8924B00E8C640069A2AC490F89FBE207F4ADAE0A8B27E45FB8DE09DCFC7064A8C734867F68ED35B8EE5"
            ),
            Utility.hexToBytes("E73D4AF70718767D475DAF331F53806014BC379FDEBD409D6DAAEF04F15F2A8995D4BBB1ADDA8D672F25E0798E12895D037A24B0AC71A1AB79A19C87FAFD126BB8B1D08A235B0B6AA8765F4673479745999476E5580E4B623D9A00460474E050AA664CFC78460CCD0BA2D27A7DEDEBEC25CDD5A5634802F5867947FF2E1856EB00FBA35BF29D6B56B71C8C66FF2E0C864123C87940907E056689EF9642DE3419CDE99CCE4E0AC76F6DEB7E4EB6BA9CBE0DD846958A56EE59A998094B9E8CD03543890485F71F19D7CCE29E4C493BF8C91BCD21F51D4E082D7CFEBED108EAF6CBBF30A7D0E6CEFD382DA93360B7132A647C34A0B69A9C1A8C9E5A3207B2B46514B2A77A9658D016FD1FF7D4774C2A113CD0CE8F3875EB46C86AB063BCADA0C308F0B4646E88831603354C53D9EE0D8FEA774041E241B9A7A3017E91ADCBA676AE")
        )
        verticalLayers[2] = LedgerProofNode(
            "V".toCharArray(),
            Utility.hexToBytes(
                "5F40073859A8A4E4FEF7DE6BB13902967E491D8471C8DA4B8DD3A95B8755E2E4810C18A5F1D9E9A273931345FF4BDD4F5E64980C861FF74EE7B4AD76A44F043DAA3CD5AD220063907C5B184F1F9045491B01340CF3F422E02FD66C99DCDCE6193CAD49F3136780017ACC39DB6F031041F9DCEF1AE32EFABBA9542EBC94E9A29057F43CD7A164F7A11B75A74949965BE67286AC84EB9AC550D97B7EB229BFDBE1EB4E797DC3CEBE849AA1178E7F93F16108FBB58BDAF0ED8AABFC9C1BE23D7D0DE5E53AA591BCC86380BAC16EFF02A9568C78EC255989D76590C530901BC5EA6E8FAF405AD14082446413616FCC2FAB6C7323A047A9D6EB8A526F9A4CCDB8D811776CE8DC179623C44CCFD25B40226E936D61264D3C74F082D0ADE06DC2F723B3F2699A994E8EFBD93E16C173142F18BC9F19E2066BCB4B2906182D6D03C26EDDE147813A6F09F7FBCA78F0F84D6A1ED75ACDCD21A36A9119BDCB29B53C686C4108CD598E170D6A59717E43B77A58E93D6B7368F95415C38646F9D549051E2E87898E991AC58777A2D25BA0B22B82437788ECD92AB9AF0C47EF8661230F93D799DA0E782C04E011071938664C17166C462D91A6C1C2DEE0A3392A72C83C5FB49515D8BA5FA1D994392B7F2785CDBC08E41A757616B7033EACFA8DC6B2F86F48E2379D2375DCAD289C364CA2051A24B47C843AFD41F69C81D3DAA9FCF934CAA073"
            ),
            Utility.hexToBytes(
                "66E0860795CD4DC38A2414D817174B9562A0E2132C548EC636A7C3806F0058389C37BC421C446FE46B77A0B61E2030E8877028EA5DDB646E9867F392DAE721DAAC0A3EB20885351784A235192BE61D028CDF3505209D97BAFA9B9A00F614862DC82A81DE826CB59DB01796193A1F416C49EE7CA8D2A31C3DEC8D05572B6B20E57E53D8C52EC37FA05EDE4279A2BB249F3BB02AEACE43F9CF47CD4A2338BC35218386E24699961A7C3620780A3FDCA5142E9E3E30B73E228F8C2E8953942F066195D26FE2B8BA6AF5A14AFACA034D6E9FE9BD9DEA58D1AC627B2D3CFD0D4E2C3958335AED080C5E94B2B27341B5894CE9DFCA403C7DB63B0D2FFC2B631A6F46133C3E6D08C5897642C9CE81FA4E450190E4A6044E1B2D34900B2C3ADB64005D974298B367105D6B5EA4346BB65EA95ACAF3C8817135A2D49F501328F064BA85EFEC864C55424FBF0AAA0C8F5E5CDFC7FF4D2A75128F9C2694668219543C907B560CB4D991B29343001D75BA06200290E2302CFBDD7F6172BED18ED6779DCB516F294E5C7CB5F87D5D77FF340A76B2282E9B445FE744F3877CDDD7B2DEA5AA3B6D368448C9E4919516FC596B51BAC0E2E45B7113A70FBBD672013C29F73141382DBF4AB716F8E18B2B38E2D67DC2D1CC3D471C7313A78B36457F660DC71A462F6728EB4DC14D434F06F0450F12DB49D460C819CFDAEE87BF03EABACFA729D2BD47B6B1C3F12B3BF7753DCCA75F87FD6FB5473D7084D8A1FCE62ABE01AA803B605889D98B1E749FC931607103814C0B0525210086853D905D898FCDEC377A106ADB611732B4639BE8B0189A54BC9E17B395DA2DC792342A6BA8498CEBAE814E559938A34A7B25F990C413EF260CAE3DE35119AC6631F81DBA61ACE348BF7732169278F64BD607572625F9A434F7C34F40E336DEBDA27D053E9216305AB1778E19967E51BEE26370B58F2844C40BD6844752CB0F352A34DC851DADC0B85AA239C7BC23932135F3537108415C4BD23B5DFF4D04C63D371D8A0046D946A601CB0841D61CE3C30419B0D4F9FD111B6526675A9109A13079D6E581666574E11DFE1AD5313E5AABDE390C2DE1A8BA9AF6534E80E2AA73F8B64B93C88E2030908C075C6F2A"
            )
        )
        val address = "VHeyHqn7qLUgS6ZvmcDxjAwHgB5iNL"
        val proofOfNonexistence = LedgerProofOfNonexistence(verticalLayers, address)
        Utility.bytesToHex(proofOfNonexistence.ledgerHash)
            .uppercase(Locale.getDefault()) shouldNotBe "7BEBDCECA669943E16000F3B657322B7AD0D5DD012660A59"
    }

    @Test
    fun type2NonexistenceProof_1() {
        // This proof proves that the address VEUJAQb8UaTBFHNRYNDuRo99xC3V8S does not exist in the RHT identified by
        // EF29BC842170FD43D19A8EC74FD9FCFC42E30713F808522D by proving that after routing V, E, U through the tree,
        // the only children of the path VEU start with 'V' or 'j', not the 'J' needed to continue routing this address.
        // This proof is pulled from a tree with 1000 addresses in it.
        val verticalLayers = arrayOfNulls<LedgerProofNode>(3)
        verticalLayers[0] = LedgerProofNode(
            "U".toCharArray(),
            Utility.hexToBytes(""),
            Utility.hexToBytes("")
        )
        verticalLayers[1] = LedgerProofNode(
            "E".toCharArray(),
            Utility.hexToBytes(
                "949270AF0BDD318DCB44F5AF1C464BBB2D6E6BC34BCC4AD7EDD2A28E9B0ACE1FE1A77530E3CE89D744AA262026802F8553CC7645415F9D3344D964B7CED11A9479BF2EA73FC94A776F65DDAB6B4412D4DCFA0964B10BCC2762F35B57903602C3F05F9BDC4A1342198E4E953C9295E6EDB28C1EA101044DC0F8835271442B4F9870064114E06082CEE5E4C4D1FE72782599549343CBA97BAADB62164881C9B0D4CE14CB9D3FC568E978CB515B0718A7FCE386984201EAC89BBF215D53E105A85F84502E239BB6137A438EEC28CAD08B8391C5DB05F3F01A4F36DFA3FF4A10CF89F4E3FBAAE99B20D7C01183F46321C8D5F4E97A54E15BE6A591937511E4DD078DAADD5C12B6097B140DF129D3A5E3174065AAF8A10D68B514EB37DC5A8A882BB03C12F01DA209165B4DEEAEACFD886A94EEEA2BCF76314B2D528613ABD46C893CFF9D70B04ACBD1D539F2BB90784FD98109C16BF9D34EA4104587199CD78320797DECD5CE6E55A2E7C4AE67CBBCFEFF0C3D9D7E680D44B8CA5FCCC6815E12BA067CFE2D9D6080DF2586E65CE339A5AF6A6A3F3AD40CAB702D75C387CA989DA33851D2B2C22F505CAC503919EB1434CC7D69C378DF10BD6354C14393DF173B07AD99FFF86EA140F94FFA3ECBC3DCE30360B0A9BE70580A91CE70D2B252F71A748DAC45EDD2132BC64F08D71FAB0E52EF049675D596244FDA3920D725CEAD731E386453E2A393A602CECF3C7C7393B3142B39228D5E1FD0481CCDDF335777E9B981"
            ),
            Utility.hexToBytes(
                "B0F263A89817EDCE8FEA634366DB25C3E2B54A656AFEE3C51C267005560236F9837DEF70A3443578B4342885226CE12F63DBBCA72B7D7491C437B2070E4F69351BCEB08DBAD3206A188702E2E6A61FA4D77ABC232B520AEB4C5F5E8FB34FEB2F9496AB2055965A3151E65C66DF39F454373BBD641AB4D0A5BB5867FED1DE01078A5E35E396C77418D277B174939F0393663DE0CE30CE6F8A11F75353CC1DD447F5B3DCF27A399E576AC93A40D0F82B68E8C0A6220409E80E3D26F13E0721407D729BA2E7D5747D9147284F79203621917C87492F70DD2D44899BC77F52A8C305CDED4E1D7444CA69A28878DFDF57B21D102493612372D465530A88A4CE4F709E42197B2D5B95F3ED7A8F3CF0EBCBBA9FC336E00EE757F712F4C134C5B92CD5F10CEFB1AA97B6C5C919C1BA0C9D9ABF3DE88D13E848B3E606AF948EA7F40257921AD9A50BA4E607593295A2E024B7325E5FECBCDADC42EF53ED881687B57FF562CD0E23BAAC146BED0AB369CFF14426E9AB3F8A39E2C713C406A9A968A273AB376CCC489411DB893369915133ED0294222C0676B9ED11704285FAF4B4A124AFA09C42C1C2AD76A54A6E64A1480F19247D36C64B728BC60B5DEC0332D97D4C5255723654D0B261080C208FE9D0CEF1CEB8812CBF4B04C47E5A2099298EB6665298663E0CB1D30787176AA015EF76CFC49F656FD4104154B2E5E2D225F1217BA7C5B204B39219A3642EADC2BB6A5876E1767EE21AE03106124EE1196398E3DA450B3026BFEE9A0EAD5B855CA5F7DBBB40EA38317AE7CFD2068B7CC69D5D0B08C610D26B802E00D7BA96D55D8EFEABDE5B9DF1DC8DD3C1499DE781B45E8E3F736314B9684A00ABDC525AD670B224B78045C0FC2641805610900E3C4B78CD11DFD7A4714A10A3A2F41FAA5C2BE7DD85088419844AADCA6F1DDA9FDF5BDCE27DB1715720F4B0F2C67B4671D9FCC2D833FD75EC5AAE2DB91018B77851DAA519D3450766"
            )
        )
        verticalLayers[2] = LedgerProofNode(
            "V".toCharArray(),
            Utility.hexToBytes("5F40073859A8A4E4FEF7DE6BB13902967E491D8471C8DA4B8DD3A95B8755E2E4810C18A5F1D9E9A273931345FF4BDD4F5E64980C861FF74EE7B4AD76A44F043DAA3CD5AD220063907C5B184F1F9045491B01340CF3F422E02FD66C99DCDCE6193CAD49F3136780017ACC39DB6F031041F9DCEF1AE32EFABBA9542EBC94E9A29057F43CD7A164F7A11B75A74949965BE67286AC84EB9AC550D97B7EB229BFDBE1EB4E797DC3CEBE849AA1178E7F93F16108FBB58BDAF0ED8AABFC9C1BE23D7D0DE5E53AA591BCC86380BAC16EFF02A9568C78EC255989D76590C530901BC5EA6E8FAF405AD14082446413616FCC2FAB6C7323A047A9D6EB8A526F9A4CCDB8D811776CE8DC179623C44CCFD25B40226E936D61264D3C74F082D0ADE06DC2F723B3F2699A994E8EFBD93E16C173142F18BC9F19E2066BCB4B2906182D6D03C26EDDE147813A6F09F7FBCA78F0F84D6A1ED75ACDCD21A36A9119BDCB29B53C686C4108CD598E170D6A59717E43B77A58E93D6B7368F95415C38646F9D549051E2E87898E991AC58777A2D25BA0B22B82437788ECD92AB9AF0C47EF8661230F93D799"),
            Utility.hexToBytes(
                "15D8BA5FA1D994392B7F2785CDBC08E41A757616B7033EACFA8DC6B2F86F48E208566E08C0AE81257A2D296A756B2A98EF65B9ED6051447F53351F2FB221C3D1CC2DE49700C9404947A4F748820502353BD00960951383F42451154AB71B0CA566E0860795CD4DC38A2414D817174B9562A0E2132C548EC636A7C3806F0058389C37BC421C446FE46B77A0B61E2030E8877028EA5DDB646E9867F392DAE721DAAC0A3EB20885351784A235192BE61D028CDF3505209D97BAFA9B9A00F614862DC82A81DE826CB59DB01796193A1F416C49EE7CA8D2A31C3DEC8D05572B6B20E57E53D8C52EC37FA05EDE4279A2BB249F3BB02AEACE43F9CF47CD4A2338BC35218386E24699961A7C3620780A3FDCA5142E9E3E30B73E228F8C2E8953942F066195D26FE2B8BA6AF5A14AFACA034D6E9FE9BD9DEA58D1AC627B2D3CFD0D4E2C3958335AED080C5E94B2B27341B5894CE9DFCA403C7DB63B0D2FFC2B631A6F46133C3E6D08C5897642C9CE81FA4E450190E4A6044E1B2D34900B2C3ADB64005D974298B367105D6B5EA4346BB65EA95ACAF3C8817135A2D49F501328F064BA85EFEC864C55424FBF0AAA0C8F5E5CDFC7FF4D2A75128F9C2694668219543C907B560CB4D991B29343001D75BA06200290E2302CFBDD7F6172BED18ED6779DCB516F294E5C7CB5F87D5D77FF340A76B2282E9B445FE744F3877CDDD7B2DEA5AA3B6D368448C9E4919516FC596B51BAC0E2E45B7113A70FBBD672013C29F73141382DBF4AB716F8E18B2B38E2D67DC2D1CC3D471C7313A78B36457F660DC71A462F6728EB4DC14D434F06F0450F12DB49D460C819CFDAEE87BF03EABACFA729D2BD47B6B1C3F12B3BF7753DCCA75F87FD6FB5473D7084D8A1FCE62ABE01AA803B605889D98B1E749FC931607103814C0B0525210086853D905D898FCDEC377A106ADB611732B4639BE8B0189A54BC9E17B395DA2DC792342A6BA8498CEBAE814E559938A34A7B25F990C413EF260CAE3DE35119AC6631F81DBA61ACE348BF7732169278F64BD607572625F9A434F7C34F40E336DEBDA27D053E9216305AB1778E19967E51BEE26370B58F2844C40BD6844752CB0F352A34DC851DADC0B85AA239C7BC23932135F3537108415C4BD23B5DFF4D04C63D371D8A0046D946A601CB0841D61CE3C30419B0D4F9FD111B6526675A9109A13079D6E581666574E11DFE1AD5313E5AABDE390C2DE1A8BA9AF6534E80E2AA73F8B64B93C88E2030908C075C6F2A"
            )
        )
        val horizontalLayers = arrayOfNulls<LedgerProofNode>(2)
        horizontalLayers[0] = LedgerProofNode(
            "VkgZaWuwAjEjKuQuWobHNSFftkh".toCharArray(),
            LedgerValue(1882590, 0, 0)
        )
        horizontalLayers[1] = LedgerProofNode(
            "j7JTc16H1g3X6wWwVzTLD561UF8".toCharArray(),
            LedgerValue(4311886, 0, 0)
        )
        val address = "VEUJAQb8UaTBFHNRYNDuRo99xC3V8S"
        val proofOfNonexistence = LedgerProofOfNonexistence(verticalLayers, address, horizontalLayers)
        proofOfNonexistence.ledgerHash.toList() shouldContainExactly Utility.hexToBytes("EF29BC842170FD43D19A8EC74FD9FCFC42E30713F808522D").toList()
        address shouldBe proofOfNonexistence.address
    }

    @Test
    fun invalidType2NonexistenceProof_1() {
        val verticalLayers = arrayOfNulls<LedgerProofNode>(3)
        verticalLayers[0] = LedgerProofNode(
            "U".toCharArray(),
            Utility.hexToBytes(""),
            Utility.hexToBytes("")
        )

        // Incorrect left child hashes
        verticalLayers[1] = LedgerProofNode(
            "E".toCharArray(),
            Utility.hexToBytes(
                "849270AF0BDD318DCB44F5AF1C464BBB2D6E6BC34BCC4AD7EDD2A28E9B0ACE1FE1A77530E3CE89D744AA262026802F8553CC7645415F9D3344D964B7CED11A9479BF2EA73FC94A776F65DDAB6B4412D4DCFA0964B10BCC2762F35B57903602C3F05F9BDC4A1342198E4E953C9295E6EDB28C1EA101044DC0F8835271442B4F9870064114E06082CEE5E4C4D1FE72782599549343CBA97BAADB62164881C9B0D4CE14CB9D3FC568E978CB515B0718A7FCE386984201EAC89BBF215D53E105A85F84502E239BB6137A438EEC28CAD08B8391C5DB05F3F01A4F36DFA3FF4A10CF89F4E3FBAAE99B20D7C01183F46321C8D5F4E97A54E15BE6A591937511E4DD078DAADD5C12B6097B140DF129D3A5E3174065AAF8A10D68B514EB37DC5A8A882BB03C12F01DA209165B4DEEAEACFD886A94EEEA2BCF76314B2D528613ABD46C893CFF9D70B04ACBD1D539F2BB90784FD98109C16BF9D34EA4104587199CD78320797DECD5CE6E55A2E7C4AE67CBBCFEFF0C3D9D7E680D44B8CA5FCCC6815E12BA067CFE2D9D6080DF2586E65CE339A5AF6A6A3F3AD40CAB702D75C387CA989DA33851D2B2C22F505CAC503919EB1434CC7D69C378DF10BD6354C14393DF173B07AD99FFF86EA140F94FFA3ECBC3DCE30360B0A9BE70580A91CE70D2B252F71A748DAC45EDD2132BC64F08D71FAB0E52EF049675D596244FDA3920D725CEAD731E386453E2A393A602CECF3C7C7393B3142B39228D5E1FD0481CCDDF335777E9B981"
            ),
            Utility.hexToBytes(
                "B0F263A89817EDCE8FEA634366DB25C3E2B54A656AFEE3C51C267005560236F9837DEF70A3443578B4342885226CE12F63DBBCA72B7D7491C437B2070E4F69351BCEB08DBAD3206A188702E2E6A61FA4D77ABC232B520AEB4C5F5E8FB34FEB2F9496AB2055965A3151E65C66DF39F454373BBD641AB4D0A5BB5867FED1DE01078A5E35E396C77418D277B174939F0393663DE0CE30CE6F8A11F75353CC1DD447F5B3DCF27A399E576AC93A40D0F82B68E8C0A6220409E80E3D26F13E0721407D729BA2E7D5747D9147284F79203621917C87492F70DD2D44899BC77F52A8C305CDED4E1D7444CA69A28878DFDF57B21D102493612372D465530A88A4CE4F709E42197B2D5B95F3ED7A8F3CF0EBCBBA9FC336E00EE757F712F4C134C5B92CD5F10CEFB1AA97B6C5C919C1BA0C9D9ABF3DE88D13E848B3E606AF948EA7F40257921AD9A50BA4E607593295A2E024B7325E5FECBCDADC42EF53ED881687B57FF562CD0E23BAAC146BED0AB369CFF14426E9AB3F8A39E2C713C406A9A968A273AB376CCC489411DB893369915133ED0294222C0676B9ED11704285FAF4B4A124AFA09C42C1C2AD76A54A6E64A1480F19247D36C64B728BC60B5DEC0332D97D4C5255723654D0B261080C208FE9D0CEF1CEB8812CBF4B04C47E5A2099298EB6665298663E0CB1D30787176AA015EF76CFC49F656FD4104154B2E5E2D225F1217BA7C5B204B39219A3642EADC2BB6A5876E1767EE21AE03106124EE1196398E3DA450B3026BFEE9A0EAD5B855CA5F7DBBB40EA38317AE7CFD2068B7CC69D5D0B08C610D26B802E00D7BA96D55D8EFEABDE5B9DF1DC8DD3C1499DE781B45E8E3F736314B9684A00ABDC525AD670B224B78045C0FC2641805610900E3C4B78CD11DFD7A4714A10A3A2F41FAA5C2BE7DD85088419844AADCA6F1DDA9FDF5BDCE27DB1715720F4B0F2C67B4671D9FCC2D833FD75EC5AAE2DB91018B77851DAA519D3450766"
            )
        )
        verticalLayers[2] = LedgerProofNode(
            "V".toCharArray(),
            Utility.hexToBytes("5F40073859A8A4E4FEF7DE6BB13902967E491D8471C8DA4B8DD3A95B8755E2E4810C18A5F1D9E9A273931345FF4BDD4F5E64980C861FF74EE7B4AD76A44F043DAA3CD5AD220063907C5B184F1F9045491B01340CF3F422E02FD66C99DCDCE6193CAD49F3136780017ACC39DB6F031041F9DCEF1AE32EFABBA9542EBC94E9A29057F43CD7A164F7A11B75A74949965BE67286AC84EB9AC550D97B7EB229BFDBE1EB4E797DC3CEBE849AA1178E7F93F16108FBB58BDAF0ED8AABFC9C1BE23D7D0DE5E53AA591BCC86380BAC16EFF02A9568C78EC255989D76590C530901BC5EA6E8FAF405AD14082446413616FCC2FAB6C7323A047A9D6EB8A526F9A4CCDB8D811776CE8DC179623C44CCFD25B40226E936D61264D3C74F082D0ADE06DC2F723B3F2699A994E8EFBD93E16C173142F18BC9F19E2066BCB4B2906182D6D03C26EDDE147813A6F09F7FBCA78F0F84D6A1ED75ACDCD21A36A9119BDCB29B53C686C4108CD598E170D6A59717E43B77A58E93D6B7368F95415C38646F9D549051E2E87898E991AC58777A2D25BA0B22B82437788ECD92AB9AF0C47EF8661230F93D799"),
            Utility.hexToBytes(
                "15D8BA5FA1D994392B7F2785CDBC08E41A757616B7033EACFA8DC6B2F86F48E208566E08C0AE81257A2D296A756B2A98EF65B9ED6051447F53351F2FB221C3D1CC2DE49700C9404947A4F748820502353BD00960951383F42451154AB71B0CA566E0860795CD4DC38A2414D817174B9562A0E2132C548EC636A7C3806F0058389C37BC421C446FE46B77A0B61E2030E8877028EA5DDB646E9867F392DAE721DAAC0A3EB20885351784A235192BE61D028CDF3505209D97BAFA9B9A00F614862DC82A81DE826CB59DB01796193A1F416C49EE7CA8D2A31C3DEC8D05572B6B20E57E53D8C52EC37FA05EDE4279A2BB249F3BB02AEACE43F9CF47CD4A2338BC35218386E24699961A7C3620780A3FDCA5142E9E3E30B73E228F8C2E8953942F066195D26FE2B8BA6AF5A14AFACA034D6E9FE9BD9DEA58D1AC627B2D3CFD0D4E2C3958335AED080C5E94B2B27341B5894CE9DFCA403C7DB63B0D2FFC2B631A6F46133C3E6D08C5897642C9CE81FA4E450190E4A6044E1B2D34900B2C3ADB64005D974298B367105D6B5EA4346BB65EA95ACAF3C8817135A2D49F501328F064BA85EFEC864C55424FBF0AAA0C8F5E5CDFC7FF4D2A75128F9C2694668219543C907B560CB4D991B29343001D75BA06200290E2302CFBDD7F6172BED18ED6779DCB516F294E5C7CB5F87D5D77FF340A76B2282E9B445FE744F3877CDDD7B2DEA5AA3B6D368448C9E4919516FC596B51BAC0E2E45B7113A70FBBD672013C29F73141382DBF4AB716F8E18B2B38E2D67DC2D1CC3D471C7313A78B36457F660DC71A462F6728EB4DC14D434F06F0450F12DB49D460C819CFDAEE87BF03EABACFA729D2BD47B6B1C3F12B3BF7753DCCA75F87FD6FB5473D7084D8A1FCE62ABE01AA803B605889D98B1E749FC931607103814C0B0525210086853D905D898FCDEC377A106ADB611732B4639BE8B0189A54BC9E17B395DA2DC792342A6BA8498CEBAE814E559938A34A7B25F990C413EF260CAE3DE35119AC6631F81DBA61ACE348BF7732169278F64BD607572625F9A434F7C34F40E336DEBDA27D053E9216305AB1778E19967E51BEE26370B58F2844C40BD6844752CB0F352A34DC851DADC0B85AA239C7BC23932135F3537108415C4BD23B5DFF4D04C63D371D8A0046D946A601CB0841D61CE3C30419B0D4F9FD111B6526675A9109A13079D6E581666574E11DFE1AD5313E5AABDE390C2DE1A8BA9AF6534E80E2AA73F8B64B93C88E2030908C075C6F2A"
            )
        )
        val horizontalLayers = arrayOfNulls<LedgerProofNode>(2)
        horizontalLayers[0] = LedgerProofNode(
            "VkgZaWuwAjEjKuQuWobHNSFftkh".toCharArray(),
            LedgerValue(1882590, 0, 0)
        )
        horizontalLayers[1] = LedgerProofNode(
            "j7JTc16H1g3X6wWwVzTLD561UF8".toCharArray(),
            LedgerValue(4311886, 0, 0)
        )
        val address = "VEUJAQb8UaTBFHNRYNDuRo99xC3V8S"
        val proofOfNonexistence = LedgerProofOfNonexistence(verticalLayers, address, horizontalLayers)
        Utility.bytesToHex(proofOfNonexistence.ledgerHash)
            .uppercase(Locale.getDefault()) shouldNotBe "EF29BC842170FD43D19A8EC74FD9FCFC42E30713F808522D"
    }

    @Test(expected = IllegalArgumentException::class)
    fun invalidType2NonexistenceProof_2() {
        val verticalLayers = arrayOfNulls<LedgerProofNode>(3)

        // Invalid route
        verticalLayers[0] = LedgerProofNode(
            "v".toCharArray(),
            Utility.hexToBytes(""),
            Utility.hexToBytes("")
        )
        verticalLayers[1] = LedgerProofNode(
            "E".toCharArray(),
            Utility.hexToBytes(
                "949270AF0BDD318DCB44F5AF1C464BBB2D6E6BC34BCC4AD7EDD2A28E9B0ACE1FE1A77530E3CE89D744AA262026802F8553CC7645415F9D3344D964B7CED11A9479BF2EA73FC94A776F65DDAB6B4412D4DCFA0964B10BCC2762F35B57903602C3F05F9BDC4A1342198E4E953C9295E6EDB28C1EA101044DC0F8835271442B4F9870064114E06082CEE5E4C4D1FE72782599549343CBA97BAADB62164881C9B0D4CE14CB9D3FC568E978CB515B0718A7FCE386984201EAC89BBF215D53E105A85F84502E239BB6137A438EEC28CAD08B8391C5DB05F3F01A4F36DFA3FF4A10CF89F4E3FBAAE99B20D7C01183F46321C8D5F4E97A54E15BE6A591937511E4DD078DAADD5C12B6097B140DF129D3A5E3174065AAF8A10D68B514EB37DC5A8A882BB03C12F01DA209165B4DEEAEACFD886A94EEEA2BCF76314B2D528613ABD46C893CFF9D70B04ACBD1D539F2BB90784FD98109C16BF9D34EA4104587199CD78320797DECD5CE6E55A2E7C4AE67CBBCFEFF0C3D9D7E680D44B8CA5FCCC6815E12BA067CFE2D9D6080DF2586E65CE339A5AF6A6A3F3AD40CAB702D75C387CA989DA33851D2B2C22F505CAC503919EB1434CC7D69C378DF10BD6354C14393DF173B07AD99FFF86EA140F94FFA3ECBC3DCE30360B0A9BE70580A91CE70D2B252F71A748DAC45EDD2132BC64F08D71FAB0E52EF049675D596244FDA3920D725CEAD731E386453E2A393A602CECF3C7C7393B3142B39228D5E1FD0481CCDDF335777E9B981"
            ),
            Utility.hexToBytes(
                "B0F263A89817EDCE8FEA634366DB25C3E2B54A656AFEE3C51C267005560236F9837DEF70A3443578B4342885226CE12F63DBBCA72B7D7491C437B2070E4F69351BCEB08DBAD3206A188702E2E6A61FA4D77ABC232B520AEB4C5F5E8FB34FEB2F9496AB2055965A3151E65C66DF39F454373BBD641AB4D0A5BB5867FED1DE01078A5E35E396C77418D277B174939F0393663DE0CE30CE6F8A11F75353CC1DD447F5B3DCF27A399E576AC93A40D0F82B68E8C0A6220409E80E3D26F13E0721407D729BA2E7D5747D9147284F79203621917C87492F70DD2D44899BC77F52A8C305CDED4E1D7444CA69A28878DFDF57B21D102493612372D465530A88A4CE4F709E42197B2D5B95F3ED7A8F3CF0EBCBBA9FC336E00EE757F712F4C134C5B92CD5F10CEFB1AA97B6C5C919C1BA0C9D9ABF3DE88D13E848B3E606AF948EA7F40257921AD9A50BA4E607593295A2E024B7325E5FECBCDADC42EF53ED881687B57FF562CD0E23BAAC146BED0AB369CFF14426E9AB3F8A39E2C713C406A9A968A273AB376CCC489411DB893369915133ED0294222C0676B9ED11704285FAF4B4A124AFA09C42C1C2AD76A54A6E64A1480F19247D36C64B728BC60B5DEC0332D97D4C5255723654D0B261080C208FE9D0CEF1CEB8812CBF4B04C47E5A2099298EB6665298663E0CB1D30787176AA015EF76CFC49F656FD4104154B2E5E2D225F1217BA7C5B204B39219A3642EADC2BB6A5876E1767EE21AE03106124EE1196398E3DA450B3026BFEE9A0EAD5B855CA5F7DBBB40EA38317AE7CFD2068B7CC69D5D0B08C610D26B802E00D7BA96D55D8EFEABDE5B9DF1DC8DD3C1499DE781B45E8E3F736314B9684A00ABDC525AD670B224B78045C0FC2641805610900E3C4B78CD11DFD7A4714A10A3A2F41FAA5C2BE7DD85088419844AADCA6F1DDA9FDF5BDCE27DB1715720F4B0F2C67B4671D9FCC2D833FD75EC5AAE2DB91018B77851DAA519D3450766"
            )
        )
        verticalLayers[2] = LedgerProofNode(
            "V".toCharArray(),
            Utility.hexToBytes("5F40073859A8A4E4FEF7DE6BB13902967E491D8471C8DA4B8DD3A95B8755E2E4810C18A5F1D9E9A273931345FF4BDD4F5E64980C861FF74EE7B4AD76A44F043DAA3CD5AD220063907C5B184F1F9045491B01340CF3F422E02FD66C99DCDCE6193CAD49F3136780017ACC39DB6F031041F9DCEF1AE32EFABBA9542EBC94E9A29057F43CD7A164F7A11B75A74949965BE67286AC84EB9AC550D97B7EB229BFDBE1EB4E797DC3CEBE849AA1178E7F93F16108FBB58BDAF0ED8AABFC9C1BE23D7D0DE5E53AA591BCC86380BAC16EFF02A9568C78EC255989D76590C530901BC5EA6E8FAF405AD14082446413616FCC2FAB6C7323A047A9D6EB8A526F9A4CCDB8D811776CE8DC179623C44CCFD25B40226E936D61264D3C74F082D0ADE06DC2F723B3F2699A994E8EFBD93E16C173142F18BC9F19E2066BCB4B2906182D6D03C26EDDE147813A6F09F7FBCA78F0F84D6A1ED75ACDCD21A36A9119BDCB29B53C686C4108CD598E170D6A59717E43B77A58E93D6B7368F95415C38646F9D549051E2E87898E991AC58777A2D25BA0B22B82437788ECD92AB9AF0C47EF8661230F93D799"),
            Utility.hexToBytes(
                "15D8BA5FA1D994392B7F2785CDBC08E41A757616B7033EACFA8DC6B2F86F48E208566E08C0AE81257A2D296A756B2A98EF65B9ED6051447F53351F2FB221C3D1CC2DE49700C9404947A4F748820502353BD00960951383F42451154AB71B0CA566E0860795CD4DC38A2414D817174B9562A0E2132C548EC636A7C3806F0058389C37BC421C446FE46B77A0B61E2030E8877028EA5DDB646E9867F392DAE721DAAC0A3EB20885351784A235192BE61D028CDF3505209D97BAFA9B9A00F614862DC82A81DE826CB59DB01796193A1F416C49EE7CA8D2A31C3DEC8D05572B6B20E57E53D8C52EC37FA05EDE4279A2BB249F3BB02AEACE43F9CF47CD4A2338BC35218386E24699961A7C3620780A3FDCA5142E9E3E30B73E228F8C2E8953942F066195D26FE2B8BA6AF5A14AFACA034D6E9FE9BD9DEA58D1AC627B2D3CFD0D4E2C3958335AED080C5E94B2B27341B5894CE9DFCA403C7DB63B0D2FFC2B631A6F46133C3E6D08C5897642C9CE81FA4E450190E4A6044E1B2D34900B2C3ADB64005D974298B367105D6B5EA4346BB65EA95ACAF3C8817135A2D49F501328F064BA85EFEC864C55424FBF0AAA0C8F5E5CDFC7FF4D2A75128F9C2694668219543C907B560CB4D991B29343001D75BA06200290E2302CFBDD7F6172BED18ED6779DCB516F294E5C7CB5F87D5D77FF340A76B2282E9B445FE744F3877CDDD7B2DEA5AA3B6D368448C9E4919516FC596B51BAC0E2E45B7113A70FBBD672013C29F73141382DBF4AB716F8E18B2B38E2D67DC2D1CC3D471C7313A78B36457F660DC71A462F6728EB4DC14D434F06F0450F12DB49D460C819CFDAEE87BF03EABACFA729D2BD47B6B1C3F12B3BF7753DCCA75F87FD6FB5473D7084D8A1FCE62ABE01AA803B605889D98B1E749FC931607103814C0B0525210086853D905D898FCDEC377A106ADB611732B4639BE8B0189A54BC9E17B395DA2DC792342A6BA8498CEBAE814E559938A34A7B25F990C413EF260CAE3DE35119AC6631F81DBA61ACE348BF7732169278F64BD607572625F9A434F7C34F40E336DEBDA27D053E9216305AB1778E19967E51BEE26370B58F2844C40BD6844752CB0F352A34DC851DADC0B85AA239C7BC23932135F3537108415C4BD23B5DFF4D04C63D371D8A0046D946A601CB0841D61CE3C30419B0D4F9FD111B6526675A9109A13079D6E581666574E11DFE1AD5313E5AABDE390C2DE1A8BA9AF6534E80E2AA73F8B64B93C88E2030908C075C6F2A"
            )
        )
        val horizontalLayers = arrayOfNulls<LedgerProofNode>(2)
        horizontalLayers[0] = LedgerProofNode(
            "VkgZaWuwAjEjKuQuWobHNSFftkh".toCharArray(),
            LedgerValue(1882590, 0, 0)
        )
        horizontalLayers[1] = LedgerProofNode(
            "j7JTc16H1g3X6wWwVzTLD561UF8".toCharArray(),
            LedgerValue(4311886, 0, 0)
        )
        val address = "VEUJAQb8UaTBFHNRYNDuRo99xC3V8S"
        val proofOfNonexistence = LedgerProofOfNonexistence(verticalLayers, address, horizontalLayers)
        Utility.bytesToHex(proofOfNonexistence.ledgerHash)
            .uppercase(Locale.getDefault()) shouldNotBe "EF29BC842170FD43D19A8EC74FD9FCFC42E30713F808522D"
    }

    @Test
    fun invalidType2NonexistenceProof_3() {
        val verticalLayers = arrayOfNulls<LedgerProofNode>(3)
        verticalLayers[0] = LedgerProofNode(
            "U".toCharArray(),
            Utility.hexToBytes(""),
            Utility.hexToBytes("")
        )
        verticalLayers[1] = LedgerProofNode(
            "E".toCharArray(),
            Utility.hexToBytes(
                "949270AF0BDD318DCB44F5AF1C464BBB2D6E6BC34BCC4AD7EDD2A28E9B0ACE1FE1A77530E3CE89D744AA262026802F8553CC7645415F9D3344D964B7CED11A9479BF2EA73FC94A776F65DDAB6B4412D4DCFA0964B10BCC2762F35B57903602C3F05F9BDC4A1342198E4E953C9295E6EDB28C1EA101044DC0F8835271442B4F9870064114E06082CEE5E4C4D1FE72782599549343CBA97BAADB62164881C9B0D4CE14CB9D3FC568E978CB515B0718A7FCE386984201EAC89BBF215D53E105A85F84502E239BB6137A438EEC28CAD08B8391C5DB05F3F01A4F36DFA3FF4A10CF89F4E3FBAAE99B20D7C01183F46321C8D5F4E97A54E15BE6A591937511E4DD078DAADD5C12B6097B140DF129D3A5E3174065AAF8A10D68B514EB37DC5A8A882BB03C12F01DA209165B4DEEAEACFD886A94EEEA2BCF76314B2D528613ABD46C893CFF9D70B04ACBD1D539F2BB90784FD98109C16BF9D34EA4104587199CD78320797DECD5CE6E55A2E7C4AE67CBBCFEFF0C3D9D7E680D44B8CA5FCCC6815E12BA067CFE2D9D6080DF2586E65CE339A5AF6A6A3F3AD40CAB702D75C387CA989DA33851D2B2C22F505CAC503919EB1434CC7D69C378DF10BD6354C14393DF173B07AD99FFF86EA140F94FFA3ECBC3DCE30360B0A9BE70580A91CE70D2B252F71A748DAC45EDD2132BC64F08D71FAB0E52EF049675D596244FDA3920D725CEAD731E386453E2A393A602CECF3C7C7393B3142B39228D5E1FD0481CCDDF335777E9B981"
            ),
            Utility.hexToBytes(
                "B0F263A89817EDCE8FEA634366DB25C3E2B54A656AFEE3C51C267005560236F9837DEF70A3443578B4342885226CE12F63DBBCA72B7D7491C437B2070E4F69351BCEB08DBAD3206A188702E2E6A61FA4D77ABC232B520AEB4C5F5E8FB34FEB2F9496AB2055965A3151E65C66DF39F454373BBD641AB4D0A5BB5867FED1DE01078A5E35E396C77418D277B174939F0393663DE0CE30CE6F8A11F75353CC1DD447F5B3DCF27A399E576AC93A40D0F82B68E8C0A6220409E80E3D26F13E0721407D729BA2E7D5747D9147284F79203621917C87492F70DD2D44899BC77F52A8C305CDED4E1D7444CA69A28878DFDF57B21D102493612372D465530A88A4CE4F709E42197B2D5B95F3ED7A8F3CF0EBCBBA9FC336E00EE757F712F4C134C5B92CD5F10CEFB1AA97B6C5C919C1BA0C9D9ABF3DE88D13E848B3E606AF948EA7F40257921AD9A50BA4E607593295A2E024B7325E5FECBCDADC42EF53ED881687B57FF562CD0E23BAAC146BED0AB369CFF14426E9AB3F8A39E2C713C406A9A968A273AB376CCC489411DB893369915133ED0294222C0676B9ED11704285FAF4B4A124AFA09C42C1C2AD76A54A6E64A1480F19247D36C64B728BC60B5DEC0332D97D4C5255723654D0B261080C208FE9D0CEF1CEB8812CBF4B04C47E5A2099298EB6665298663E0CB1D30787176AA015EF76CFC49F656FD4104154B2E5E2D225F1217BA7C5B204B39219A3642EADC2BB6A5876E1767EE21AE03106124EE1196398E3DA450B3026BFEE9A0EAD5B855CA5F7DBBB40EA38317AE7CFD2068B7CC69D5D0B08C610D26B802E00D7BA96D55D8EFEABDE5B9DF1DC8DD3C1499DE781B45E8E3F736314B9684A00ABDC525AD670B224B78045C0FC2641805610900E3C4B78CD11DFD7A4714A10A3A2F41FAA5C2BE7DD85088419844AADCA6F1DDA9FDF5BDCE27DB1715720F4B0F2C67B4671D9FCC2D833FD75EC5AAE2DB91018B77851DAA519D3450766"
            )
        )
        verticalLayers[2] = LedgerProofNode(
            "V".toCharArray(),
            Utility.hexToBytes("5F40073859A8A4E4FEF7DE6BB13902967E491D8471C8DA4B8DD3A95B8755E2E4810C18A5F1D9E9A273931345FF4BDD4F5E64980C861FF74EE7B4AD76A44F043DAA3CD5AD220063907C5B184F1F9045491B01340CF3F422E02FD66C99DCDCE6193CAD49F3136780017ACC39DB6F031041F9DCEF1AE32EFABBA9542EBC94E9A29057F43CD7A164F7A11B75A74949965BE67286AC84EB9AC550D97B7EB229BFDBE1EB4E797DC3CEBE849AA1178E7F93F16108FBB58BDAF0ED8AABFC9C1BE23D7D0DE5E53AA591BCC86380BAC16EFF02A9568C78EC255989D76590C530901BC5EA6E8FAF405AD14082446413616FCC2FAB6C7323A047A9D6EB8A526F9A4CCDB8D811776CE8DC179623C44CCFD25B40226E936D61264D3C74F082D0ADE06DC2F723B3F2699A994E8EFBD93E16C173142F18BC9F19E2066BCB4B2906182D6D03C26EDDE147813A6F09F7FBCA78F0F84D6A1ED75ACDCD21A36A9119BDCB29B53C686C4108CD598E170D6A59717E43B77A58E93D6B7368F95415C38646F9D549051E2E87898E991AC58777A2D25BA0B22B82437788ECD92AB9AF0C47EF8661230F93D799"),
            Utility.hexToBytes(
                "15D8BA5FA1D994392B7F2785CDBC08E41A757616B7033EACFA8DC6B2F86F48E208566E08C0AE81257A2D296A756B2A98EF65B9ED6051447F53351F2FB221C3D1CC2DE49700C9404947A4F748820502353BD00960951383F42451154AB71B0CA566E0860795CD4DC38A2414D817174B9562A0E2132C548EC636A7C3806F0058389C37BC421C446FE46B77A0B61E2030E8877028EA5DDB646E9867F392DAE721DAAC0A3EB20885351784A235192BE61D028CDF3505209D97BAFA9B9A00F614862DC82A81DE826CB59DB01796193A1F416C49EE7CA8D2A31C3DEC8D05572B6B20E57E53D8C52EC37FA05EDE4279A2BB249F3BB02AEACE43F9CF47CD4A2338BC35218386E24699961A7C3620780A3FDCA5142E9E3E30B73E228F8C2E8953942F066195D26FE2B8BA6AF5A14AFACA034D6E9FE9BD9DEA58D1AC627B2D3CFD0D4E2C3958335AED080C5E94B2B27341B5894CE9DFCA403C7DB63B0D2FFC2B631A6F46133C3E6D08C5897642C9CE81FA4E450190E4A6044E1B2D34900B2C3ADB64005D974298B367105D6B5EA4346BB65EA95ACAF3C8817135A2D49F501328F064BA85EFEC864C55424FBF0AAA0C8F5E5CDFC7FF4D2A75128F9C2694668219543C907B560CB4D991B29343001D75BA06200290E2302CFBDD7F6172BED18ED6779DCB516F294E5C7CB5F87D5D77FF340A76B2282E9B445FE744F3877CDDD7B2DEA5AA3B6D368448C9E4919516FC596B51BAC0E2E45B7113A70FBBD672013C29F73141382DBF4AB716F8E18B2B38E2D67DC2D1CC3D471C7313A78B36457F660DC71A462F6728EB4DC14D434F06F0450F12DB49D460C819CFDAEE87BF03EABACFA729D2BD47B6B1C3F12B3BF7753DCCA75F87FD6FB5473D7084D8A1FCE62ABE01AA803B605889D98B1E749FC931607103814C0B0525210086853D905D898FCDEC377A106ADB611732B4639BE8B0189A54BC9E17B395DA2DC792342A6BA8498CEBAE814E559938A34A7B25F990C413EF260CAE3DE35119AC6631F81DBA61ACE348BF7732169278F64BD607572625F9A434F7C34F40E336DEBDA27D053E9216305AB1778E19967E51BEE26370B58F2844C40BD6844752CB0F352A34DC851DADC0B85AA239C7BC23932135F3537108415C4BD23B5DFF4D04C63D371D8A0046D946A601CB0841D61CE3C30419B0D4F9FD111B6526675A9109A13079D6E581666574E11DFE1AD5313E5AABDE390C2DE1A8BA9AF6534E80E2AA73F8B64B93C88E2030908C075C6F2A"
            )
        )
        val horizontalLayers = arrayOfNulls<LedgerProofNode>(2)

        // Incorrect signature index
        horizontalLayers[0] = LedgerProofNode(
            "VkgZaWuwAjEjKuQuWobHNSFftkh".toCharArray(),
            LedgerValue(1882590, 0, 1)
        )
        horizontalLayers[1] = LedgerProofNode(
            "j7JTc16H1g3X6wWwVzTLD561UF8".toCharArray(),
            LedgerValue(4311886, 0, 0)
        )
        val address = "VEUJAQb8UaTBFHNRYNDuRo99xC3V8S"
        val proofOfNonexistence = LedgerProofOfNonexistence(verticalLayers, address, horizontalLayers)
        Utility.bytesToHex(proofOfNonexistence.ledgerHash)
            .uppercase(Locale.getDefault()) shouldNotBe "EF29BC842170FD43D19A8EC74FD9FCFC42E30713F808522D"
    }

    @Test
    fun invalidType2NonexistenceProof_4() {
        val verticalLayers = arrayOfNulls<LedgerProofNode>(3)
        verticalLayers[0] = LedgerProofNode(
            "U".toCharArray(),
            Utility.hexToBytes(""),
            Utility.hexToBytes("")
        )
        verticalLayers[1] = LedgerProofNode(
            "E".toCharArray(),
            Utility.hexToBytes(
                "949270AF0BDD318DCB44F5AF1C464BBB2D6E6BC34BCC4AD7EDD2A28E9B0ACE1FE1A77530E3CE89D744AA262026802F8553CC7645415F9D3344D964B7CED11A9479BF2EA73FC94A776F65DDAB6B4412D4DCFA0964B10BCC2762F35B57903602C3F05F9BDC4A1342198E4E953C9295E6EDB28C1EA101044DC0F8835271442B4F9870064114E06082CEE5E4C4D1FE72782599549343CBA97BAADB62164881C9B0D4CE14CB9D3FC568E978CB515B0718A7FCE386984201EAC89BBF215D53E105A85F84502E239BB6137A438EEC28CAD08B8391C5DB05F3F01A4F36DFA3FF4A10CF89F4E3FBAAE99B20D7C01183F46321C8D5F4E97A54E15BE6A591937511E4DD078DAADD5C12B6097B140DF129D3A5E3174065AAF8A10D68B514EB37DC5A8A882BB03C12F01DA209165B4DEEAEACFD886A94EEEA2BCF76314B2D528613ABD46C893CFF9D70B04ACBD1D539F2BB90784FD98109C16BF9D34EA4104587199CD78320797DECD5CE6E55A2E7C4AE67CBBCFEFF0C3D9D7E680D44B8CA5FCCC6815E12BA067CFE2D9D6080DF2586E65CE339A5AF6A6A3F3AD40CAB702D75C387CA989DA33851D2B2C22F505CAC503919EB1434CC7D69C378DF10BD6354C14393DF173B07AD99FFF86EA140F94FFA3ECBC3DCE30360B0A9BE70580A91CE70D2B252F71A748DAC45EDD2132BC64F08D71FAB0E52EF049675D596244FDA3920D725CEAD731E386453E2A393A602CECF3C7C7393B3142B39228D5E1FD0481CCDDF335777E9B981"
            ),
            Utility.hexToBytes(
                "B0F263A89817EDCE8FEA634366DB25C3E2B54A656AFEE3C51C267005560236F9837DEF70A3443578B4342885226CE12F63DBBCA72B7D7491C437B2070E4F69351BCEB08DBAD3206A188702E2E6A61FA4D77ABC232B520AEB4C5F5E8FB34FEB2F9496AB2055965A3151E65C66DF39F454373BBD641AB4D0A5BB5867FED1DE01078A5E35E396C77418D277B174939F0393663DE0CE30CE6F8A11F75353CC1DD447F5B3DCF27A399E576AC93A40D0F82B68E8C0A6220409E80E3D26F13E0721407D729BA2E7D5747D9147284F79203621917C87492F70DD2D44899BC77F52A8C305CDED4E1D7444CA69A28878DFDF57B21D102493612372D465530A88A4CE4F709E42197B2D5B95F3ED7A8F3CF0EBCBBA9FC336E00EE757F712F4C134C5B92CD5F10CEFB1AA97B6C5C919C1BA0C9D9ABF3DE88D13E848B3E606AF948EA7F40257921AD9A50BA4E607593295A2E024B7325E5FECBCDADC42EF53ED881687B57FF562CD0E23BAAC146BED0AB369CFF14426E9AB3F8A39E2C713C406A9A968A273AB376CCC489411DB893369915133ED0294222C0676B9ED11704285FAF4B4A124AFA09C42C1C2AD76A54A6E64A1480F19247D36C64B728BC60B5DEC0332D97D4C5255723654D0B261080C208FE9D0CEF1CEB8812CBF4B04C47E5A2099298EB6665298663E0CB1D30787176AA015EF76CFC49F656FD4104154B2E5E2D225F1217BA7C5B204B39219A3642EADC2BB6A5876E1767EE21AE03106124EE1196398E3DA450B3026BFEE9A0EAD5B855CA5F7DBBB40EA38317AE7CFD2068B7CC69D5D0B08C610D26B802E00D7BA96D55D8EFEABDE5B9DF1DC8DD3C1499DE781B45E8E3F736314B9684A00ABDC525AD670B224B78045C0FC2641805610900E3C4B78CD11DFD7A4714A10A3A2F41FAA5C2BE7DD85088419844AADCA6F1DDA9FDF5BDCE27DB1715720F4B0F2C67B4671D9FCC2D833FD75EC5AAE2DB91018B77851DAA519D3450766"
            )
        )
        verticalLayers[2] = LedgerProofNode(
            "V".toCharArray(),
            Utility.hexToBytes("5F40073859A8A4E4FEF7DE6BB13902967E491D8471C8DA4B8DD3A95B8755E2E4810C18A5F1D9E9A273931345FF4BDD4F5E64980C861FF74EE7B4AD76A44F043DAA3CD5AD220063907C5B184F1F9045491B01340CF3F422E02FD66C99DCDCE6193CAD49F3136780017ACC39DB6F031041F9DCEF1AE32EFABBA9542EBC94E9A29057F43CD7A164F7A11B75A74949965BE67286AC84EB9AC550D97B7EB229BFDBE1EB4E797DC3CEBE849AA1178E7F93F16108FBB58BDAF0ED8AABFC9C1BE23D7D0DE5E53AA591BCC86380BAC16EFF02A9568C78EC255989D76590C530901BC5EA6E8FAF405AD14082446413616FCC2FAB6C7323A047A9D6EB8A526F9A4CCDB8D811776CE8DC179623C44CCFD25B40226E936D61264D3C74F082D0ADE06DC2F723B3F2699A994E8EFBD93E16C173142F18BC9F19E2066BCB4B2906182D6D03C26EDDE147813A6F09F7FBCA78F0F84D6A1ED75ACDCD21A36A9119BDCB29B53C686C4108CD598E170D6A59717E43B77A58E93D6B7368F95415C38646F9D549051E2E87898E991AC58777A2D25BA0B22B82437788ECD92AB9AF0C47EF8661230F93D799"),
            Utility.hexToBytes(
                "15D8BA5FA1D994392B7F2785CDBC08E41A757616B7033EACFA8DC6B2F86F48E208566E08C0AE81257A2D296A756B2A98EF65B9ED6051447F53351F2FB221C3D1CC2DE49700C9404947A4F748820502353BD00960951383F42451154AB71B0CA566E0860795CD4DC38A2414D817174B9562A0E2132C548EC636A7C3806F0058389C37BC421C446FE46B77A0B61E2030E8877028EA5DDB646E9867F392DAE721DAAC0A3EB20885351784A235192BE61D028CDF3505209D97BAFA9B9A00F614862DC82A81DE826CB59DB01796193A1F416C49EE7CA8D2A31C3DEC8D05572B6B20E57E53D8C52EC37FA05EDE4279A2BB249F3BB02AEACE43F9CF47CD4A2338BC35218386E24699961A7C3620780A3FDCA5142E9E3E30B73E228F8C2E8953942F066195D26FE2B8BA6AF5A14AFACA034D6E9FE9BD9DEA58D1AC627B2D3CFD0D4E2C3958335AED080C5E94B2B27341B5894CE9DFCA403C7DB63B0D2FFC2B631A6F46133C3E6D08C5897642C9CE81FA4E450190E4A6044E1B2D34900B2C3ADB64005D974298B367105D6B5EA4346BB65EA95ACAF3C8817135A2D49F501328F064BA85EFEC864C55424FBF0AAA0C8F5E5CDFC7FF4D2A75128F9C2694668219543C907B560CB4D991B29343001D75BA06200290E2302CFBDD7F6172BED18ED6779DCB516F294E5C7CB5F87D5D77FF340A76B2282E9B445FE744F3877CDDD7B2DEA5AA3B6D368448C9E4919516FC596B51BAC0E2E45B7113A70FBBD672013C29F73141382DBF4AB716F8E18B2B38E2D67DC2D1CC3D471C7313A78B36457F660DC71A462F6728EB4DC14D434F06F0450F12DB49D460C819CFDAEE87BF03EABACFA729D2BD47B6B1C3F12B3BF7753DCCA75F87FD6FB5473D7084D8A1FCE62ABE01AA803B605889D98B1E749FC931607103814C0B0525210086853D905D898FCDEC377A106ADB611732B4639BE8B0189A54BC9E17B395DA2DC792342A6BA8498CEBAE814E559938A34A7B25F990C413EF260CAE3DE35119AC6631F81DBA61ACE348BF7732169278F64BD607572625F9A434F7C34F40E336DEBDA27D053E9216305AB1778E19967E51BEE26370B58F2844C40BD6844752CB0F352A34DC851DADC0B85AA239C7BC23932135F3537108415C4BD23B5DFF4D04C63D371D8A0046D946A601CB0841D61CE3C30419B0D4F9FD111B6526675A9109A13079D6E581666574E11DFE1AD5313E5AABDE390C2DE1A8BA9AF6534E80E2AA73F8B64B93C88E2030908C075C6F2A"
            )
        )
        val horizontalLayers = arrayOfNulls<LedgerProofNode>(2)

        // Incorrect balance
        horizontalLayers[0] = LedgerProofNode(
            "VkgZaWuwAjEjKuQuWobHNSFftkh".toCharArray(),
            LedgerValue(1882591, 0, 0)
        )
        horizontalLayers[1] = LedgerProofNode(
            "j7JTc16H1g3X6wWwVzTLD561UF8".toCharArray(),
            LedgerValue(4311886, 0, 0)
        )
        val address = "VEUJAQb8UaTBFHNRYNDuRo99xC3V8S"
        val proofOfNonexistence = LedgerProofOfNonexistence(verticalLayers, address, horizontalLayers)
        Utility.bytesToHex(proofOfNonexistence.ledgerHash)
            .uppercase(Locale.getDefault()) shouldNotBe "EF29BC842170FD43D19A8EC74FD9FCFC42E30713F808522D"
    }

    @Test(expected = IllegalArgumentException::class)
    fun invalidType2NonexistenceProof_5() {
        val verticalLayers = arrayOfNulls<LedgerProofNode>(3)
        verticalLayers[0] = LedgerProofNode(
            "U".toCharArray(),
            Utility.hexToBytes(""),
            Utility.hexToBytes("")
        )
        verticalLayers[1] = LedgerProofNode(
            "E".toCharArray(),
            Utility.hexToBytes(
                "949270AF0BDD318DCB44F5AF1C464BBB2D6E6BC34BCC4AD7EDD2A28E9B0ACE1FE1A77530E3CE89D744AA262026802F8553CC7645415F9D3344D964B7CED11A9479BF2EA73FC94A776F65DDAB6B4412D4DCFA0964B10BCC2762F35B57903602C3F05F9BDC4A1342198E4E953C9295E6EDB28C1EA101044DC0F8835271442B4F9870064114E06082CEE5E4C4D1FE72782599549343CBA97BAADB62164881C9B0D4CE14CB9D3FC568E978CB515B0718A7FCE386984201EAC89BBF215D53E105A85F84502E239BB6137A438EEC28CAD08B8391C5DB05F3F01A4F36DFA3FF4A10CF89F4E3FBAAE99B20D7C01183F46321C8D5F4E97A54E15BE6A591937511E4DD078DAADD5C12B6097B140DF129D3A5E3174065AAF8A10D68B514EB37DC5A8A882BB03C12F01DA209165B4DEEAEACFD886A94EEEA2BCF76314B2D528613ABD46C893CFF9D70B04ACBD1D539F2BB90784FD98109C16BF9D34EA4104587199CD78320797DECD5CE6E55A2E7C4AE67CBBCFEFF0C3D9D7E680D44B8CA5FCCC6815E12BA067CFE2D9D6080DF2586E65CE339A5AF6A6A3F3AD40CAB702D75C387CA989DA33851D2B2C22F505CAC503919EB1434CC7D69C378DF10BD6354C14393DF173B07AD99FFF86EA140F94FFA3ECBC3DCE30360B0A9BE70580A91CE70D2B252F71A748DAC45EDD2132BC64F08D71FAB0E52EF049675D596244FDA3920D725CEAD731E386453E2A393A602CECF3C7C7393B3142B39228D5E1FD0481CCDDF335777E9B981"
            ),
            Utility.hexToBytes(
                "B0F263A89817EDCE8FEA634366DB25C3E2B54A656AFEE3C51C267005560236F9837DEF70A3443578B4342885226CE12F63DBBCA72B7D7491C437B2070E4F69351BCEB08DBAD3206A188702E2E6A61FA4D77ABC232B520AEB4C5F5E8FB34FEB2F9496AB2055965A3151E65C66DF39F454373BBD641AB4D0A5BB5867FED1DE01078A5E35E396C77418D277B174939F0393663DE0CE30CE6F8A11F75353CC1DD447F5B3DCF27A399E576AC93A40D0F82B68E8C0A6220409E80E3D26F13E0721407D729BA2E7D5747D9147284F79203621917C87492F70DD2D44899BC77F52A8C305CDED4E1D7444CA69A28878DFDF57B21D102493612372D465530A88A4CE4F709E42197B2D5B95F3ED7A8F3CF0EBCBBA9FC336E00EE757F712F4C134C5B92CD5F10CEFB1AA97B6C5C919C1BA0C9D9ABF3DE88D13E848B3E606AF948EA7F40257921AD9A50BA4E607593295A2E024B7325E5FECBCDADC42EF53ED881687B57FF562CD0E23BAAC146BED0AB369CFF14426E9AB3F8A39E2C713C406A9A968A273AB376CCC489411DB893369915133ED0294222C0676B9ED11704285FAF4B4A124AFA09C42C1C2AD76A54A6E64A1480F19247D36C64B728BC60B5DEC0332D97D4C5255723654D0B261080C208FE9D0CEF1CEB8812CBF4B04C47E5A2099298EB6665298663E0CB1D30787176AA015EF76CFC49F656FD4104154B2E5E2D225F1217BA7C5B204B39219A3642EADC2BB6A5876E1767EE21AE03106124EE1196398E3DA450B3026BFEE9A0EAD5B855CA5F7DBBB40EA38317AE7CFD2068B7CC69D5D0B08C610D26B802E00D7BA96D55D8EFEABDE5B9DF1DC8DD3C1499DE781B45E8E3F736314B9684A00ABDC525AD670B224B78045C0FC2641805610900E3C4B78CD11DFD7A4714A10A3A2F41FAA5C2BE7DD85088419844AADCA6F1DDA9FDF5BDCE27DB1715720F4B0F2C67B4671D9FCC2D833FD75EC5AAE2DB91018B77851DAA519D3450766"
            )
        )
        verticalLayers[2] = LedgerProofNode(
            "V".toCharArray(),
            Utility.hexToBytes("5F40073859A8A4E4FEF7DE6BB13902967E491D8471C8DA4B8DD3A95B8755E2E4810C18A5F1D9E9A273931345FF4BDD4F5E64980C861FF74EE7B4AD76A44F043DAA3CD5AD220063907C5B184F1F9045491B01340CF3F422E02FD66C99DCDCE6193CAD49F3136780017ACC39DB6F031041F9DCEF1AE32EFABBA9542EBC94E9A29057F43CD7A164F7A11B75A74949965BE67286AC84EB9AC550D97B7EB229BFDBE1EB4E797DC3CEBE849AA1178E7F93F16108FBB58BDAF0ED8AABFC9C1BE23D7D0DE5E53AA591BCC86380BAC16EFF02A9568C78EC255989D76590C530901BC5EA6E8FAF405AD14082446413616FCC2FAB6C7323A047A9D6EB8A526F9A4CCDB8D811776CE8DC179623C44CCFD25B40226E936D61264D3C74F082D0ADE06DC2F723B3F2699A994E8EFBD93E16C173142F18BC9F19E2066BCB4B2906182D6D03C26EDDE147813A6F09F7FBCA78F0F84D6A1ED75ACDCD21A36A9119BDCB29B53C686C4108CD598E170D6A59717E43B77A58E93D6B7368F95415C38646F9D549051E2E87898E991AC58777A2D25BA0B22B82437788ECD92AB9AF0C47EF8661230F93D799"),
            Utility.hexToBytes(
                "15D8BA5FA1D994392B7F2785CDBC08E41A757616B7033EACFA8DC6B2F86F48E208566E08C0AE81257A2D296A756B2A98EF65B9ED6051447F53351F2FB221C3D1CC2DE49700C9404947A4F748820502353BD00960951383F42451154AB71B0CA566E0860795CD4DC38A2414D817174B9562A0E2132C548EC636A7C3806F0058389C37BC421C446FE46B77A0B61E2030E8877028EA5DDB646E9867F392DAE721DAAC0A3EB20885351784A235192BE61D028CDF3505209D97BAFA9B9A00F614862DC82A81DE826CB59DB01796193A1F416C49EE7CA8D2A31C3DEC8D05572B6B20E57E53D8C52EC37FA05EDE4279A2BB249F3BB02AEACE43F9CF47CD4A2338BC35218386E24699961A7C3620780A3FDCA5142E9E3E30B73E228F8C2E8953942F066195D26FE2B8BA6AF5A14AFACA034D6E9FE9BD9DEA58D1AC627B2D3CFD0D4E2C3958335AED080C5E94B2B27341B5894CE9DFCA403C7DB63B0D2FFC2B631A6F46133C3E6D08C5897642C9CE81FA4E450190E4A6044E1B2D34900B2C3ADB64005D974298B367105D6B5EA4346BB65EA95ACAF3C8817135A2D49F501328F064BA85EFEC864C55424FBF0AAA0C8F5E5CDFC7FF4D2A75128F9C2694668219543C907B560CB4D991B29343001D75BA06200290E2302CFBDD7F6172BED18ED6779DCB516F294E5C7CB5F87D5D77FF340A76B2282E9B445FE744F3877CDDD7B2DEA5AA3B6D368448C9E4919516FC596B51BAC0E2E45B7113A70FBBD672013C29F73141382DBF4AB716F8E18B2B38E2D67DC2D1CC3D471C7313A78B36457F660DC71A462F6728EB4DC14D434F06F0450F12DB49D460C819CFDAEE87BF03EABACFA729D2BD47B6B1C3F12B3BF7753DCCA75F87FD6FB5473D7084D8A1FCE62ABE01AA803B605889D98B1E749FC931607103814C0B0525210086853D905D898FCDEC377A106ADB611732B4639BE8B0189A54BC9E17B395DA2DC792342A6BA8498CEBAE814E559938A34A7B25F990C413EF260CAE3DE35119AC6631F81DBA61ACE348BF7732169278F64BD607572625F9A434F7C34F40E336DEBDA27D053E9216305AB1778E19967E51BEE26370B58F2844C40BD6844752CB0F352A34DC851DADC0B85AA239C7BC23932135F3537108415C4BD23B5DFF4D04C63D371D8A0046D946A601CB0841D61CE3C30419B0D4F9FD111B6526675A9109A13079D6E581666574E11DFE1AD5313E5AABDE390C2DE1A8BA9AF6534E80E2AA73F8B64B93C88E2030908C075C6F2A"
            )
        )
        val horizontalLayers = arrayOfNulls<LedgerProofNode>(2)

        // Incorrect balance
        horizontalLayers[0] = LedgerProofNode(
            "VkgZaWuwAjEjKuQuWobHNSFftkh".toCharArray(),
            LedgerValue(1882590, 0, 0)
        )
        horizontalLayers[1] = LedgerProofNode(
            "j7JTc16H1g3X6wWwVzTLD561UF8".toCharArray(),
            LedgerValue(4311886, 0, 0)
        )

        // Proof does not apply to address
        val address = "VERmAAAAAAAAAAAAAAAAAAAAABkLmD"
        val proofOfNonexistence = LedgerProofOfNonexistence(verticalLayers, address, horizontalLayers)
    }

    @Test
    fun type2NonexistenceProof_2() {
        // This proof proves that the address V3h7iMk73xWgQi1VkcysCbnjq2Q7my does not exist in the RHT identified by
        // 921A7A3E30EC7894F2F821F24CE8C898AFDE0F341C137797 by proving that after routing V, 3, h through the tree,
        // the only children of the path V3h start with 'K', 'g', or 'q', not the '7' needed to  continue routing this
        // address.
        // This proof is pulled from a tree with 5000 addresses in it.
        val verticalLayers = arrayOfNulls<LedgerProofNode>(3)
        verticalLayers[0] = LedgerProofNode(
            "h".toCharArray(),
            Utility.hexToBytes(""),
            Utility.hexToBytes("")
        )
        verticalLayers[1] = LedgerProofNode(
            "3".toCharArray(),
            Utility.hexToBytes(
                "805FD678613678A1ACAA9269811C64E4D1EF19F9222F134BBCAE3085DE9B71ECC060B422CCFC9FA1D4F97EE07E0D4583F2C31DD32720F487E5C230C7DA05BCCA946E86459E9B5453C1D24772FA22A45510D83C0D48617CF75562CC3D27DF83FFE8BFC7D4BFADE36E3288D06FB62A0BDC3684981457F02AB7E581552BC4A0F4F6F8FBBCDBCAD0E1FB6789E3A1B02A465DDF4B503303E4C25A1F4A350B5ACB1346B78727520EBFE77002754EEFDCC24D573CCD0637E3450BAA073F850E93E607F12E5FA595064FBB3BB347F2A4A98BED3C3B76FAD898C0062ED24E97F26787E4B7F3B4BBF4BE0BAA0D3B123560BDA8F22BECFE4BFE5FF6F5AF478472B629ABC9A60CC0859955DA7968308BA74AC6C028E98CFB0387099F5047BA763FD5B058224011C4F1A385A02DA426A2246CF4D766C531F165BD0C8A9BCB40BDF688EE5F74735D366F2AFF394FBBE34A58EC97A23E663CA657B0E007612A04C5A54538630864A42B7C3B57C07D05E4DAE8D8D6FB84D6FB2CEA6A770C387575C836079FBE35EA05720771E820976FE1215D9A1937F746D5EA5EF467DA302F4AFFF7A10A2C18CD9FB4C7FF5063377BA92DCBB87718AEC1008DA0727048508F1F1CCE6072037483FB178397D9FBBECAF500CE655DFC9087A55FC5D069B70870C578EDDA8B0219FD84AB3D60CFDAFC274698947A72A3F38F5C9B399D77E2FABB3361A19233C544B6853C48A29565BD574074113EB330677037699446626C834D6EC97A822364D5E925D12BD69EB6A744F90FFFD3DDDCEDE4572DB14BBB30920BC96DD29357FA8B8CB21B44651536B809E5E6FFE6E597B70D1B3980635F5D517A6C139D8C82B2F0AF2F4C8D7BE47E6992302BC52054C81C631A9E41714F5A53781A27FB776F288A54ECD11ADC01FBBC6576FA073853819BE4C2740030A1CE452C7F980F376FB30329BE79D2268EB855B86008175B7AD9048AC1B680CF02D3BD3D27FC8A0F58545F6A40915391AC30758C3ABAF3F37FE2D6BF39882A770E7B8F21CC7B49FCBACF101BD01871B949F2A3374AC30E98154A87D0DDB649681E9F03462E8EC8B714FEFBE644284C2453C6B5909F86232132AA80319A13D2D12D15023AEBBE67BE22AE1D5FC613BAD41A09A7CDA6F5A93BFE38715B3C548257FB1E12F8A0C619A3158EB7F2D637F792217566455DBF03572AE6680609101E06105275CC6DB5B91112835B850EFDB0488ADC0AA15ACFC1E3B61B47B9E635AD11A71C109AD7CF376577DE9D6B9A40E98AF72952E73DFBAA69BD5C5C538B5E16C1B78267199DD828D66C353090712047C7B8DD7A240CFA850C7BF13357E99C117C5012DE73D23539ACC6650EC6FA33E6DA3D8E87A98F487B48F5C2D7B5061BE3FFB0F754E573A2462EBB341DF6B371DE0516BB57FD4274C1BB726CE1AC0B67C97B6A19C174E6E7DC7122C40A18C446B2B15B8EB591B2D0C5BC3CAB0665749C5C63BC2E395A2DB16FBF4027A6A678BA7BE8116D89A8B4FDB6834915ED8C6242FA841DEDCACBB64B5937FE8967C5040F5497F89252682FA9BCD0DA0009400D535B5F36D199920EC0D000E60B64626A4AF34B2D84B115C363C2E92BCCE7AA4A84921E5D68C34BFB44FBE1F82CC520AD520DF3B4B749827AC060D76E6572E780FB1EA3AA62AD8227F02819F012EDCCC320E3D60EAC55F7A60D9AAB160A3FEA70606C4D8618F395C554DA5AE3BD2F7D224B0F7C92C7E3976C06F3CD8AA1F5808E5DB6973840C4D16BA9D6F281FBCCB043CB9A417F473ACFDC2F5F7446415DCA2CD3DCB59A42FF822F0A1F3EC1E7B08A"
            ),
            Utility.hexToBytes(
                "B01050CB424B836633F8B2A5D49BA0D683D046E0FF1AF0F27BE3236B634BCF5801E167971F01FFDE09D5A96A408D37EA05E1B5A4A9F47597FF281708D044D1369FF68D822BD2F2E8CC0A4619C06250F1EE41063D6285DCAFD50A804C701166844F276D733969C260DEA862628377A0386750260D0291085327BA021DB1523D1DA81A97E35C2EC176BD38078B08A0D7372ED54E6DBCA6FCF665C09E75F49EF019F424910896AD6CD1001B00A7A438075CF487D33B999CC953FDEEDFF63E7A0438033EFF4F444E0EB54E8961C182A0986CFC852F7EB3CC73933ED03779AB45F87752AD4B1904E558EDE2C5B6BC09430C056438418157E8313203944DCBB1FDAB41C14FDA39F54F481AFD9E0CF13599EDC66B0A40B3B2EFA882D7D5F84F0D6D861A311E56981ADE32E056D7F60002D103AB616EAEA71338BA67CF73F66C988EDC11E6EBAB6369F82EB0173FB5CA48BCE442DFA9D758405CF258B7B71AC2B31F4DF004B6607C055BED38F679CAE9C90859D44B85BEA56CD4FCC2A0B1447105295CA4001DD0529A745ECB933C833BB92DFF8161AF2FC32AF6E5647C679B9D457B7A4DAEDF4D2D9EBA7F35B904A01E0C77FF39C032BDF3083A8A057C175785F1E5AE116C148BA12340F22A663DBCF480FC4B7BEDE5BD097ED90DB50E31CBDDA4221EFB33C5D5C10273070D19A0349109EBCBAB204DC8DA17A9FB39C0EA65533D8EF581AFD94647F388DBCD7E439ABEDFC466EA6F9B40D7323651AAAD049E13DC5984CF"
            )
        )
        verticalLayers[2] = LedgerProofNode(
            "V".toCharArray(),
            Utility.hexToBytes("2FEDDA860FE494CBEA85D58387DC5CB70D21231ADCF6930861D42067FDEB2B40FF637E9104EBB28052EB26693E318158F2E2510149BCE84ACC79C73872AA0587"),
            Utility.hexToBytes(
                "CCEB8DACE785FB9FDCF251773BB31257B10E425F0853CF48CE389EB3D9F2DD952275EC5BC412E65DAF37DEB4804498D3F55031D267BD3616449B0B70BCF625A2ECB3FE599B7009EC0DE78ABA6AD820812C3C6E85E52EDC006202BE92C2E238A12FC08C4606888C3392616B1D1E4AC3C690F2A25FDEE357B2E1DA555F6790485C317245FC99B68461A2E71C844295F1DEE2A174D5784FE4DC3B93784D67480382F64F0CF56480554EEEFF6ED91D78398F9DDF103BE1E617CA1ACEAEB16E794C6259CF0DC85152793B55DE495249F26538464BAB9C1C2751F7C5F81BD181FCA93C8D2F86117EA6F109C42B65BBFFB997DCD5DD11A1B2E48B2A2830E71F310666AEEB8DF0A9048602D0844BC435D21B2F97A3F91FB84B70A694F60372DFBDF6AB8AC3777752405873EFF303E16C5EDB7D621785D8826E09DECED9EA6F5BAEC3757AF40FBA4D4F3FDC1D1314B2F8AF752DABD05F5F7AAD1F100F87EF78338C36F509D1B049BD5E6EF96593708D282B68CBD391ABBAF5E3A4E9015C1A611D68A18992691380080A86D7D0885813064D2A3E0343DE6347ECCEA1BC329714E62290EA554FCC93B5966FD70528D7C8B08480BD8D48F882031A8F9B6A2F58C9A4F3C5DB4CF9B5B1CE64E68E2A98F98292009261412F983C0225B6B97F6F01AF3DCE2BBA183C0D7262EBAC0854392EA4DA3F967639DD053D7CE1700B8B82810AC9A6F8A16CB43C22B2BD5F9F3E5B365F58DD9F0FEF92923509F7D9E0AD59ABD6C96B90D515A45CBDF11D3B58E5EC5877EDF0EECEA864D15CBA46E765F7A660D32A8B05FE329EA662804D064237378F66E55841DC27CB433C822198707B8528F3842F206326D7E4E4E961FE8B959EA103F311D8551C52B149096AE1948D5865299CCB2D8B6F388AC806ED3B84646D0D867721DD16E515997E76728C06A9198B5F2F6DE2CB3362D9F3DE33C0765F21B7E747B59E4F0AB9F156F5238A53A580C3D16DAC202837A2A4DA21AE1795DF3EC388DE8F943AA16AF83D6E2F77499FD371845A5C8549A76E1582365A6E5B225A00E69A9C7547F0414BA6754535AAF5B4D22BAC85D023CC1C51357A90FC9D8D718FB2D48BE252E7AD7AA379756F095F248889C2F2D088350C430B25E75CEDC008686CE6053F892426B6609D1F568DB98C5F6CDE57683CE3C64A1C488DACB6D6108A784154538F3D602857DC0658A375D7570DB1A50ABFACE3F7DAB618F2FE4B80B07F38CD33B2744BDCEF69A906ED2B61806E2FC9E840BD5BA68401C26D7C264F72BA4B6D14EDDEFB22B586C885962365D7B81E36BF41C762636FB5F0DB0221EF8EF2D6745688F7B4894EA60473B79E8BCC9F7D5553E0CD659FF2693B4DB0216B5B15CA998B387F3DBABA8D23A88FA8E7E1F28EB95624F1F7DE0DEA28AA36A9D96BA54154EF98C1C890FDD5A5DCDFAAF9ABBEF3E07C3CF623F25FB81CEF04A0B3CD09E1B8862DF88BC05D20EB0675797853A3765D8520A77721CBF4835D33D8B3440DE18556A8DA828A2BDD06385CA367D8F22923E54C0DA02E3B0560634F37534691FF2B485F80BFDD2A97EF6F129D84C55FC2FB01834020425ECAC530F0B73111067575D11056FAAFE342191A2150984C9258BE80AB41C3CCC885A5573C1CAA5DC9A64F8EC9F5782D0FA7D1A40FDE312BAE37B720CCE6FBDE44079166DEFDD8BAEE80180636B892F03D948A699812CBE6860FC90CDE00B83BA5314CCD60B0D1A96A99F0CF7496674D05489517B5D2222E0A52C72693B8270D2D88F9B57EEB1C352606FD3D1468E8A298A05A67D41C4B88DFB627EB6EF170DB27B42F953E06E95970C7555C857959960B0FED2EBB681E229647012070CE32A63CE0F3644066FF8A561E1ACFA3D9F2F033E2BBF5F28BA3C33F5DB2A252D6CFAC9B2154944FDD289532FD5AA33510D5798F9C11DF2914CA808CF083F896CB44B96AE750D67AD0F6C2719F62B9220546AA8E2EFD59D07F331032100E2D36CC2F9E5C4F4625DE40EACB31A359984F968457968E528B5745FD9B0292A0C6F97CC86C24E98E8382EBB2E89B726BB5FE568957056CFD2AC7DBFF552966C9FF2D63DF9CFFC5BC472B8DB05361E4AB29F279AE0FEE80A3884A737772E9232E54681495E4757765EACE96A96A28DA71614CDA27BF11C4EDCD1E878D0BE05A4FC68CB45830051926202E55804FE9EA37D3F0A4AACF19CCEC7F1FA84DD3DB36F7754068387CA62ED1C66E7149FDC6F14980AB5561F0CACBC55CB8EDD69FE7F2D6377AE566FEDC8D083E406E3D69A880EB40966F0B9F5AAE3D6E2E30CCC0DB07A01DE9A8393E3388BC43C23DBB1BA7C576A708814723FFEC2F0586023BB8615C0D876D55005AF29FCDD6D15D5BC7532A1951B60D695F9FDECFC7F7B605F1799B724DFE86C0DB63BF3C36BF81884B640F0B195724039852E7A8F0D3DA447AB57A15E9E454CE7781119E4FB91810EC16CFC9DB9A55E3B197FDA63C1C35231CCBE2E1162B8A"
            )
        )
        val horizontalLayers = arrayOfNulls<LedgerProofNode>(4)
        horizontalLayers[0] = LedgerProofNode(
            "8".toCharArray(),
            Utility.hexToBytes("D5549C4AD49F419B6453BFDA7D7CA34D84CEDBA5D695BF1FC4BC69E6601252BD6B7A0C2EFE4BACB294198EE4BA7D1A9CF2A50FA8F546AE6C4FD3DB2EC4E47DBE"),
            Utility.hexToBytes("")
        )
        horizontalLayers[1] = LedgerProofNode(
            "KHUGvVaA2MmVHG2NCNwLaj4Nq9z".toCharArray(),
            LedgerValue(6072316, 0, 0)
        )
        horizontalLayers[2] = LedgerProofNode(
            "gVr9DTgGkJKawuwDo82HdF2bEh3".toCharArray(),
            LedgerValue(1059263, 0, 0)
        )
        horizontalLayers[3] = LedgerProofNode(
            "qQPeRNTLbbxhyS36d5G5k58xZ1E".toCharArray(),
            LedgerValue(8035420, 0, 0)
        )
        val address = "V3h7iMk73xWgQi1VkcysCbnjq2Q7my"
        val proofOfNonexistence = LedgerProofOfNonexistence(verticalLayers, address, horizontalLayers)
        proofOfNonexistence.ledgerHash.toList() shouldContainExactly Utility.hexToBytes("921A7A3E30EC7894F2F821F24CE8C898AFDE0F341C137797").toList()
        address shouldBe proofOfNonexistence.address
    }

    @Test
    fun type2NonexistenceProof_3() {
        // This proof proves that the address VCBWG6EwQJh9vTYoVgvPH6sdgHoLDC does not exist in the RHT identified by
        // EECD6CDCFAA005F79497540BC3C1B81445814DA9F3CC4A49 by proving that after routing V, C, B through the tree,
        // the only children of the path VCB start with 'H', 'K', 'P', 'Z', 'c', 'r', or 's',  not the 'W' needed to
        // continue routing this address.
        // This proof is pulled from a tree with 10000 addresses in it.
        val verticalLayers = arrayOfNulls<LedgerProofNode>(3)
        verticalLayers[0] = LedgerProofNode(
            "B".toCharArray(),
            Utility.hexToBytes(""),
            Utility.hexToBytes("")
        )
        verticalLayers[1] = LedgerProofNode(
            "C".toCharArray(),
            Utility.hexToBytes("A5046AEC7E8CF61C56F8D055E64778021904A1D38FC95171C3C770E973F4F6026401841C159FEE366AF27F550AF209BF749111218C3410C97F9A137375DC7ED16CBA235F83931EFD8DC2F3A2FBE5D977A898C577901882C3B3F20C75B5A628D9A329E2483E564557047417B507856531701908D05F0FEEF5AE0444C6E0F3D53ECC335DF8AC48D4952F72DDDF37CCF11E0CB84A3024B235B13A024283C89E1BA45D763773811D6F7EEEA7AE526F6520DACB621F5951679809BE93C3C13C249B30DB526299636B1CC6EADA86D9224EC24D2904D8C614225A41D8932C4DABAE3DE864532C474037D149A4A446764CE87B7D70431984DD9B8C849760F7669710FEF8E2172FF891C0065558953951D4112E100C44390E401DE70B132930EFD907A6B1BF819758493DF6B1EFCF1B0D490BA8AD756B4047EABB0930E5F838C357006400"),
            Utility.hexToBytes(
                "605636897A55636F59CFC21DFA7C87651E025A5D2D964D41D0A9E19081C8AB9557317EB520A9130A61B08A9A1B6B26FAAEE0E903F300EB35FD12C63A78594B47CBEB526235BE1445DBE3EBD3D13B9F39E6A1B36F616664AA0CB4A88393FA08CE756BFE624C68566ED40FBC95A1D6A97EA3A2D6333BD6B79D610489BA7E329E29CF4FF93EB683833952B98E52118B3B5D31AB80F5BD17B87301DAC71D06789756CF26956D4ADA897F8D2C7641110420B3200A020E712F29A95DC13E3DAC61A583D67F79148121D34B18814B50409D1549B2755330DAE5CAB626FC4C0C9289EFC0A7917F6EC0741A0D1B90A428D3903330F846706F0AD41F245410CA18ED59EF00EC8EB79CFD16F1A3DB833C263232B336E8107FC9FDEF4892E47B0FEF0A745F218B9F7C0E07E435C5EB8441E9A001D242D623B28BB401E49052666DF3A11A76A373D485850F18ED1150A743179FA8FD17B044E78EF32030602D041634942FD4097B617454E6C9D47A2D0EFE38FF1D9E0FFB949451DE08811C623406D5E457B4F7A96B915A991CED9B29C9C2D968B204D09F2D000162DAA854E8D95C6ED1C0AFAD0095977205AFCC1E40AD2F2B5C8A31C1A0D17CF1B7735B8844DDFBEC412D0DC1D8CE60E303E2E00FA166D9EE94B1684E4B873C1E6888000768986DF61769D5491488C2BCD1D300A1FD8098A52FBD73A517D90F840F2CFCFFDBBFE5A337047BADBE545D73FC019ED89DA45CB4C6BAAA56D074B4F30DC5A5857D2B4E4B294739C5888CBCE18E974628F28FE83B3B172EC48103B3035EFD2BEE654D0D11F253D9E635BF5C7025B5711517D11A39C94B5203A2DAB170B4844DB18F91124EC68005DB98054DE1BA89E1494CFF19B1FF4CDA9EAF90CE015859E693733C946DF988CE9F0510C70DC4DE3EC3613B02587435D82C63884F6859D424A207194D65850A7C3A48D0CD3DFEF14A27C11AD3C92183EEF44345257D03E72DA22E4333D77F32291C4FEDA3A95A723A63197F17C6D74DD766C704A0BCD13679BF102733C57BEC9C8EEE92C3BEE45D148B72EE6BAECFA3ADCDE833A3777CAF3C2863922955E7EF76ABA2B484F6ED8BE12073EA4573A57F255E21DB13DEBCBC72E0B96A2EAC0A0D36503A0E1D5608E0D04DFE0CAF9021756AC8929E1E666B9564F321CBE96C557217F774088F66019BB536E6EFC26FC8C1C4EE1E714AE6854F1537775CF941C38DC65BCC8702FEAE0AA1A070FB1E52646CB47F49470ED554DC17B6FE3F5258CD29D6D1BB38D04DB84A6485C361C9B3E6AAB0BB44E32F5D392768C57E4B950DF682808CD4ECC6A8E7ADE4063A0FC7AAFD58F11370E4637A7EC03DE1BA9C6BD177A06C10DD9F339B406800922FFFFAC144D53966004000B272C9A3EA409E4F225D86EFF983FE07F20B42E240EFF3B93E11441C0ED909FCB0B39265B00DB619DF694DE33CD831033E6A4E02D99AE17ED2161D5017C192209B9CD344709E260703516B22BB966685A6BF91154C61A98522CC01237AE921981FD83165FF5C710EA646002F9EE34E4A26B4A14EFFDDC36195FCEF83C216EAFD7515481B48933C0A36CE69131BF1F0DA687BA95D3CB5D52A1BE62FA046FC31A01287CB6FDAE73B2DEA45F3A18823EE32711C9D59E2D6B1106F948AF0FD1C24656F270E95BA0EE385A907C1243B7D94040479598D3D6EF2C4DEB3FE1D4BD0885BB73B6A6DF7940DA5BF93CA29D3B71CD5FC2B4054E296336B84318C93A85E8EC50A2A0ED35D2A23F15F3C52D08B0832718BC1C82A984E5C763ABCA08959F76E2C76249EF8888EDF52C501F05CE47AB4835FDDBFBD29124F27AD4C5038428AB6F972F5BCBDC60DF3B78246330CEC3EC72D81526E44DCEF5A8B252BD8AE76AF223F019676346FF066837DC07035B821566EF75AF63D084BBC49E43B166E1D5C6F8E57DCB9EFCAFA5CF7C0CBC9AFF53EF87C36089D3A728AAEE85CCE2926CFF1D83B77877FFD4DB6B31DB873122C1718F6750C526D35F1B4FD9F18E97BC23E4866C92671F9B97BD4719FA9F02F783252296DE0F2E6C034A871FDE0D98CA0961DCECBF97B60AA002B980BBF38AD2895192638952B28578699E9A3BF063DF063256C68240B474F717C491E890C383538"
            )
        )
        verticalLayers[2] = LedgerProofNode(
            "V".toCharArray(),
            Utility.hexToBytes("66DE1FAD343704D4B3EFFFC83E067AA028346983C95D062D5C998421D8721BF4BA95587E5027CF3EB74830A1918D8A510A83C1979835F047864EB9307468045CB06A256DCACCE4B3731A1C4BE4C4114917230B1CA3B940365A133555270BFE7BAFBD6788822C2A7F4CB92A196E5E4FF283E07FCC5C4F6E02DEF210D40D0B904C5BD9238425E44A7BD2C6305DCEC1151453801DDA2009FE61C80AD741B9B7BE4329C4D9C7F48139CC621CA27244C6E699AD5F287C43D739042AF7531A62326E41C1AE3C2D6E38267F5F4F33E218B121F34E70C4A72DF6D173717F86902ACEAB10CF986151285B13007FF2874C47CEE738293C78CC18CF515D8509684FAB7669331BF82D22FF923BA43970A311AEEC4A08547B4470B27CA315714DA25EB5142C759EE587B7B72CAD8C46D24D47BF45238BFF6827845BCE3A5D29BBE52ADF65428F73DB1FE6190428C345D442EFA3BECCE630262FCF2E316C67C90E1E22BD3826C4"),
            Utility.hexToBytes(
                "86030A07CA801A8503EF564628235494B938E97E4887A9C4E90464387BDACDFD3640969A80573575622156C8F84D4D2F33E5D08A281B7E391C4A7A6B3A3FB6ADA3619D2460BFFB70C3F1C4D54560BB5D20BEEC0A18990CEA682B6428316AB51A43C1AE42E08BE852AD91EB3D03D37216028C0C3579CB3C4412F24FE471949AA4693F7F701ABF857ED07E98DEAC776B08E69E4085043D30C9972A201590312765EE7176322828FF87F97B4FB0EEC433A84E26611827D0510B50A0F11B76A7C74C277794D2E9C34C13DA35CC172FDD895A66B0A30EC38E5DEB1847DB63B66E85A40D672EDE00AAC7FF914CCD838F7E5CC890B8B711E7A02D3CAE83794510D3576F7C3113DEADE193464A9735DD841B39CB9F1473C2882D5878AA0FFEFD9DC4E9BBB9F40CD453D6149EF872B5E8F3890EF2612C38B315960BAE85BC1A7AEF451ECBE188EC5D86BBB2A1BBD2FD0FB33B39BA47A4E4390CDB6BC5C4E9AEBA03FF505AD0CEB390FB5B2356996C207E4C73E7D57D67A486C3092A2C5B380BF8B39465E1EB308E03F2D289D343297600B687380FD3C47A82D3BA4AC643BDF54C73526987DBCADBC80B3118B35A75326C861335207B78D50D314ADF3CDC8432D3682755D6B2E5F6A3DB80FE7293568DCE1D1025E4F414ED5CAEE1BB0DCDBF3EF7C50E6E43CCDE51285F69100FAA89A784CF5577533490C96186DFE865F9BA2CF6A1AA8657E2854B5A3F8F943C5705C104993B36549EA3F7F3FE44464F983D6E9860CE526AAE7BB18E2DED837537145D56F9FD51F3E2E577DEBCCCC5F9CFED1760804669A023EE7066654A7FE42EA24F2EA82FBFC096878364536FA014B9CC79EB608117697273D7DD487D6D7A2A3E401905A62138296385A56CED8F6B283C5C8D25E3AE16435F58DB5ECBEA3CB5D7F75470955512EE8A9E6AFD7E228A356369925E6AA5A158F82C7C730DC1A69AAD071B2743BF6E39607DFDA0C8F6CA8B6741517C7A38BF6920D804F2A6BF64761608AB91DE7AAAEB504A937F974C643AED4287DA05B240718156F6E4536BA212BD1A95322557FCADA88914CABDEC3AA00CB835CC764E881171AB5C25E6AD6ECCDF051526CFC4D3C79098E2C0ABC9B417D8FE1870641A38EE71ABFEE7CE26D7C6EBAD4031E55BB087AB6AD517A6A14C772E33BA3CFB7BEE885443DE6CE42511AA1D90412718F0DB0A01026D593B582488835503254D1A2E63AD2E9C30C9A16F3291DB7DD0C9CA8B15101C4C74514A43478AE498DBEEF20DCBD810A683015DD33663FC50B481D92C6248D0DCFC2E9104DB4FF5AF83AF6E68AED9E2D3A6CE3DBFEDB0F7EDACE41DF7DC442B3456FA1EEE6EE09A6413FA87525F314B3544D97F2707751051C950A5462FEF739D68C68126BDAEECC87BDB602B8576B27CFD23D14202A321F4BC0C7A7325F6204869E5C3E86473C750C74085D771C4E457F0B2762CD20BFBC54BFA5F2C18C420CAA4B4E972222A834DA464EC3BA6ACDB4CF05F00E4468F5D6E721F8A78BDFE7B9516593EF03FA79CF24A65DD4E666ADA7E271BB844300CBC8748C444228F0B93C7573E2519DB1CCDFC0E1F076BB5FFC02EDD894A9063335513F40914A24B05BA79FA174DD78918C18385A499C2DD7D685B99C019D3D26F3DD5E3B49384A6BAE4747E469FAA59AF023916B243E9434F812C0EEA4714D2A6CB96EC3CB1CA5E4D4436CCFE55A18EF6FCD21674BA6C3D8D565B1FE692913DE97DA1DDE31CB044CFB166C7C3939E2191E776C24A1E9D38D2783ECD7B365D353F0F0FC2B8923EE356FF88EA805BE23276AE11972FA9F839F7898BDFBEB863286B0634EAF89D8FC6AD37A8C9D72839C7A2669EE80805FBF0790F9831DA59F1A1C397127F5FC78B7180817D58897B98AFBCA76E7861514EFD0F732952A42A94714EEDDC468D8A3D5709CEB23530F6BA1A9A474E913B4405124FC60DFB66ECCC2BBD5A2259BE4AEF77BA43C29B0B3F037BC8A0B9CD92B2D8A010A9D3453BAC26E0AAB0C63EB6DC260B772EB0E1E900C8B81FE00F94B80978AFFB0ED60C283ADD36582A0FB73492AD95B1C4CF4F578E851BAFEAF3296D4ACB"
            )
        )
        val horizontalLayers = arrayOfNulls<LedgerProofNode>(7)
        horizontalLayers[0] = LedgerProofNode(
            "HWm3vMLnVLWxqBLoWCSq4ADEVbn".toCharArray(),
            LedgerValue(8996272, 0, 0)
        )
        horizontalLayers[1] = LedgerProofNode(
            "K926PecjJVj7aATVuQDziu8tieJ".toCharArray(),
            LedgerValue(2092327, 0, 0)
        )
        horizontalLayers[2] = LedgerProofNode(
            "PmhnCXNBKLnT3hXARM35SVGkmwX".toCharArray(),
            LedgerValue(4639705, 0, 0)
        )
        horizontalLayers[3] = LedgerProofNode(
            "Z".toCharArray(),
            Utility.hexToBytes("4CA1F7DD31864B8616FA0149CAB9B1F8180A034EF8B24A7A6683A219BB41F4BFA2E63B758D98FC76784D419624F1D7F65622B69F8BB3DE8AF5BEFD0F01EA36F35347525FB77F27BFAC731B81A22CF253F5934ECDF921EEAC3F5E829703BB51E5"),
            Utility.hexToBytes("")
        )
        horizontalLayers[4] = LedgerProofNode(
            "cmpKF9M3xktCW31Gm8YzTzGWawz".toCharArray(),
            LedgerValue(3601286, 0, 0)
        )
        horizontalLayers[5] = LedgerProofNode(
            "rTiUAGc2y3cSaPMkEUFoTj4FfLw".toCharArray(),
            LedgerValue(787118, 0, 0)
        )
        horizontalLayers[6] = LedgerProofNode(
            "sFC16YCaPi65bApGr2EE26SWqYp".toCharArray(),
            LedgerValue(5066100, 0, 0)
        )
        val address = "VCBWG6EwQJh9vTYoVgvPH6sdgHoLDC"
        val proofOfNonexistence = LedgerProofOfNonexistence(verticalLayers, address, horizontalLayers)
        proofOfNonexistence.ledgerHash.toList() shouldContainExactly Utility.hexToBytes("EECD6CDCFAA005F79497540BC3C1B81445814DA9F3CC4A49").toList()
        address shouldBe proofOfNonexistence.address
    }

    @Test
    fun type2NonexistenceProof_4() {
        // This proof proves that the address VG1xgSTgMZ5qRA9WF9mBxCjE29vxAb does not exist in the RHT identified by
        // 806013B302BE45009DC09223AE252A66B917E0F7648B2D1A by proving that after routing V, G, 1, x through the tree,
        // the only children of the path VG1x start with '6', 'U', or 'a', not the 'g' needed to  continue routing
        // this address.
        // This proof is pulled from a tree with 100000 addresses in it.
        val verticalLayers = arrayOfNulls<LedgerProofNode>(4)
        verticalLayers[0] = LedgerProofNode(
            "x".toCharArray(),
            Utility.hexToBytes(""),
            Utility.hexToBytes("")
        )
        verticalLayers[1] = LedgerProofNode(
            "1".toCharArray(),
            Utility.hexToBytes(
                "A1BAC73D31B48FEBDAA314AC7708990ED4E2CDB1C55BE335315E856C6A8B23D7883235A26E74A9DEE8AD5DCFE98050D01E48A3DC662015F3129B5372212A25C32DBF1F759EAB64EF041436EFB493366BCA2D7902B8D469EF174796B427C1A49CC62E12006C290B3A2CE640E134AD345C1C600864B13C6C600E0B652B586329BC0FA54BF57A58515A719D5A4BB5A1CECF92399394DCDF1FFA8E6B23DD4EDA51FC4F55F1AE8913C00EBD2666213A1440B6DE6A38A190652516DB68DBA120C928D7B4A03ADC81A21DDB70F00058BDA05808997F6AEEE5E268DE9D722A927FC9A6092284541C28DF0CDF3622610483E3C9D8499D23C24A2A54CAB1EF038072A5DDBDEB0573E833348EB46C278042080724A1ABD458BFA711E6C31BA2CD84DCBEBDED4EB229DDE061CF4429DD563EE73F072A2859B7BF92E861FC598E5ADA660E5A42C10E7D5F14BE47ECDA1970FCB0A4B4F251FDEB4C7C6C2B61176AF1D63D501E3DF16D15F572AF9A7001297672D5C8BD4395C8FF21577A4B34ADBA473199CCFBCB81DAD2B2D12A7E3041E3EDE95C73885DF980E9F47E1C4D4F6B0650BB1A22031408C6A6171AF2C8FEF34D231547E5074977741B635EBC2DAD907CB1D3A65488A47A716A2C8F29EED74F820C0EBFE018452D6D8F4DBB6BC28391D109ED4A888A918AB4D34DD8B8B0ED87542F7EF5203B84224E6EFAECFB3D65BB85194CC283817E3BA3650E8E43EE3C1E9420CEA9F7F8BF0E1C04BDA1F20F94F61B7A6A86AC48BE405899CD6BB3E9954054A4E56E4C7742DF1D0E5055A3E3266111BCD9F9512CDE722FA087856FDAE028D153C6756B1984020D644A0D510969653829DF47EC1E3B0CC4738B1D1EA7428A09302057EBA94369CAC2B6243901D894348D28774FDA50D979DB304392A203F2453CEA435607FA7914CF16FDCA3B1589F350F8266E668285CA8327F63D9146100CB6DD5CDB17C9156EB17FDC191FCDE8996921586B0AAC25040856959E0F65841190475F62C0B3E0F047449C3807CAB90FCDCC510D19986F14AE822755E4755C8BF770BEFE08B41DD990FDD214602AC0BDFCFCF3FABFC47EC6A6F52E8FD1FE0D20D8381C0CE599BB5769C3AD2D7DF43E820B51445A94FD105FD05736E8FA291C7D39175B1F4A481577F15F7BB6469ED24B8F37158142E5AF57D5EAE8EB863DA3F6BFDD7B1EB956197F7F95872CFAAAE50A54953DD3EECBA09303837860F38A2D72CCC9C62EE050C1CF3FB38402E5663DC4DA91F93DD997031022A2E664DB160E0EB7531F9ACC1915E3AAB25973005F64E9780090AE7138A3E2A808BCE52A0851B7405EFA58EC6CCA77142F3429AE256891224616174C954A1A5601BAC9E50B7CB1437BBDA84CA4A1938517F34841335BDCDA7E029F836B97B8B173817896A25F908F33C4248A01324F54E690269231B981E2E2D4789DBC8F6DB4FAAB3BFDF2F8885F8F824F818F152643F8934FCABB204982C1B65D530CF1380DCB300F7CB2FC918BC77C163F18A586D64EB173DD4EC2D06272D772B14572B3F8A66433007CC4A3D4A75C1B8A7D8D0DA054A0B2DDF3DD3EAEA9859464AE0FC94309C4E13FDABE3A9C3D6D91A38BCD9145A16A0FCCEB3EBD5BD5F58CBA74C983F1328DF48CC56A80933097BB2F8DBDDF6911CC214E270DCF9C78526519584573BB608B5F90D31DF8C8FC05B4CBCB9EB40AA2638DBFBF1383E64E4AD23B7D6D0FC3509BF43AEC2F99D223B579FB0C9CA2988BE0F9BEAFD8347298F01BDC95F7D79130AF95BA11978BA39FEB6992D009644980ADD81F9E056ED13CD5464735F9CE44D9BC31424069E013BEEED6AF4FAF1AF5FA7B4A56F579B85E9660AF4E6821891F2BE5E7659578CF18BF46E941E7F0FAD4B8F9A21B2CFEA03695B09DCAC8A5D05AE8C313941279B894C34E90CECD847C43075CB3A779A6ABA9410C4D4D0903D81016C5F5BDB0E16AAC386DEA741CBBAA7E244786A4F2A6420B2C173BC25A3F7AB3ED76312FDAE23F72618102360D7943F360C494F426CC370B12F91684AB7BE449D4D77C0D5B69CBEBA044613611DCC3165336BEF38C4C6BC7AF8C60C334"
            ),
            Utility.hexToBytes("9F4221499B66D9C85013706BB29D0DA49B0F795BC1E26B6395038D705720BB6EA13CF3FB6A30D3385AB8CED72840C9E08499EB2CBB014E30EFF582DBEA222252")
        )
        verticalLayers[2] = LedgerProofNode(
            "G".toCharArray(),
            Utility.hexToBytes(""),
            Utility.hexToBytes(
                "DB4825F213E76A4EB69EC90D42A0D979AE4B36D38A0AA0A192A8F897F78D99EFC68508E4FD7F03114994FAEEFCCAA2215D9AE77E294712338581FC82A2309D447CC75ACD6F0303EEA9C6667DA20DA1AE5658757EC16D37EC650CE030D25A427BCFF5F5E831344EF9251F2E2BBDE1B7D6F8332B9EA4022B27FDB394424176DDBEB44C498FB187AA1EFD7A5050C673FBB5E41C3AEDD3D58645F659882646266E46D061955BF69C610E14C8D293FAFE27BA3A27D5E7D9AE7ABB6AD57638C3664B5894CF3A5A35E0F3F2EE529169053EE015CD110371A4B71F0DB2F583A92267A6B417608A6301F96DA9ACE23A8C9CD74EC822C6C1610522B794E0B8A5861380907CABB5A73555A65943AD968E7476A0370DAD04FE9AB778E3002A2A2DA5B91C457A8A8BFCE3EB112CB9E62C6117B04368711EF401D4D73DC5725FA7373B255ABC0541FA8AC56DE0F082FBD072957FA4699B7110FA66746D47B048CB07E25C87B0A21CF5BAABF704580AC3D28AF3903D25E051183349B19A4F469B2884DA03D2F2A53D61D77381C6A769B703F9D4AA6C6B179F1F7F1BE5C767594B7E5DA15C12E86605EE411FD86E0239639F15DE7B745B7D0C6404A2AC78B6B5A3C4EDAD1D93B40804113369A893529B639226147AC4ADA816A495BF0CB81DAA84CCA8D4DC1114142CDF5B4EC2FE09067D34C79D934F62A6818F54498390590CB5F3FAB8581152EE0C02A0A08CD760A3029B1A1E32945701D7B15ECBF245A2D50139552CE818C5AFD2B08856D3FE0647C0648053876B0BBCB8E4017A10823C61D02FAFBB5A4D128A5D88137AA447592DA94860C70BC3CF1C802A3E1AD036C87A60D465C3A9F1CC85C36A7B52F8C91551217EE5B7052DBE70827FD869F0A746B82F194944F4B02E34E1A9FD960BE3716FE71F04062DBA054423129C64C04D3F190FE6A5ED80B3BA6CA167052BF4A1568DEEDD13636365CD4976514A97C5F928A82DCE479BF918CCE6478BE4CF82A6445C946DD4892CF1460E9497E3FEFBC64695B132EAC4ACDED844948A36587AF57549EA6E12B5DB8A2A5F934FA9A8AC1211172C968035FAA4B3BE46789B9B664FA5745B4CFE8E2FAA5FF8DFC75B03EAA5698E7876A6EA96337CE48696F8B7B56AD9E4F9CC7FD76D9826A621DBE79F0D45F45076F3AC2FB1217999CAD051EDAA6FD676E595A2C39CD11FC475307CB69314A3529B1E67080D4A39508D97B4D57AF1B81C38E810622BDCE7ECA2468016A5A40E29FA46FBED910F9FE8DC669970392FF4F0E79D68686898808C3A4AC90DC40DD5F39FFE8F133D24B421676C4551FC844A8C7B292947ED56F30337C65FC06DE08CF05EAE177EF957C9465DD8A9B76814A0B5C1D7309CE8AA81BD54FD9BE2D00A866D061351F62F6090B650A819D929892853A985EB64041B0ABAC7444000614C2759884AC8F7C9DCF30834C40A531AC58A1F75525B6D48D430B9218052F75CE41EBA28A938C7BA6A490C264F4C5F25DC1B5CCB89471FC52C5F576B4368A967A1DE0E215676E195EE95C615AEF9F5C4E5EDD3228D1C0ADA84719CE595D5D5DDB989E086DD4C52ED8E7EFE5AA4A7387F861A75D1B46505E8697615A19BBEBD327B4FFDD9EA77BB3A65D68D77BE4402A4F3EB6D9B23FEF47E59E387A88D622F25EFDC8BE2082383613DE12EFE6716A184C2B29B4751243F1345396222377AC45D56BBBE5AADBB637EE454693667C1E9372B4B514E6D218FB4F753E6BD129B8116D72963D6375B4BC5DDB20689422BE1610E1283A88EF3439710FCBF49076990F2C73544D95725515A886992DAB9E0BC6AB1CCF1C1C2F786D4D07B4CF0FFB72E353B79C3B99C65E5D360277A61D4152D95357B7078E8A7497A9D6DC3915DD6BE542D6C3A99408647220B42B6AECBF91EBFC195316F2D64E566C374EB221BF0FFEC3DFDC4947B2BA19DECEE16ED40782DB4D4405C9BBA9A6219DEBC546553A4F6F956CC7A0F8F2948474C415B02A141DDFE6CC825D7027132B01CAEFF4E0B6E651720EB9DBA56BF1E52A6FCBFA03721D771653901B881CD3EB89AC9FD95914AF5AA83881E10C7006426DC4BFEAB728EFA3247F05E1229D3659379AE4617F268C7965EF8749AE53ED5EAB7A9A44F829E34F56A3404700124D7EA516B692A0BFB61F7A5CA37B0AB7BE833BB4BB8D6C0205ADE82A9DF0B064659812095C8264D453FAC7AD90DB7A18B065B9B1FA2FAC14D895BA932E3427F4D1C7CC799C5A3F533E124A618D563F2F254150A5BB10D171BEE0698797F4CEC3AD9A3E6C4DC31EAE918558C6106151047451816D0B9151D5EB7AE98B96599977DD881FBFEFA2DA3EBF658F1D3A0DC5FD3613AF65AACBD556F5CD48E0841E3E3DB5A63ECF037490F4BC7861E77C751CE86E2A57DC41DDAF02F93492039744971E42C5D3C21586E951B18B5FC54B1B07B0DE01A1F29B25DFD4AE3A252FB1FF88BBD083EEE0A7908F791EB03B8669384E396E81CD50283FF5EB8F1C07423B4E329EA70FBE78AF11554A6B59949033A170FCCF94C247D9F21C4D7A22DFAD8D8C3D0819C1CABA107B724F4606F3EBAC076D1EE4C8D507121"
            )
        )
        verticalLayers[3] = LedgerProofNode(
            "V".toCharArray(),
            Utility.hexToBytes("18A480E67D28718FD25B5C8835EEC67A839109D67EDAFB7ABA68C59543958E95D9B675B3891BAE33F745E9850ED63AEDD7D0AC2A734425E71A20B57D2863BEB8EDAFB723BE2A802AF3303A52D8FEEE9295C1F54389AEDCA98CB128FAC9BB5EA1CF2777F3D2B76AA30D878F194840CB9558FF5AB3056C45F467BBB3580943F7AE2E0CE4AF262373D40C35DD18E7B9BD74B70F8333A9BD4D298AE6AA9C566F27F56533016F4F3E73779D4B9C1D3FDA3247D76347E93730060794B34A5A838B605B4C39A189ACA2EB5ACBEB01B986FB48D181E38861800737C260BA51BD70A220A1CE212CEA7DD2F0894530A923EB63709880E21E965AAF91B85D7F2FC74C75737D28DCC98B1A9A386BE5324B8B3F5D95C1DB676FAA9728CAA021F8516055FDA3725E70FAC9AD75D9A16D065187A6534C0301CEE3453B835B9A6300CE9345714CFAD6FDED82B80C2DA3E01CE1B71ED3CB783292C32F70B971D635E38974F4D7FE460250EE306CF109D7F43084529878B19CE2319BC4AD25F8ACDD18D253C1DC9709F81F5AFDA5202224876B5E7FA53B28ACAB9213B10128F2491239890337E2673FFEBCA3E47C1145025CC0F02366848D365C048C34A13034E98E877A1B0E3EAF8752EC91AB22118DA126567F21BC5FEC0EA8D2447EBB1E4253782F9279F66BD773"),
            Utility.hexToBytes(
                "A7515F86DA3CBCDF50865A21E26EB0C21D76A86FB31D523EA2965071BFE23E071F36EAE4DFD6F3A2532519637C5BB50F8BD4C837FBB5DB7B8229A2C482A1686B07C1A81174908E056E8FCFDF38467436B145B862FEEC363B12BD3BCE141BF8B9E5925A4B30AD8D32634FA9C87D18193AE5A79B6F39D2577DA200704240644E280CBD3B7C3893B2A06199CE438EAC494BCF728B470C941F070527B445B7FD0CFEB5AE6408FDA41CDB143DB0027479762D00334D89A28649555DFD16BCA3E42B71BFD44AE6671A26E55E315A90841B86019BA8C3DDF245F62657F756EEC4B47D9EAC7026973590961E56502DB75379792CF6E742D6E3CE4C647A16D1B776446C62CA191EBAFD44FF99434A2D42195AC5549C89C94162ED1CBB52BCE705317C80A7616BDD2D27C1D851A8E876DD4EDC1EF0197478257EB71D36694029ECB8D0BDD342914F46CC60018A9E69C2A46BECAD61F1559117C598640AC2856CF7B7FB27FD6D4EF43B00419EB0795ACA392CBDFA1DAAF8A9A3AEF2CE77D3B011D3C24A5B8C16802EFE031220208CCBE09E1E804A97C20DFA93C8B4C8A39A3134861EBD746433D96E1A72B9D445A8537ADD5D5CD6E900F8A1DD30F7AD923AF6EE19BF2722CB654C0B0DB45B5BE511B3A581449F48029DE1D35D69339C2A399547CEA7B6E662A234AC73FCCA727264E692DD7CA91FD65C8926C7216D4DEF81BA56D844BE9D2FA075105D7FFA6A17B5928A1DF85EC4274F7568F175071AA937B43342BB9C9FD24A63B5DD40F345C2F6AE71EE46B6FE0223A78E9FAD980CA419F4C2A6F1AAAF1B31A1797E4C0C609230D175B42BE1FEE288E10D89A8A0E52A62A7028220E441A1A176C9BCB0493A165A05CA7FFD79DACE5BBCDD1D7DDFDD5EC7C275DF719757667C030FD91DB2411EAC608E5EAA4A365ACA60676DBD2E9B01E74596097FF5F3028B73614F9DAC4E392D70A66FBD30C2A29BA78FFDAE8B2EAFBA2B03D80F44ABF3D798A30E5A984AA774E020456C573B2561DCC121C773CFF0ACE5A9890FCC5C2492802128EA89ECAE0CEE61C99D859A1C2FDD9F511C82027C79BF12AE29D03E025906CA4B8E45D2258B49EBE3508383DE60FB6348B14347E0E13F9455D743EE1F7E1107B2B47BC016753A678723341EE596E66346CF2B1555BA7148E10598E400DB1A887E3104833449AD5A599CF6BC611B1301111995DE845A0B63F1F5F5CD28D37A90C27A71A67B27F4B049BE45BBA164AD7767ED0753AA98741FC3E40974D515510ADAE85CE2A3A0F122754F331EB3DDC885B4A420C270AE0E3C63D361A9529EAC4E1CD950CACC4E8E0A63EB4679C9D3BDDCD74DCE852DD5226F26E015A19EA8FB4E54C654B583A3FB093B2B2020CED4F20217C3DA2D0EE8787097B21B89AC26352E0AD9494A16D230C5EF7F082057A747C9BE6279B615AC517454948138D5151FE89D5373E8123470AB1D68AADCEFB885F4AADF9DF53E03E4F5FF3594D5969DE6CD7A7F70E43240A81FF128B003A6D46433FB0CE74BFE22AC6FDB33406EC4D5DEE6953F29402D076757A021E6EABC83AE73CA5B03444235B7B7BBFCE35152D49DDE9DC0FDA5FFD48DA113C6683415E96ED0705A25B51720F13682223091AFEA2CFC00B495A595A5C167C965C7C1D0BA16AC2F22EB6D6AEC1D1E6EBB5BF234C48402E5D0D5E2020CBDFE0185FDC661ACB1A9DF38320D52B26135C06248EB6B930AA5B34745CD9D27111DFD153E6531585F632C2048863D58E3C87BC736F002B21C2124776F8410B5236FFACE73453E423C0C5B00336C875E444FEA2A4B706731D0E1B3FF7975E2AAF3988ED2D6A1BE32D6F2BBC2ED9C07F31CA57D15B9666FE06C69AD67C190D363A640B813086C0A7796C25008B269A1B3530D4B2143F5A1"
            )
        )
        val horizontalLayers = arrayOfNulls<LedgerProofNode>(3)
        horizontalLayers[0] = LedgerProofNode(
            "6DeiKePgcnrTFcm8SXATc6mB3P".toCharArray(),
            LedgerValue(6704122, 0, 0)
        )
        horizontalLayers[1] = LedgerProofNode(
            "UWPMaPGwWGEToH9xMNBarEYJEn".toCharArray(),
            LedgerValue(6317792, 0, 0)
        )
        horizontalLayers[2] = LedgerProofNode(
            "aptjcSzENE9oEt3QpUjUiGuabC".toCharArray(),
            LedgerValue(9705631, 0, 0)
        )
        val address = "VG1xgSTgMZ5qRA9WF9mBxCjE29vxAb"
        val proofOfNonexistence = LedgerProofOfNonexistence(verticalLayers, address, horizontalLayers)
        proofOfNonexistence.ledgerHash.toList() shouldContainExactly Utility.hexToBytes("806013B302BE45009DC09223AE252A66B917E0F7648B2D1A").toList()
        address shouldBe proofOfNonexistence.address
    }

    @Test
    fun type2NonexistenceProof_5() {
        // This proof proves that the address VHTm9UcZKadx8HuVswWQYyvk136m4Z does not exist in the RHT identified by
        // 912703605340B1AED1F430C38C8DBF9D2F1021F244CF9EAF by proving that after routing V, H, T, m through the tree,
        // the only children of the path VHTm start with '3', '4', '6', '8', 'A', 'M', 'V', 'Y', 'b', 'c', 'd', 'f',
        // 'h', 'j', m', 's', 'u', or 'y', not the '9' needed to  continue routing this address.
        // This proof is pulled from a tree with 1000000 addresses in it.
        val verticalLayers = arrayOfNulls<LedgerProofNode>(4)
        verticalLayers[0] = LedgerProofNode(
            "m".toCharArray(),
            Utility.hexToBytes(""),
            Utility.hexToBytes("")
        )
        verticalLayers[1] = LedgerProofNode(
            "T".toCharArray(),
            Utility.hexToBytes(
                "668D4746A566977E906837583757B59E1AF65B58C2C817D11EB8B5D8472710A70B98C5A5A237979A7553C9E65371C2AE2087A991ADBB7015049300B2218C4BDA324205236457A068173DC9AB9EBE4883CAF482AAF83C6EF52A777E8B5A89736580A00C7CC3F96A8A811A6B2F602A161221EAAEC256BFD3B3F776FE7EDAB9C4C22EAF04F6B4F80A7D50DDEB8DDB9BBD1D50BBE72BC084528E2677DDC4386052308A5F712282DE8F53E6D03CC7F9541271E55D90277A5F6F8B9E33EF3F3108DEF4A3F8D5FD20773D757710F8F2012B43BB1678146AA3D634A69D874C894184A73A6BA5862B53EAAE21B7C320006E04F85B3846D97ABD0EF7AC294A4B77A31EE9E51944DF567E8C5ECE0A6A400669C0E2B3EE5D29AA6576EFAA3B0CF14DCCBE4C7771D74EED943D6976B85E5AAC0233205AA9C76F0BD12B9CADBD9C87D43608AADB8FFDE4396A2EFAF402939F87692D8F7CB8AB8696DFFFCC6D0F4014BE8E09D02D4A70BAADB0592B88269F766E55D72A4655B53FC7BA3FE40DC300C9B2658E2847E62802D20B3B031B46517CEF89C81D45EB8F0FF844AD60A9187461100F002AC9CCFAD38BF64B0566000F26172FA125F062815543B7561C48F801B464CE1BA5AA4EACFC8228BBC0D219FDBA70652259CB901B4F85BC53A914613D96FCA419C24DD7A29B38AC80CE351BA670F89ABD819B018EB9170ED9D4D38236D1BC55BE216F6D447093F3D849D51DCCD8FD0FB0CBE0A4631725BA649458D385B6758AFEBB08AA26A120801A9E8622CB17384C4F260E6A2F6E26C7CEB7EE3DA77E389E620F4767B2F66DF60B3A4E2D8391EA15E8AF3D88187FFEEB4A942AD344FC654B9E239DF1FC2FEAC3D5B6E4B3AFB74BA6878AF2EE13A93706B3A98C2D2DD140905DADEEC30716E9E22A2216E8E2EA333229BB92084445EB8B825BB6597CD92C42437687AD898FF2ED8B9E8EBF5E9EE81A38D5AB9C48F7D0AC6218DC93B8B336115C71A700F9B85A2B3EAF84D569DFEDB062DB2C9CAC06F2A0742B06BAEDE7747620F4A583BA953B343F39DA312AB47D389B1673D6083E6957D8791AE387A6CECF8D1191F0E706CCE9456BB9BC38816DEDD8AB2B446AA887C4CFD56B9E1EF7B5A839DAF9B8B48817349FF933AEDF0CB6366836CC8F63F87C267C71028F7DAF4D9557CF7F6045166AD075FA3291DA435E21E64DCCD99F1859B58EF6678C443973861BAC6E8B5F1FB87696D75361D25DA32A72B190559D6D672A205932C804D31C37CCE08C55E8D0E36FDADAAA301175173F4419255B0D9D6B9D7033109B214DEFFE4F113009C0EE69B6BCD47B2675733CA69BF395829B87B735A79E512715BC30A157707FF9F9874DB6FD7E11FEDEBD52E1438F25079144A5FC58C2595A22072CE51E2F6F310374D95C669435138C5D76AEFB74EDD7317EEF8035ECD3CBDDCF14B803D9A5F1209F3A62C63403E615051F1F273311B38850909AF1E6B73897C0A11C6F5CAF11D7C09F58FA81681283045D35D4BCC11732039ABBE3DBD613280ED5E06C7DC004EDEF230C846B58CA8154924268B4511881197DC275520DC9824855E787E2FC1424F46928CAAE7194D5FC5CC4978DBC8880B8D5A931E6AA333780AF12B19B016380AAC946F375080C37788D716F88E7790EF22219CE2DE492AEE03A679E81A9153CD75C7DC1B0C78B6A455D8AA00B44AB612AD916FB88331C0B2DB21A140D5F7AEFC7521E526F0DDBEFFF4F8B40060BF23DC6290EADC1AA88A9B066172FF5E6C619B827833E2745236689265B1EDED1DE8C558BEB6A5779143BD07605E9E2D694471F51A47366BF1E0020CBEB26ACB5939E52A5F60E6950645653276F24D19CE235D42E8E93D23272962DD46C048A3FEBBFDA17DDB82E0C8AA36B1CA0BCD5C7D00C85DD0EA4F6F33E5E70A7ECBC9EDCCAA8102CC11E9847E1558373B9FA1983B0A554510B750C5427355B59E1D7E2C0DA1F1906B9E7B5C6CD1EC1A6FDCDDDDC"
            ),
            Utility.hexToBytes("F53071CA944FED681403F2C5E54FD48E2AC871923FEBA6366017DBBEC1E4970515731AC76AA564BDB19FE42EA4381C69F0DF6667EA965535C11A402567B29A3A6E1F14F0D70DD1F274B519B295151A70B0CA55221E8F14F1F88396194EFB8C773294835EE157C1938F4EB1775E07D0B07DFEC8B1798753C5FA757331F0EA49E518C7E119C8F591E0DF7925BA4C382E3FCF4D089D977BE28881750339BC643BC7A946C8CA8D9E29767E4E15E6147D6BA58E4EDD5022BCC94925C18B8E079FCC3CE307A2878AD96805DF36B6FA96A47218440FFBAE265CAE785A337CC153F057FA545087FFCFBB26B0CF862CF56502AF9A9CFECE2A178A7B9FD33A5B79F40BE339E29D787B6BA9AAC03B57151E7E4EACA40BBF0830116CDDC9EB010767BDF6457E4B9EF53B9823E61EDE1B787675E9F86A1666D536A6257888076D2389427394B7FFA3AA8119F85A03C8A28FCEB681CAB32422719CFF1556A5BC9DD30A308640E86549CA91789371A027DC62701A48030403ED2B63ECEB61745E85D0C7490410DCF30EEC52FDDB64CB7B33E256F4FF841090BDD2D8B0ACD7401B41E68291E07B93")
        )
        verticalLayers[2] = LedgerProofNode(
            "H".toCharArray(),
            Utility.hexToBytes(
                "1DA67FD6AEFB7C15D131ED3BF85F6C2521D3C37DFF4F4A4C83673F8AF247EC4B96DF780EE557C44C44886E3A4063691F4F22B3C8996944A9F6B89C35F88F3B6E25DF188439A16DEB2940A61C1B905EB6BD50BCFB24BE49788C83D8BB93F18F02D935F062072F32BEC39CE0FD68B2D1A00500D80E31E083330C8ED669B5D7EC9BFE48A648EE27D013233A665C876A123199808C525E42AB4C306D98CADDB9581E6F1B80CB1D32F16574847782D2947C178A8340E60F41327EE71DB68EBCB1B688FC9043107CB2D0F1736F954B15342BCC04C30CF1F880398A3725FF1A80CCB72BBC15F494ED123A54AECB12A120C13F172982DCD7EDE1D8619DA3E3BD713C87A122985DA58E655F3B6BB262D3A17630CF03DA6D1E9A48BC91062E579CA6608841ABD66538A2B7A07EB762C0F8A7F755A85AD38C2195E71BB29C6A0E153A61083137A918A71BC08EDA6660B0E6CDC525C52E5EE35395ABF51DED558D4A7FE300601A136037EFC53BE241680ECB06470C87D83E7EFA150CB2AB37AF3330101D22621A8EDC8DDA6F24343F824FD248DC4762F43EE6A8DB54B3B4DB669454A26BF28CDC5DE689FAB533D10C64D5E69B8EA02BE07726254A6AEB8B787F525532BB8237617BA5C635DF7A3F51C6900625CFF35C3D4F7E888870CCE1799054B50A5187910F67C2B1F89BED7DA6FE3C929AB9760EBFFAF8ED6D820F2C8711319CD63E206612E6386197FE391DFC2D5B6E3FB13FDF7278F27A5EFD5F8931BE2962F8181FDF96B8B142388F2658D9CB0DFB735DAB8CD5323AC5083EC6E0381DD2417408848412F5489AB615648CA1BDEA7C04729766573B92200023C0BA5611275E3FD1B6A4C6ED21E69E9D02D553391C2105EE674DF3D2192A4DF368901E0522A31B90DCE147DF03F30BD50EE6352B60C2EA94957522F4AD2F48AEB6D97DFBC9EF60CD251BE2BF6138407287C7AB134C4CF4AFD08B061EC8A3CAD71AAAD08534FD032BE09B8A36B083E0E279DB781107F8BC032B1E9398FFBB52C8D98D5F235DEE22D27A6A0B715F413A1845A03E8157F0B6C1C682708D975DA9CA958C61930F07756163DAC0872A0A6229872EAB8F85E3EF8920CE14950FAA751D2E13674E4A4CA05BEAB3A4B2760E616DA64B2E14CB5B6602DB1E4FD3DF987DD6C380CFC0566F7BCF1EE6"
            ),
            Utility.hexToBytes(
                "867CA64E7958154291BEDC9F10EE396A7406E07FF46EC3B668723C89224C78ECBAD3B45B66DFF2321900DE9DFA4E96209DB7C0B213F43C1DA9536BF448E0BC828F6884D505203C4771E3954ACBB7BFA5F374C26DA9988B446752D924CD838D173BFCBFA42FB20D8DEBD58C1A03F26F6A39305A8D7EB3A0BDC09C7AA9ABBC3B547C564A82BBCFEA45AA18F2637E24385B189112F27678B161BC18AF2C29FBC7C0E24D13C63F85DA5AA48F9A2BC245A577888A5AE1E0FBEE77308C63FD34634ABE17C313A1EA34C152D5445AA133411BEE88B23E085E165875FF1A8C01BC25E055DFA7ECC4FEC94D3D32BF214AB2E2BC85300F0F35633EA005C1F4F5F81E37778236537B28BBAB8C66559AE1A3ECD1648F41EB0A1F05B542600F24982D94FF411B6D9E1C85EAE6B48C1F5B9139BF637BF0C394AF423CF6CDA89C82381B4E5C7DB6446E459E55130D6249C33D386479F877694588B469C2D5596F4F26AC30012947EE533761BB934D536CA05707B6076DFC09B800C08FA9F004B238578A4F2B144BCE731E23A75D8E4123CB68E6DC3F73044327438745C6773771EECF88226EFE5E3ABECDF18B562067C245F0132C037A859FEC63A0FD9B2A2CDE1DD81CEDB6EE867F4BBA62D003EA793E932BB1E8D6DBE484E5CC5D8F729CCE85BAD528E39BC5FBBD4ED80E8A908AAC0ADBF0B85CF4FE5D31155B748433B914604AC811F37E0D98B1724B7F29276EA88B1C5FC7BFBD3189E9D92E7BFAA8E1CC68A56487CA608598CFCDB7F4B1259EDB93B175EB775E75DD233F7BCBD6E653828297F37988FA588A6D336EFBB49A8C0FF203C37323314FDE4826AD4CA8A0EBBCBC9951D84D929655D829213C893519DA5961959FC64AC373389579122747420208940FC910E5C702141D3DDE0D368BB2454BFC0FCD05E9085DE365984BADFAE6A5CB6B569AA64CECD761B8655B12C150343CE9E3E471509341805C20C57B91EE513BBE5CB0BE7E02160E86FAB6DC013B39D1A383CEE71859B48C1C5E07DB336A7C8EC886F7D1E24D5A469C17E4507B32E0781BDD1F646F3898340184AA3CBE4768287CA1807D0C6E68E4E43E4CA6FF59F25A05FEC07AF5A8D93BB2CA11F1FFC716B7CC44522C28F7717DDDD8A1F155E37BF19E71BB7C732A78FBD8622290C664A1FFFEE762B0603866825BB6FAFA672CD9509D416853208C5563AEC2313898A5394028BFDFDAE2EEC7C18F32C5DDB25EB577471578B8A3533D26105DB09E0DCF49087509919C771C4ED5067267801913620E388F6D64296003BEBC08DB8ADACE11326B6A155117F966829B5AAFE947739997D02FF233D653C780A5D33CB3734B80E51C1F3EF4154ADFEA234220614E7465C91E0D3F36F0CF7F5E717185CFFE426C499685726CEF22"
            )
        )
        verticalLayers[3] = LedgerProofNode(
            "V".toCharArray(),
            Utility.hexToBytes(
                "767083A9B847CB3994D674D0C6EA95C5574F55C6A1CAB6EA506CE9BF19EF71E55971F601E2A468D2708102B45355BB3D0B5B12EABF64958CF41E0432C844E615D8963CC16D6ECC584C2C858F17E78608898E00D4D9D23049232EF3899C879C6E3FC80E2CF536B9B54BF98040697022E72BA2432981C2F6F0DB4A96B24316D179C0CBA514942B848DD5B2360CD90821DE355DF584B8FC39C9CDCE20A3184A8B9E1371696C1404AB63D20C852166B9F0AC38EA4A0EED4834D6FBBF24525CB0209DB332FA6220BC3CC18252779C2A382A75B4EECA209A8502040AC8D2A06FF81437CF4DDDA97355C2D164B0B13EDD8A2299F72E14B0C3AD11BB3760ED6FACFD47B874CD51C6C21EAE527EBD70871D16F654C8A7D5230630B508B30C87C34C8E57FBC6940AFEDDD4E7C73A74A172C1CA3BDB9857E48BAA5A0EE3BAC392D40C44584D4F0311B691DB23D370B415EB78CE0F1B71DB327217F258E0D53D686C8D30EFA2197C3052C6373E5DEF5FBCF8BE684309CB6376981AAB74F68A4B2CF7F340285D2D8BF5AD37337F77C7ED24CC51F351E155454081203A9B3936D6C93EC91AE316FCBFF55BEA0A3A009979A8D214326F7C079AA4C96C389B24FAF4418C7E6A6F97EAB11963005151DF21C02CB9397053612D0EF816C2F26CF32850941A10CE2B4EE93F6C3C581EDFC99237A285718D5573C8A40C4BA1AB02EFE6951ABD8F25BCB5"
            ),
            Utility.hexToBytes(
                "ECD484208BAA744689E12600C6EF863881B740DE259D82CD86765BDBC97CDCC7388B22810C460B7AE486DFCD5E7B6805F7DE036FF2F56295E9653FE2BA7FFEE9855D6FB3F0CBABEF7A1F4C2A52001F47E7DC0602E622A632F8F5820256BFCDD20E739F144C4AC07E6F1B4D42309A11E445F97870F1A22B8E2CA332C93E40295278227970977E5E7088D1D1B5705B5F2844A26ABF9A506D6045E42668613C7976775714D6CDB79C32C975B7A160722E642A25848911DBC8450256E63C15B3061DD39509FDC865EE6DE1D46A6EFDA4CFCA515D407F6FBD918FB746582D5B54E947BA27E1D5CF9032DC3150C08E44DDA2A6366A9A449FCCDF0E4E91B0A81C666CF10AE33B23EC2E36CA2B421B605AA63AECE683E8CD08EA58ABDED3308B55143FEA2F18050581BB01843F5290FE8E7466892950E9F8084A25BA9AB4C5F463E442B6DCCFF76CA36783484AB9EBDF388F4330B70E1D496D080447673FB484C042A93A404215991649657FB944D094AB6F0F579DEE9C78B56A89EB611668BAD076882C64A2E094E7DD4549DC0504AD15A7F4F7F011C8ED88916B0D3CE96DDF0F14E996D4E115B5A6001EF1B96B1FBBFEB212BD054CB2EFAD080AA261F9E7D3B4F780DF80F4CD9385795510C8FFDAA04B81FC8A6D63843E850CBEA035FC55CF206B3C3CE0840C9EF06F5B8112D3FB7A61581F6CE0DDF5D4F5FD37C93C33A8EF0D1C498F1238680FAABC0642B926AEC9FCA020F6A9EBFB11FED686F91E8C5BA767FF322122B727E981A63C284E8C0916CB5E6B264E15D6955B7B3B205DA42B1D3B720F20B5DF54E352CBF858985A4B95F3CE2F64014E50B9AB903BB4D665AB9826FCE0BFF7FFF3D19555733637135124ABCF178F5A671E43DF4ADAFABFA11578B82A7428683D24B51A98ECBF20A35DF5D6C796D8E305F0B6CEF988660A12AB0A8532FA76AD4C284CE7636375DD68B696031776389A520E81E8C0193A29CA5A2D4E4D0DD8C72999DF5E166412B0D363718C9260D29D276E56C8BC95914735C4F5C70E97657DDBAEDA13EBDE6D8D0FC51470C3F337B7218CC490F661BB7B47CFAC9C4587706CB1A711E389FACD5013EA7B7315AABB897F661C2195BF2630A6840007A8CE4C82231337F1909DB45BBB2F7950DC8640A7535FBD3176F9B15314269885881BDE8CC0506D274035EFEBAD6706D78A32B3F40374B80B1772A3C7CC404B950602FE83D8D72911AB1556BBC0EB564CD762941CD303E71D2E6EE8C648B66F5337A58F577DE980BC76DF5A9522C5BC40D1446BA14046CBD2F5B0A7FCDCF19116276556FD8C3786B7100C90D615A817C7DF58988C6BFBD6D36250C2A26DB4B1DD72B1F2368B36409FCCD28A1EF18FC970EBE7C5C9B404D09FA3AEC7666AD012B07B29B7A6635CAE1609F5065DA963AE56B8FAC5DB4CDCF0526A9C7B49F4A7B4D5B8E6791912D91E5484CFEB4857FDBBFD4C7A19D0ECABE030E133F384B14BE2D2B2042590E0AC7BBB5F2937022317DDF6F0508206B586069EED18689B6ACCF75CBAEF3F19DFE0E69686FF4F14079A27CDD021CB741EA8E5C535094815762DF45E90D618F269BECA1E04E7C3F3D40344A801C4EE5EBC139EF15C4A1E04B4ECD3862CC241088416F58A925F4F3653C305111D6E0B6C18727860E3AC323A6DD5053D46076DC6EE6893B6ECECAA1A1F362DF6077930F3F5E9E9EBF6757A7C8B6911E746D51E27E4FF9D1D0A47F657A6C936212FEDD6009E46D9A0993345337B26AE42FA69B597E3A0849E116921842CC05C81BE62398DDCB6D71E05B54084D48E1D6E09E810F8D4D11A918822AFB7EF2C5EB22242964323F81F7CAE9040B93E506323096A9F"
            )
        )
        val horizontalLayers = arrayOfNulls<LedgerProofNode>(18)
        horizontalLayers[0] = LedgerProofNode(
            "3GtjpoLnyvHKtyCw4mceD218nt".toCharArray(),
            LedgerValue(7566289, 0, 0)
        )
        horizontalLayers[1] = LedgerProofNode(
            "4QWDgXQCtr2VaYq5JVv56DEP3q".toCharArray(),
            LedgerValue(4966085, 0, 0)
        )
        horizontalLayers[2] = LedgerProofNode(
            "6M1BAq83ZfVSUFG9wsAWyAb5VF".toCharArray(),
            LedgerValue(7592553, 0, 0)
        )
        horizontalLayers[3] = LedgerProofNode(
            "83hZfLUj7rVmdqPVGhV97DnYPZ".toCharArray(),
            LedgerValue(5517253, 0, 0)
        )
        horizontalLayers[4] = LedgerProofNode(
            "AhEJzdDKFtvNQrC6oQJiwHsZ1B".toCharArray(),
            LedgerValue(3966218, 0, 0)
        )
        horizontalLayers[5] = LedgerProofNode(
            "MoCDJu9ScXizMfjpqwG8fGhsQN".toCharArray(),
            LedgerValue(31849, 0, 0)
        )
        horizontalLayers[6] = LedgerProofNode(
            "VkfmPKwyUckhQ2H8Z2mGb9bZUz".toCharArray(),
            LedgerValue(2247579, 0, 0)
        )
        horizontalLayers[7] = LedgerProofNode(
            "YD6UwHGFQrb8KPGXBgNp6E82KB".toCharArray(),
            LedgerValue(2884031, 0, 0)
        )
        horizontalLayers[8] = LedgerProofNode(
            "bS1pjY8JAQSDSFWDozQHpCQruN".toCharArray(),
            LedgerValue(4668521, 0, 0)
        )
        horizontalLayers[9] = LedgerProofNode(
            "cZLVqxbH2Q16eS8ideKGNFEsVi".toCharArray(),
            LedgerValue(7670374, 0, 0)
        )
        horizontalLayers[10] = LedgerProofNode(
            "dAXnqbazJYWxxXqBZPxKBC5S2r".toCharArray(),
            LedgerValue(2653600, 0, 0)
        )
        horizontalLayers[11] = LedgerProofNode(
            "fKXq6BxMr3cNgmV6LLYrB4GmfJ".toCharArray(),
            LedgerValue(4111039, 0, 0)
        )
        horizontalLayers[12] = LedgerProofNode(
            "hdc3q16pRJEzRcmKTfB9LHhVSy".toCharArray(),
            LedgerValue(2361134, 0, 0)
        )
        horizontalLayers[13] = LedgerProofNode(
            "j4b9pX3EZZ5f6NQejg7jpBKPU9".toCharArray(),
            LedgerValue(2030196, 0, 0)
        )
        horizontalLayers[14] = LedgerProofNode(
            "mr77GQo6p96SXby1vE2gtB4Xvd".toCharArray(),
            LedgerValue(2955867, 0, 0)
        )
        horizontalLayers[15] = LedgerProofNode(
            "se9AkHqFvVvECkmFsvhqr6FVSC".toCharArray(),
            LedgerValue(6018096, 0, 0)
        )
        horizontalLayers[16] = LedgerProofNode(
            "uqckPmXT8nQHbriBnovwi9CTyy".toCharArray(),
            LedgerValue(9017971, 0, 0)
        )
        horizontalLayers[17] = LedgerProofNode(
            "yVM9nAoUZGp92x1J75j8J9dUCL".toCharArray(),
            LedgerValue(340531, 0, 0)
        )
        val address = "VHTm9UcZKadx8HuVswWQYyvk136m4Z"
        val proofOfNonexistence = LedgerProofOfNonexistence(verticalLayers, address, horizontalLayers)
        proofOfNonexistence.ledgerHash.toList() shouldContainExactly Utility.hexToBytes("912703605340B1AED1F430C38C8DBF9D2F1021F244CF9EAF").toList()
        address shouldBe proofOfNonexistence.address
    }

    @Test
    fun type2NonexistenceProof_6() {
        // This proof proves that the address VEL6EHFxxnzUte2oDV5umEdwH5Egkx does not exist in the RHT identified by
        // 29302920416723E3FACA5E1073A971C3BE5020242CD75F93 by proving that after routing V, E, L, 6 through the tree,
        // the only children of the path VEL6 start with '1', '4', '5', '6', '7', '8', '9', 'A', 'B', 'C', 'D', 'F',
        // 'G', 'H', 'J', 'K', 'L', 'N', 'P', 'Q', 'R', 'S', 'T', 'Y', 'V', 'W', 'X', 'Y', 'Z', 'a', 'b', 'c', 'd',
        // 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', or 'z',
        // not the 'E' needed to  continue routing this address.
        // This proof is pulled from a tree with 10000000 addresses in it.
        val verticalLayers = arrayOfNulls<LedgerProofNode>(4)
        verticalLayers[0] = LedgerProofNode(
            "6".toCharArray(),
            Utility.hexToBytes(""),
            Utility.hexToBytes("")
        )
        verticalLayers[1] = LedgerProofNode(
            "L".toCharArray(),
            Utility.hexToBytes("40C25CFF131339B0725D37409C81DF3E52ADEAE333C2B5B64E1F87FA474D676295971D235C18D2348AF8F576E5B708C076A778A1E3768165ED94F039F9AA0E23E93FB42B97B933939B9AC972B2D24A8F5C64140463C42E8FCF7EED5FD6A0F4C668CA76238531CD80D4EFAD5231BC5ED89D2F1D6CD3C55497EFF5E21592DEEE868A002621E77061D5F083F710A054578FD834B7B8C06630256585B047ADC729F4"),
            Utility.hexToBytes(
                "AE94C96090F239F08A8EC11338B2283B19A4617FDC34795EF9D8A423D2E7DAF34D269558731AE713E88B2C4CA3AB9E9303131E7E08FC35EC978B6F8E82A5ACF17797F6DC81488D6C6968A3E9F7E9ACB5D68C4EE772B13637F8525D4F977DB90B0D19C333071A6822F6076A7A0069E7337477B637716E42D9120BD2D1F097AAB7EE30BC39CF01CD77D201F230DAF7EDB565AE63C2FF977257BDEFAA6880B2096D541EFA0249BDF19B44C2C4D81B1D8B746F80F901BDE82521EE8A78E99C1826E4CA448B61D970F8C5A5F2D0104AE93CDA9DFAF72CD30AAECAF564530470A1CB2065B508189FDDAD0D8A1110A11DFC0C3D892CC2AF2693C9B08B1B30FFE02AEABB1BA1B89FBE09E92E903BADDD58417ADF12384196E1D0E34D72C5F8B7B1C426625B6E2F8AB5E2F57057CE36D6F307324F53B72996CCCE31D57ACBCA8CD81890BA53F05F4AA742C1896528C39B36CC73E08AADD16F0FAEC1CE3D62D0EFF90DC670B76FA61CD45D64A30CD30B64D84B1E9E50488519F66A2B800AAD34BB8E3611110F31E842ECA8176BF7A442349373C8DDEA5E096DA9335E1606FE3FD06E21B1AC9B40BFD6E2BD753AB2B35BD9ED6E311185A479F0A982774C2AA7B4963DEABF87958D4D4F9BF665EB2FF98F88F23BC931B0353A497A840AC7A57478B1DDCCAC319BD4422A36CEBCDA0FF2CF3D45D73C8F1239944BBF73F80CFFBC76A7849122076740F0F1D9789A37B31A8A42F3674C6A453CC47D449116A13C284C29EEB12F67EF5C575EF6C3CABB1431C39381B8E7466C3718445D795D9D0EAAC4BD7B13A1E63C2ED670709E0E79499BA2E7FA8EAFC192924C0E63BA50EC98987232326C9E9D02314DDBD4A652DA7AD31CC85DEBC7EDDF8EA166F25EF180B5FA9FA244F2D5ADA9E65352CFD0431C5822F5B83332B38E065D2EE57AF6306143B7581B5C33573CC03C4AD50EF749F798851F6B1853D88CE4BDF18883E455C1D499CC50271D6997E27B26ECFF734BF34E310D0BCA148239E610B0343B100769F9CB9F6A89F8DD42ACE7FE11083D305B87ACF0A26369B071F05E72288AFB60E885E1A3551C113E3C3F766CE36C4E8DCA894B0050438E17A5AFC3136A2DED9319B7DFD0A9E229F4AF3B8FE82AA460BEF19B9AB52AC30B2EF56553573864613FC7871213049104D113209B1F3F0C50191353D724D7C5AE98420E2FB4FB09A74556D4B56E2069625FB5F0D59161E9FB84B46838448EBEC563ADECFE6EDC95096CEE1FDD5991A0556E959405CF10E277A8850CB2948CBC5D936F3709212EA3CE9160DA0F5A10BEBE562BBD9D616893861984A8C42B01544FF61D9E8B6238475958E01974FF57507D9C6A9878A54CCA25474EBC46902D43EE25C11711BD63A7603FB3CED30790B78E1485EFB1E8B5968DE1CC5184660F74859381D87E496BD005857E510BAEBB3B39B5A0F7D8699DBDFA96842970912D013EE76F563356BDF0DFD2A806BE9F5ABBA419B4648D5FC57140957B3B235A4BE6C9242C0AFFD389928BBE56B90E0A84AFA81170A2D4D25FFEF16ED2B78EC80FE0A2880E1B1E482B7395BC3033DBF18061348379FB131208B8D229FD888C53C30D90ADFAF4916FF24ACC34F8ECE218D05B522A6A9FB0EEF8A7037B55E9DC1904453B45466D5ECC96C5310024B0724C2E3A1E64A2C4C910CCCE17DF01614929C03F5197B5DF2CED461BD15E05AED50315EDF5E93755A530F760DF675B71A626102D17F4261224CA17E5CF78335C2C6856EE80E1D2C0B9CB724AB74D98792F3875A7B978947EFBE15F3EF02F269270F022DE92FEB3C5ECCC176DA389DEB9713B97C40AC29188E87376512A32D42AA96E7336181755C81472D8CD868BCB3F60C6E56120F6C49C7C7FA82EE09C4FC685E3BE2EE20C1D8109C25B0749413CE4947B1614FB90B799642C7850D938A8965D03694A0A1680FBDD7E4D7FF4AFCE70978B6062C26B9FB67E9A6E8ADC1932A74352DA307072F8EC5473D0F5992B6038BC218BE97292B217F065FB301D06580FBB55FF0F047FC56A5EC695F7DB92ABBA99BDCA4BBFF46E459050C3EB50811D2E17DFC2E2B83B0D5A52D2E08AE1160E5EEDBC56110F482A41AB782E0CC02387806A459B537903AEE1E7A0406677AD52D5F0C2B222CD238B5C803D7AAFB1334569906A3C026F8D0F3437C1EC9DCAB467C779C2871E6E4F2681088FB0D7BCD1A5B82A009C61EC54BE49AE25ACDFBCD6FE6F5E3DD141BDA0D600CD4DD1175A54B08DC0686FD54541B341DDDCD134D41FC0C89F2386B979BA31224F5498E959A2C275C5D16E9B510C8E53121936B8C67EDEA14CA5B7189582588912BF0A922BE613414E7019E9CCCC6C"
            )
        )
        verticalLayers[2] = LedgerProofNode(
            "E".toCharArray(),
            Utility.hexToBytes(
                "6E57A89C0B66B6447A4053754451ABF8B1A36FB52DBAC79AAEF1675CB0D8E355809182428B22472313086A137D12BF18AFAB02CEB3A06F07318E3C2289EB65E98D23BE429FFB43478428A2332F33A6EA7B4D28FB2EE421F6B9B91498A29B7B7932DCB4F77A0717718C19521EA7A5BB27FC7F93005AD5EFAB72184F3F4A2F1B71E6EB2F61D09BE03D6BC9B8C2CBD23D97E857521A2DC635446A19ADB3E6F65E593C9BBC473100136B306344816CA413AC73580FAB10776E9F330D390C7020D3BFBD133F8D24EFB2291E1E3529709863DF0AD6FCE6DAF04999549BE8A55F50A4D31D228E8E0AB112248470805D8D0903010C489E3A300B2A48AD43AA0B79D389457346C6F41E1051490427E3BD6B6F773BA65AA7502516E6CA0D669538E791CB6D627ED77D94780DF77E09655A47E86300ECDE96DD3E5DB465630708287D868B60147BF0EA25C30B61857D4DCA817AB0226521F8CE25071B8F5FB1EF6E53D3B2D70A5050DC69B6E79F45B2351BBACB4BE0C2D639A0C02D09D4A47827C8B77265B69B9C35A30E7547BE7C8B9DDFC0F9E6953CF85AB3B2C18D231C57A25E628416673A91A339578B9CEE773C3CF45DDF7794ECFF869CF4B6ED7D4D56EBF05CA7AC27216F9EB13950041E262F13119B5FA3781C11E26077A009746C1F52A6AB986C2BF5281E56B2CFBE17A93DD8920C4BBAF746157F661EFBA41012023CB39C1A8161376C234FB81D989B1F23595EA6F49B2A921A02DB83A1EE9FC147C1AFF04E6580B22FDF24F08553FB41BBEA128C97835F1002DC26B99F07DA485057E56C2B9602AE765BFEDDAE9444D4D3FA4859347D9045A98B22A203DC95062A17DAEFF8BD1E"
            ),
            Utility.hexToBytes(
                "63BFA09302839D377B6DDD938F3E2859DC89EF7218A339012C172BDF2984205BE98856E414D29AF3B110D092488ED7FF49A5B026A9F5B5D06E3E8AC12B2FB32BCB3424F5FD1281C9E24891B4753E104D143E6BF9D1FF8C2BEE826CE56059D4677CFE3CECF8C7091895AA63716D466CEBCCDFB86D1204B6ADB35CC878C2999B8A469B7D56E42249304FFF0D6AEED6C46DF4038BA49E1A70FAAC9B6A4A1984425C1DF6F815DDF1BB40995C3AB021FF5406B0C81EF973DF430E3DB53E92462F2BB339626F6124E3BA802E4116454C0767860223736EF98B96165992C6008DA01D37BD992077014F59F0AC2F23D8410175DE0D269E9920E08D68A96BA2676A3CBABFCFBF7D9F3845C9EDE46B92E8FE27D738F3E8CC966A3C461BB97B86AAFA612179384F73C32D481F6AFFC0213904AE5148694EC70C127B122D4131BBD34E76FD3E7819E1AF99ED04953A01F902DBEB97E2D4C12DE378D72AB37CF30744EE5BF3FEAB6EC483729DEEB7C30BE3BB928EABE1E1E16BF605A98D8B42A1ECB0BE036521F79694B0CBB9357A90BB554A980426A2F777A18B44812334FC07A48FBF7960FDA2B627F7EE65792D81FB69C2F6C4ECFCFCCC0A6A67839D61F2AC7BE05881239C71C6DB004013FBA1CBD2CDFE32A68C12B3FAFC43B4C24EAA5D48F9349C80F1B9FE7BD41CA17207D91BA19EF91096A7A67C806B42229B6F251006E2D5BCB07DD6614AF6639CDFA3AF9C58C458C6D0A79EA4B2D79D783168783B9F18128FD72AE13503239D5D66396B5B80894DAE1810608CC9602808F882D11B4A02388F0B2DF4EF2578E21789170DE1740ABE3F54170416CA9F511544C46317A8BA96BE94D39A37B6FCEC4AA5F5F0BA405E121D815EB29B4457747CB796FC9D2B09A12862B85FD963E645C8C213F99AAA8270C8084360D6859A7DD53ADFD89BBA265C5C5A6A2D42786122CD6CA7443094433FE727D55BF81DB02B7AB77208D6365665F2873050115E17FD05CEEC4D600700A65109F2B074ABCD8B7CA609954A1D18D4BC3BD29355FAE1FE9E50E73F25F35973112C86196484371AD8F733C8E4B8A76FC936447B1B6485BD9D344F90567BDE99C909CFFCA4C8CD0CC4995D3E407C7D41261B533158443BE0613B9DD76897D50F5B7944B979893B7B1FA1CC4C1F7629052261C06C18F811688FB9FBE9D7D176637C260935CC2E888483D555501D32086972474FDEA10BEB20D28AD603E728220F868F1FA6FE05924E63F907F7B8E63B12BE0DF57F9A155815F5BD26C9D5D246F7C880876CF649AFB1BC58F69D012EA9ADBDF1D752A0E313D041371C744BCF363B094874545FC9E5685311075806D2C324E9E4D8E88A29EE736673CE100BF27CCCF4548ED686BFF961F6E12B6610298F2F3BA30D38FDD509B437360FF4A892CBDBF35ED476F8CAEE217F6B661CF45387942B911AA4C19419600865E400778942D742B5C34088403134B15AF15B3089B132D03F35B5A192C89CF959E3F788E42CADD271C4909F3E6B4F9DD5618CF64F8A1A243365BD1792D163CBFD4F0200D6CEB234D9FFED2F0A368B73FF9B86DA6A944CA4769F4F6D67A6942BD32D79FD5D0BE9EDB3347801AA94DFA6D83FBE0D41C224F9B6B8B35120DE817366702397B8CB910AB7B768650BF01191B2C95C3DCA45BC87053110CC719D74397B874CC22C607143A9D499619CECAAE9490D35BB9911D0F6D23625"
            )
        )
        verticalLayers[3] = LedgerProofNode(
            "V".toCharArray(),
            Utility.hexToBytes("8F5E14D78890B7E269E74F15ED15D7ECB011EF330B7CC3389FCA7435FBDC6C10C2AD5C26C7913F4A8053CFCE8B60AB1BFE34976D0DDA2BB68663ED74D2D139840224F47E0F6BE31EB11A28C9E33AB4769BD8B565C187B47EBD34E53C1496FB2BC169286DF14D52ED8E2E243966FF5DF0A660526960799D7B05297B2AC6D39F676684F81F1EB3DB3A5EA244A1B1195E9690BA6B21FA4DCAEB7E20CFC29F953CD0B4381B6D06E54BDC6FC0A837014920F50EBE6458DE880540D26BA485927F779F81233EC6711D6001C892ED215C0A4D8EA8ADD80875C2A9D1542A780D3573E98FB98F5570B3011A43E7B6AB0913C141C479CCD5A4E901180F58398D6C70062586D7CB440AFBC8F24C68B9D863FBD3B70F53D59D7F408579C876C7FF531287CEEC9ADBAB81B677B3BEC60680909A23D7010F0B63BD3891953AD8C79F8090BDDAF171F9F6D10186390DAEBABAD1D35F4F26F4AAB46212D824E795FF487071A7D975592F59C2FF61623A3B539AD77F5560ABB6A59733E37D2F612FB57E71D74F7D89B6271930503E7EF9E7F698CF80165D29677FB74B8062E704D6E8231CA39D19A4"),
            Utility.hexToBytes(
                "A9257E55A6C2F9AA3E0B2A61DD247CA0807F61700DFC8244237924E7A99590436FEF19030F6098C68A3D8B39F420FA409C3DA2491521102D73C44902700CCF63F242BD42BE47C9B57EFA59B31FF5E163F245C8CDB7F389E4B7B7DDE12B84BD25C716B3C4D243550607439F5CC5F6FC31EDAD2F56D080740FED06E524382A62193CDC8BFAD1E3CDCFA3EFF2F2903DA1446608A52A665160CFDB72CA27D25424A5E71483DC0B194FB962783FF939BADC7C0F8025E9A1B6953A5B845FAC9B85E3C80E8A4BC3A528FA48B535390801B302A3AC7C268B25D7A012284D5DA058F5E6FA91D3F0AFD3F158E14D84EB8E89E1F27ED511BCB529FDB1E1D3520A29BF15A47216E5FFB531A5472920FF31598C15C5F46F057B4581844D71012144ABFB011B51B6BF90297D6D1C44568C3F7698B2402DB791EF708F85EB0B37FE1DE91E70EF6C1AFEAFEDF25C7A9A2060FD5F3D71053001FC760D50BDC62FCC3C3C57B287B69EF10BCED060AA9798409162E2CF8B9DDA050A8FEC2BF6BAB2C2D7B194D7A4599F73183D386FC19277B61130591A283C630AE19D57CC5C8CBA34CC5D0E85D26D1357CEE0FB695DA69D5F1D9F37B9D48907DE31D6092CE2AB2A32E7AF161C3BA41E717F0DEB6BF48ED65E6591D124E601DB537E721170F969D20A81F8699BD3C4A143B9DB5361B8E5A0033065EE136FCF1C3854C97B64B1E0D6A1351559D44E5027516ADC211C0EE21E2F5ACC9CA3E0A7311E0C72D0264DE370CABB61100F9C728ED506D3CB2883E16EEA919E80D41607573737CC33F1B14ED09F758292F89901EAB425B8B5C7BF1927B4CE6DCAF2C83560DB8A2720E1E4104445065BC5DB8C4807F53B6715994E9DF95B09BE835D74CF312DF9978C4E14BF68590B4E948845C6473BFA6C0A073507E8D9CBFE2A8626D2FDEB3022BF74F2E598810666AE2BFD0791BED238C36C5A7A22F934BA6FDCA234A4DE1FB47B5196A8C108DFC4C66F0CB316951258013663BABEF0CFCE30C91E1C7B3C16B00976CC24431DE83D83DB7C7368F9FA6DF24C951327C0007736EAC3EAA56A6C448762FAE8060D43C799E9ABEC3F292D4A78F68030B2AF7A473E84D45E3CFF0319DE24E7958B52EAED05746AC268DEFF20D37D57B553A08A976F1DEB647FCAA99AE84354AA0A6744A386F64978A3CD05ECBDE7D5281B07E65B4439C54F9EAD5A308517816691FAC30C5DB17A4C0E54DC9A112692510E11CDBE4C1B272EF9058482434A72B3E4284EA548D3DB24588B5583D6E01F10619B400070E8D771D919BD9737EBCB51D8D63DB1E77B78B971BE75AEA690EF19C4074CC00C7D05292D70ED5C90C1E81FA4CA3DC1872685AB3128F03118E0CFB222F78A51B1BB3E838E4105A878133DC08272517D1F3861ECBE4D6874F9137A56288D7894E8928D6E5196BC16806D7DF3E99DD128D67DE156FACBBF86F8ACC7D38822EACDCE61C0D0D3FD608529E1AEF3C5E41583216D6295360F36131415E628904746817E77796B9E0BFB4E90C5B11EDE42727F10AD1B8F1DE8621EC1BFD3652BB3266324B3FC494B89AE9D1B99C6C125F8E994AE26F502CE06BA9BD030957C16E82DD6EE08F2308740E8CB15B92EA34C4585AEA863249F62FD3D717F07652303E5353706971D87E763BEC59FEF983F2140FB1A78EF22A5DCF96F52E9BD57BF7D51483FF21324679854F40A116A76832864E674D93D3D292ADE3C1D218EC83E0872A635CD86ED8DEB5A5CD669F9D022B569B5054A8E347B2FDDE47C54F7928C9AEC61175D486F2B70970600C2A956DBB1AF2DEFCCE7B783F5D1CBEE7840F6C07D12EEBD7CEC97B3401B8EED12F576016AEF472FB9C53137395D1B3333D1FA1AE7EF25817A6C82E4D11BC2090170040DA5289A638547E7F6CBBF8290B60F72E4F62B45176ACF1806EEA7305FB06D55BEF796B3E11CDD2BCF365BD632DAD3CBA89EC46E990939371409ED67C6205B8C6192F1A21FF3B9EDACB4"
            )
        )
        val horizontalLayers = arrayOfNulls<LedgerProofNode>(53)
        horizontalLayers[0] = LedgerProofNode(
            "1sYGxxAo9ASPqxJmapnQy3M5XV".toCharArray(),
            LedgerValue(9223045, 0, 0)
        )
        horizontalLayers[1] = LedgerProofNode(
            "4z".toCharArray(),
            Utility.hexToBytes("568BD4700B0A08F98352FFE5A1B1CC9AE916A1BFC75BC511A49323576CC199455504F3015821FEB1D8FB8DE9FC0B466AE6D431313759080A94A29B7DF0C17A7C"),
            Utility.hexToBytes("")
        )
        horizontalLayers[2] = LedgerProofNode(
            "5".toCharArray(),
            Utility.hexToBytes("593B2D19C15C5B8354B5A086A39EA4DB25275B0A464B7BF592909638C769C7214AC7D65331505AA5CBCF78B8F6578E4D316FC255D26FE33BDC60DF967CB4F23583BFE3F4B995325BDF93605DFA0D3DDEE64035FE34CFED0E40C79B84AB27A708"),
            Utility.hexToBytes("")
        )
        horizontalLayers[3] = LedgerProofNode(
            "6".toCharArray(),
            Utility.hexToBytes("A79859D4B093346E6CC7AA806CCA8E28A041BE20C1711773FD22750C0EB3D86FF5D7A8AC38EF491A35160F67FCE5114D204C7DE4EBD462129680576BECCDED52A50D0C008203FD5A2043693985F107712858A729FFBEDFF8C6D38857F1AF8FC74656985A5A4C0277D2A70424774ED66327D264C7731AE7B4E7D8B641AB7179E3"),
            Utility.hexToBytes("")
        )
        horizontalLayers[4] = LedgerProofNode(
            "7".toCharArray(),
            Utility.hexToBytes("7DE22C6B11281202E2F0DCEAD5DE6A33FF3DF8FF081863F94429C5A2BDCC87A2C77D70019CAB4062AFDA05EABB75AD9D02694A3683D3FBD3E63BBEEA9DD0BA7DE6413A1990C4CC93D83808C58988795C9DED8565BD6A711A3F9E2999FB6B206171F2FFE9615788251192DBD50879E8D26DFC0BC5AC92F48AC6D9A39EBFDC786E"),
            Utility.hexToBytes("")
        )
        horizontalLayers[5] = LedgerProofNode(
            "8".toCharArray(),
            Utility.hexToBytes("84921BCADC29B393F712A2E880ABA1DA90353C10077C50D04B813900AAE7C7EC12E886527547BC14ECF06F36238C545503CB0D9CEAA41AC45D9801433496C428CA5E0564BC65D48B3ED415A5146D297ED3315DC75851D0EB8394D5688D93F7B570EF3FD8CE9C0B2EF14277E739204AB8AED2F6C95C0E95159E520527E857B5225A38BCBD3E39C69A5E903D53CB06662B612CA01DFA71AEF282637E704E3DD21763131522B682B7EA3A99E49EB1796FD35F8D556965270BAA34F97152E1141D19"),
            Utility.hexToBytes("")
        )
        horizontalLayers[6] = LedgerProofNode(
            "9".toCharArray(),
            Utility.hexToBytes("8EAD0F856CD9C3F5E68A661D033BA8C4C239627E7F252ABEAC32D0D929E48F3CECAAD11904A542DCF4DE84985AC68AD87A646868C0DF1A497B54E450D405EAC7A8EDF61702875BD653D01507CD20BDE4B91A33E758A84F2F56BC427FC74DECFA7845F017D24236CD9AFBC0DEF24971D146CA00476938A68F52C5C44DA2BDE8581D4FC4D678AD166C9E69BFBADCC0B8950CE5C9271C8BA4EBF48B119C5953BFFE"),
            Utility.hexToBytes("")
        )
        horizontalLayers[7] = LedgerProofNode(
            "AMJjT6Vvuvw23ESz2WPun3CDDX".toCharArray(),
            LedgerValue(9564210, 0, 0)
        )
        horizontalLayers[8] = LedgerProofNode(
            "B".toCharArray(),
            Utility.hexToBytes("7DBD80E0580A3EB0B5B4CB845E7533C45D5928236C282422AE215253B747EBA2D737E3B6023D63364C1100198397D2C2AC39992D2ED584CA19E8F4136E45F6AECD1CCF96D2EFD160DE6DBC48A99AE85F50FAFB581A73B6501A7338BEE67929DE5DA897B4A080DB5DBDFAAD8D026C8B8112443843181E6A9C49F2DCE2DF736A6B42B13ACBC58984BF9A8F70E26248D619367C2271967FD98CA1238E078EB9D3EF"),
            Utility.hexToBytes("")
        )
        horizontalLayers[9] = LedgerProofNode(
            "C".toCharArray(),
            Utility.hexToBytes("C3A74837AEBAE6C205A786EC3A6602A202D79D4E21725C19CC590CD36748B17462CA9657CA3C6EDA8A14382B71BDE0FBF6998A6AAD856EFF00519A2E8B5EF320A36F2B2839795FDF7DD43A556BAA0FFA8A6E15EFCDADB4DC68432CA7D86E8EB23DEA0D9178908AC8F6A74ECC167776C3B9EE7BDCC36381C6514847B19566D32842C53D5E46988C373B81A9C094587E1BEF4562DDF5D3C11906C24EA4AB20FFDB"),
            Utility.hexToBytes("")
        )
        horizontalLayers[10] = LedgerProofNode(
            "DhPXs5zmzxkQAdvXokc4G8Zgpn".toCharArray(),
            LedgerValue(3567667, 0, 0)
        )
        horizontalLayers[11] = LedgerProofNode(
            "F".toCharArray(),
            Utility.hexToBytes("3C12BAE65DB40CCF6AC2190E7EF99996679F8E7CED9B658BC53A50F75C612E3AE45EB5224A0B551FE461D5D69976C33A9993BE73CA840B33E1AAE5C499F5B77C46FA5594A2C918393BA21CB068DCC6408FA4D390E2E2FD35834639FCE17681FAE93B7B264BB0E50B2C4D0D276506E37BA086F29C203D2B17A42DF95E0796FEBC"),
            Utility.hexToBytes("")
        )
        horizontalLayers[12] = LedgerProofNode(
            "G".toCharArray(),
            Utility.hexToBytes("04D64DE175FCD31EDA1071A564EDF7AFFB277D98EF59DC7119AC2B30E79EAB5094590514BEDC27E0EEB2B63114BD56A34ED994F81D01D3F45FF4C9A185F7C4304B41B43FAFB1EA1C63D02CC9DA4BB1D26248BB4B9CFBEFD45794B2737B6F1461"),
            Utility.hexToBytes("")
        )
        horizontalLayers[13] = LedgerProofNode(
            "H".toCharArray(),
            Utility.hexToBytes("ED0C64B1543C9BC720A4A69F7FA0902F485F540250C7FCFC49C4B692F03061EAEB72E952492BF109E39A8981B49FF8E01CF742070344F09C8C45868F7DD78470D0A526919244D8DD342A64DA9FD49BFE9BDC4BA6B7737A72ED54C95F585D021C9DB164B1FC39BCF082BB8B438FB649FD129519E950F4A8083B93CC6F59B7082C"),
            Utility.hexToBytes("")
        )
        horizontalLayers[14] = LedgerProofNode(
            "J".toCharArray(),
            Utility.hexToBytes("B37C8FB61F0F3078FE8F47803FA4DE23DFC342513DDF3AF6269194EFA4627DFF741C15C78111EBA1122B2B5AAE82AADFB2B0B7E3A94BAA680EF4989AA8CE00A22AD1C0C5653298CFD933B8189FE5EC214FA29BA074CDC5A5D4C1CC3AA084BAE48199AABD371432A6FACC2B15DB7092FF2B30B646CEE35C3374A17F413CC617A7"),
            Utility.hexToBytes("")
        )
        horizontalLayers[15] = LedgerProofNode(
            "KHA8JaKZkj8GYzYtCQpWSDbwSb".toCharArray(),
            LedgerValue(6221998, 0, 0)
        )
        horizontalLayers[16] = LedgerProofNode(
            "L".toCharArray(),
            Utility.hexToBytes("C467C36D53D3BAE1D27C2896EAF51E2D9AE7A707C25385EC120104789CA38275F57AE87FC6DE9A09215B1D2E80DF789C950813899E93E68B8398F094839A0C57AB178D79FC4C90CC675BC41264411283F954008EDC4A90A8E8EE63897E1EBF3E"),
            Utility.hexToBytes("")
        )
        horizontalLayers[17] = LedgerProofNode(
            "NiBQxuNvKaks6MmuczFhAAEtkD".toCharArray(),
            LedgerValue(9209759, 0, 0)
        )
        horizontalLayers[18] = LedgerProofNode(
            "P".toCharArray(),
            Utility.hexToBytes("6116A898552428F7687398900E3A638D4957B6AB3F3A4B0123EDDE7FF003C940865FC857F7F47023D31B9AA461FEC04919A3CB06C54CE9844687F72C0A03BD48"),
            Utility.hexToBytes("")
        )
        horizontalLayers[19] = LedgerProofNode(
            "QFxcQkcCV6gF9ibNUvjUPFCxgM".toCharArray(),
            LedgerValue(8692186, 0, 0)
        )
        horizontalLayers[20] = LedgerProofNode(
            "R".toCharArray(),
            Utility.hexToBytes("318E1EBAF567FD49A38905214ECA115EFF0A55853254F017FF072165B7564ED6032F8FA65EC2FB6F692EB5CAE64BE3C247121B34949F187D1EDD68F4C8A722F823B25B98B70324BF8A335E190FB33790C1787CE2AAD9C04FD8DBEDDEC9525F1D"),
            Utility.hexToBytes("")
        )
        horizontalLayers[21] = LedgerProofNode(
            "S".toCharArray(),
            Utility.hexToBytes("099BC79C3CB9FF383C5824432375226095A00EBFE7C31D2C844FD878B246EDB2B1A6E4A0FB4562AAB3430B5AD99C79F27D9CA2FD0A5D426DFF437A9CC7708561"),
            Utility.hexToBytes("")
        )
        horizontalLayers[22] = LedgerProofNode(
            "T".toCharArray(),
            Utility.hexToBytes("DF36CEBEDCCBE0843CFCD484F0F4944C38613B71390878DFC0A0B2483A221466829C67038C222F40A35555307E5D0BE8C9AE7E647645916C19131BF592D1DD8E"),
            Utility.hexToBytes("")
        )
        horizontalLayers[23] = LedgerProofNode(
            "U".toCharArray(),
            Utility.hexToBytes("8742F24A32B0BDA6F5EB70B85F39DBD922376472D8F0DAFB322B83B74457239E21AE6719E08DC45DE9F612DC78843A343474A0AA58EE9D7254ABBE1B4F357C33C21BFA5D2AA88AB03168238142DD9D4D2D108B9433AB8C10F25A5614148A5D12"),
            Utility.hexToBytes("")
        )
        horizontalLayers[24] = LedgerProofNode(
            "VDCAF1GeuQFP1PH72gaXY3CJzv".toCharArray(),
            LedgerValue(3467002, 0, 0)
        )
        horizontalLayers[25] = LedgerProofNode(
            "W".toCharArray(),
            Utility.hexToBytes("C4D1B5CEDE0D082C719F3DDEF9FDB6395D3FC24AE51E892DC215C8AC79F755EBC196FAA54BB16866289AD2979AF4A33C5B02BAA9605C0E56F489719FD0FE4426269EED9DF72C5C3E5FD77F20B8EC948EFB7AAA094BB063612A6B8C43417F199D"),
            Utility.hexToBytes("")
        )
        horizontalLayers[26] = LedgerProofNode(
            "XuXAtmGdsdobQSu1jr4VKC5Fqb".toCharArray(),
            LedgerValue(8200164, 0, 0)
        )
        horizontalLayers[27] = LedgerProofNode(
            "Y".toCharArray(),
            Utility.hexToBytes("5C717479C5B12D97CF985A1874D81CC4303922CBABED429B362B93601D524C3233B956ED71B395BF7EE8E662CAF334BCDD9CAF6A805A183EAB6390CB5CD08632BEC9B764CBAF33FDE713694D53D7F392A9887BC723D1AB6234EDE4F780DEA79662F19F20C99340126870AD329260C8A9A9D9BF6059899C43D59B7CD3FBF73885"),
            Utility.hexToBytes("")
        )
        horizontalLayers[28] = LedgerProofNode(
            "Z".toCharArray(),
            Utility.hexToBytes("2129EEB67A4D9B065281C1567BCA7534CAABDFE721E0A151B57FFBD1AB0B1B0D881345B242DD107A78E868B6DF817F0E29D5993701C709210FF48D5560EF1CC64C2F9C2D4B954406BB1C099D13DD3282E4DA06F14C527528C765749736CC4E405C805C7A4971FDA2A7F3FFF1417B54AA446D4CA4B065FEBACC06CF4114C3335F"),
            Utility.hexToBytes("")
        )
        horizontalLayers[29] = LedgerProofNode(
            "a8ixJA6WmpfNH1A6gV39G3N3Av".toCharArray(),
            LedgerValue(8764809, 0, 0)
        )
        horizontalLayers[30] = LedgerProofNode(
            "b".toCharArray(),
            Utility.hexToBytes("70F73A1850D973D234DE382AFA7CAB17136640ED60724E6314FF03B18B7F6878BEEC4D2A9AA2F7E8F3D0CFA307AEF21BEBB074BDE48757A3AA474687E4182F04A87164C77D8B20BC702CAED488C95124702ECD768622EAD329E01D276EF31C39"),
            Utility.hexToBytes("")
        )
        horizontalLayers[31] = LedgerProofNode(
            "c".toCharArray(),
            Utility.hexToBytes("0354F5CF7A891DFD9F8FFE2C9C8E2F0A2FE60FF1BC1D2D7F9766D7EED829F6F309706AE62CA05CB6D57A2E7A70CD83055DC5FC4F18BE6B3406A5DBC5E6CE010F6F35E5BFC3EDBB7F18BC00A3C19BC7CB40194C00B29989AF14D635E992C26A47"),
            Utility.hexToBytes("")
        )
        horizontalLayers[32] = LedgerProofNode(
            "dpAahK2w43gASyrwK9Zk8E1T57".toCharArray(),
            LedgerValue(9270166, 0, 0)
        )
        horizontalLayers[33] = LedgerProofNode(
            "e".toCharArray(),
            Utility.hexToBytes("75CE38697742EB595B17AA024D6798B7856AA65E5EA71C20C3ECEF35CC52BFC5D0C35E922D2EE10C3D2429A4AF6EF5263A36FDA9707FD0D31F3535DF060AD1B1"),
            Utility.hexToBytes("")
        )
        horizontalLayers[34] = LedgerProofNode(
            "f".toCharArray(),
            Utility.hexToBytes("8D6F36468710A48903A5E762D90C4089477B2B49C1EB2564FF738E03AB109432B529D8316D5E392B60296A1A987E1593287D3A1DCDEE79E7DE5256F9F3C55E8CACA0D2BA52FAE829CB35E01C34829F81AB8F8FABEC3A512E652B5141CF10DDD3"),
            Utility.hexToBytes("")
        )
        horizontalLayers[35] = LedgerProofNode(
            "g".toCharArray(),
            Utility.hexToBytes("D16E8BFE6ABDB556E7545F0943B577D70AFF83496FA90C1CA8DC9BB35A116FE163747696D9B1BB6947B9F3573DC06891DB11314F9BF0C4D0FE78BF051E52C252BC0F5BE352FE5991FA4F467ACE3C06EC86093A8130C0D542FD96A83DACDC3B66"),
            Utility.hexToBytes("")
        )
        horizontalLayers[36] = LedgerProofNode(
            "h".toCharArray(),
            Utility.hexToBytes("5CAC82263BECE3161BF568AFFEFA89DD25D0BBB77500AA9A7580E880A41EA6B7E1C273E068A07557AD0C6D25A991B1F9D402ABB7A1EC94E27D952C0151FBF48EB9BA83960A3D8005E7F0CD7AAFEDA3E0151CE0C1F4A95CB13C6BEA3D3F52CDBA"),
            Utility.hexToBytes("")
        )
        horizontalLayers[37] = LedgerProofNode(
            "i".toCharArray(),
            Utility.hexToBytes("8A0221A225D858D7950B02DC4F59B8C725A4AD82E23C206A9EA6AE2E0B3DB9627614061A11972DF8F3C462FE6099EEC15AFBCE3CE0F1FF503DB600C5D8E0BBC6"),
            Utility.hexToBytes("")
        )
        horizontalLayers[38] = LedgerProofNode(
            "js8GjJUcjsyoRhmpTtwJ46wY46".toCharArray(),
            LedgerValue(1722285, 0, 0)
        )
        horizontalLayers[39] = LedgerProofNode(
            "k".toCharArray(),
            Utility.hexToBytes("5C4D7553609CD5D99149E0C724DB952B81301D56C17C220A384E6871B0957E84581E5357737E9F023EA1BA598886C3CC24941BE97F5EF4F728452ABB21C818426F37DB79BA0BC1854CD923249F508D6A8E6CF448497AF55909C65A7795752B20AC4921C972FFB2EB3D5B399DB821DE3085CDD9A40975576CE5A4C47CA42B0822E361785B12867422C362A6787F9C63FEA5057269D77E5B19CF4045328AEA1D00"),
            Utility.hexToBytes("")
        )
        horizontalLayers[40] = LedgerProofNode(
            "m".toCharArray(),
            Utility.hexToBytes("67F9E6C3A7E95A2EB0EE5AD9D48B5C82FB4EACB24ECD841DA981EEF816CE4C57561B5C4919330904FD2691175F464807F644DCD13F9E3C6B195B0D5313A96F40562C6DA940DC34321C5973FB6A27052A6889C04A518044DF43B998051CC1F4F757C4FF2B972FBDD016885D8E06C4808D5DF0999E7EF24E90B7A2E42EF38C447ECB558D3973E408D0758B883708E4D9AF31EF77C1B2FF85C8AA7B0A1F28094781"),
            Utility.hexToBytes("")
        )
        horizontalLayers[41] = LedgerProofNode(
            "n".toCharArray(),
            Utility.hexToBytes("C8213DD5637025B1D611F586DCF379A633FA3599C5403B52C571934FC55AB6213DDA7C279BBE1A739A16684EA7A0EC6550C7FB0D1AF97D668D85D117671A16B282A8CE6E7A23851B28F35F1EE514E4459C554D478FFF9FB24B6C16696E3FAAD2E4F1EA3BE95E932EB36AEC9450440F8BF1193480E4FE0FF2744FA47F4A7467BFA78D8BEC0B7FF8CB5E8C351361649770132A37864027EA5927E45E62D38F90BB"),
            Utility.hexToBytes("")
        )
        horizontalLayers[42] = LedgerProofNode(
            "oeVp94Eqe17EU4VNGvaUM2Mah4".toCharArray(),
            LedgerValue(7336225, 0, 0)
        )
        horizontalLayers[43] = LedgerProofNode(
            "p".toCharArray(),
            Utility.hexToBytes("10DF48CB781AF502C429D344671A6848DB4E1F793B770855AF416AF3F90ABECDE58C9CE045B03B324B4396FBAE8A8822DAB4AFA40B1F45331BA61A922C388F30E343DF04E6DA8F7A889BF7D7D6B7D5D6624F3E8EBB739AB4F7DA99049A0AB7BC3EE13D76BF60FEAE49A954A674C205961A6B85383979C2CC992D4310DEBFC78F"),
            Utility.hexToBytes("")
        )
        horizontalLayers[44] = LedgerProofNode(
            "q".toCharArray(),
            Utility.hexToBytes("77E782E86458F0F8224AB6DE87C18631CD277B789866DB35EC756689378B1D47BC95D62105C2F1BC4FAD9D9A70217EB2457B701185EC9D7E4923FAA872B34088CE7EADE46B83EAA1CEFC990A5340F616FAB554436CF3CCB51B61E9C50018B871"),
            Utility.hexToBytes("")
        )
        horizontalLayers[45] = LedgerProofNode(
            "r".toCharArray(),
            Utility.hexToBytes("9BBEEAB3B3C3B56ED567A579887DA5396596250A93541BA4D5FD5C764CE2D50C2D6DADA5CF1C4C8F13285A47CC4D141908E733FD168181D93B7F7A7A76A7636335F2DD579C68E4F13F1F646A94B2CCB6417B1292819DAD8FC171EFE6AD28486A"),
            Utility.hexToBytes("")
        )
        horizontalLayers[46] = LedgerProofNode(
            "s".toCharArray(),
            Utility.hexToBytes("76FA0E620ECC5FE788228DDE9DD8F112A0942D77E98214B354F8988C8ECD8BD9953E1EC9D3F4A848744EAF485563E6B2F4009B6665CF09B7CEB0C2E0E066DF5300FC47DF02124593B1CEBFBCCFDBB645DA63A13F84EE0E8C38BBA2D482CEEB05"),
            Utility.hexToBytes("")
        )
        horizontalLayers[47] = LedgerProofNode(
            "t".toCharArray(),
            Utility.hexToBytes("2F4C2E3D45AAE6D4CAEBB778727A4888DCE1F1626BB7A0E6613E93DC22F8B98CEADA70E8AC7598D57DA9C9050B1EA4202716EF1EE1C78962A332FEF320AC526BB693221B22CDCF502C125F54889AD46B88F3638A1DD8374BA34820526FA26C55"),
            Utility.hexToBytes("")
        )
        horizontalLayers[48] = LedgerProofNode(
            "u".toCharArray(),
            Utility.hexToBytes("F1DFE4373D2C8BE2848E448389778F4463C80469AC88487E260B734DBC6BED43722F6B2B0417F1C4D3B4494892EB0D521B0EA50F6B6D57F96C8D4A9398AF6947"),
            Utility.hexToBytes("")
        )
        horizontalLayers[49] = LedgerProofNode(
            "v".toCharArray(),
            Utility.hexToBytes("5786705CA37DA7C05F74944F775841BD6E907FE1F568FBCEA437C492415F869DB425A71DCEBE5CF6CFB1D52E38F9478851144BC05A09800A1768CD560CC7A5DCF17D185B1AEB62DF8D13B27322670CE2336D4CBAEAE2D458A3CCB2571E69A2115E495C00F9D67D162A1A73F2D86A4C077C738BB3FD35A26A5B017BC6848457B1361C3A26BF9C6F956A6A8B75D08950D0C1496AFC805159A8FA6536248FE3DF4D"),
            Utility.hexToBytes("")
        )
        horizontalLayers[50] = LedgerProofNode(
            "w".toCharArray(),
            Utility.hexToBytes("339F30183DFFD7EF9510D144F0500BA0BD13BAA6FC36782126B0D7973C21980437BD3D62C50B91C4A5B6F2155D6AD96EC3AFBF2E5CF573BA099FD8A5F10590A5"),
            Utility.hexToBytes("")
        )
        horizontalLayers[51] = LedgerProofNode(
            "x".toCharArray(),
            Utility.hexToBytes("C20DEFB5B552C6E7202B5C23917FDF627FA0AA6E7291055D199C07BF1B7AC19FEE6A04F49CF2AF29E69674D94EC7B2E6AC2398134DE1C05BF94C6EA468993C98"),
            Utility.hexToBytes("")
        )
        horizontalLayers[52] = LedgerProofNode(
            "z".toCharArray(),
            Utility.hexToBytes("DFF7330F6057C75A376726666EEBFCBD566B48CF8BD6E6D92C015E788F4C074CB270433FFE0535C8E3F1443461B322FD443D7188705E6FF1BFEF9E6876720860E2326323E11020891216EF2ADEF26F6BD6DBCE9999DC17B2730C74F6A60B9CEE42BCC83598E7A2CC59CFF0BFE025E61AEFEA1DFBBF1018B34EA79ABA1434CE67"),
            Utility.hexToBytes("")
        )
        val address = "VEL6EHFxxnzUte2oDV5umEdwH5Egkx"
        val proofOfNonexistence = LedgerProofOfNonexistence(verticalLayers, address, horizontalLayers)
        proofOfNonexistence.ledgerHash.toList() shouldContainExactly Utility.hexToBytes("29302920416723E3FACA5E1073A971C3BE5020242CD75F93").toList()
        address shouldBe proofOfNonexistence.address
    }
}
