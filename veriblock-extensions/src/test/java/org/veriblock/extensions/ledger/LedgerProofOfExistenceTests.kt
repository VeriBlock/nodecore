package org.veriblock.extensions.ledger;

import org.junit.Assert;
import org.junit.Test;
import org.veriblock.core.utilities.Utility;

public class LedgerProofOfExistenceTests {
    @Test
    public void existenceProof_1() {
        // This proof proves that the address VFtmKMZzjx9JbyAgX3G6Y8Ri3Ho9uW does exist in the RHT identified by
        // 7BEBDCECA669943E16000F3B657322B7AD0D5DD012660A59 by proving that after routing V, F, t through the tree,
        // a child which completes the address's route (mKMZzjx9JbyAgX3G6Y8Ri3Ho9uW) exists.
        // This proof is pulled from a tree with 1000 addresses in it.
        LedgerProofNode[] verticalLayers = new LedgerProofNode[4];

        verticalLayers[0] = new LedgerProofNode("mKMZzjx9JbyAgX3G6Y8Ri3Ho9uW".toCharArray(),
                new LedgerValue(9370812, 0, 0));

        verticalLayers[1] = new LedgerProofNode("t".toCharArray(),
                Utility.hexToBytes(""),
                Utility.hexToBytes("E65653591A85030C479432F80D0412D0234FFFC3083746CBE88281ECB65B3204"));

        verticalLayers[2] = new LedgerProofNode("F".toCharArray(),
                Utility.hexToBytes("4A5163B1682399D168D5216382E72BAF0E20C369BBC91306F5BF5FF54FEA7FCAE5E97FDF29406E8A7E99D4C5694804092464E932478FD174926801BAF4D7C31F552FE48569410CA7579111FF4359D29D3F980C276CB08F2524AB2CAAEC208AF3A8BD0B65CCB50B7A2ADE64B8A0B5BB0CA63B778834C5E156DC55BC7904B7295A27CC7A7D3B39E3C3E07D680A1336C931081D190080F7AC06A06EB1F6FE2EBEEEEDE1D97CCD97A5FD0887E5507F0646C773DF5E60B93E76DFD4A3015281DA6682E16F07D812829BCA0051C2C96655A9EA53AC353AD8B7DE814B9ABF8DF249122102958AE0016DB97509A3038A3812AE431B9F2B222DD81BCF657F16D1449463896DE15581B089F866F9FC65F6F77BD1D6A3845D2565F70D6A8219DDA79274208BACEB768A49F64EFAA7AB9F20C24191188E8785325DE3D5590EDCD7A0C890645FF0D5708F6A0F0F6BA699C75F8AEFD7479BC9D02CE2F41CDBCDC1B0535B0324F7970C4B88DB9877261A4874BD2CCF0BF60C809C85E8DC370E138A0B3C3F59003D4D06606B1750FCCC43A543743E878A3E87431CE2368D12261EB3235A3835705E51E78593C1FA52B8425663021A20F50B656F61AAA36AFD65E0DC9059559EB77739B9D7F73B136547FC4FC298C0A7B9A9F6C1664600D44072A38EAB76E0D335B64D04B763457199599D75A88ACA7ADBA3A2987AC2DE3449D7E3A481432DDAAB8AA7580072BFC1ACAE6C810D57771C773D6CB727058AC27F5AE8AC06FB2034ECC93DFD971008BE0FF99F767C645D1F35DE6F6FC9FACD388133BCACE9B6C9A819F4B8C01E3FFD7D3D8B9D2B8B4FA7971AF45849D1DD8DB30E01902FF31ED32C7D632E42463FC8D424D387672ED4DB30367EBD01A7C4475C3B500A6B6E191CD1E015CC3761A8A7C7DA34FA941ADB254C3C3EC300984D25850097F5754CC1F12E69D20EDADBFC5ED4A56494A63BB462CA2DC1E3DBAC8CDB8879E230E2C20B7D5D99F6D63BDE2704C8E94E979DD325ABD4E382EB22EDA8D80D2DA393D156A1F67F599422A6FDB7DF4D1F69C1EA3D5CB5E1CE641725076305C089C1A281EE445911FCBAEA753EB05CE4CFA0755398BAC8B85192AFDF9B2B7ADC545DF36B3EABEC61640856CD174A5D9E0E1107B37E61DAAD47A0702D2F5EDDAFB4FA299D98FC7E300091C0FB56BB0CEA1DB529204590294AA41B5CA483181A36FB312C16262859289A0E61B3822EAF119D6EE0CBB1FE6FBA2FC8799102C92E16A1570F2E701B8E07ACF7E0F03904EBE2B8001BF5F095F54789898233F790352297E9472D1AC2328BB9C8B223B24C2A76EDD11382FC4F20851A5D0749D0063A64333EE531546740C9C84C"),
                Utility.hexToBytes("62D5512D3329AF12D38707D7DF3D327A8CE4D91807962ACE770AF157599596CC2C002880EAC7DDE92378437EEB0E0C59192671A647953955FEEEB5B079A20421C936BA4AF425879B42B3A5394A8EA467F3C2693444CFFC5AB430EFA6D6849881C7C0F05DDB350F05F45CB973EA0EB0676E19084192BE18B6A81799CD02311D2E3530CDCC1E5BDFA3655D083166A85FC50D28668595DC9A9B24C8B96737C324B5"));

        verticalLayers[3] = new LedgerProofNode("V".toCharArray(),
                Utility.hexToBytes("5F40073859A8A4E4FEF7DE6BB13902967E491D8471C8DA4B8DD3A95B8755E2E4810C18A5F1D9E9A273931345FF4BDD4F5E64980C861FF74EE7B4AD76A44F043DAA3CD5AD220063907C5B184F1F9045491B01340CF3F422E02FD66C99DCDCE6193CAD49F3136780017ACC39DB6F031041F9DCEF1AE32EFABBA9542EBC94E9A29057F43CD7A164F7A11B75A74949965BE67286AC84EB9AC550D97B7EB229BFDBE1EB4E797DC3CEBE849AA1178E7F93F16108FBB58BDAF0ED8AABFC9C1BE23D7D0DE5E53AA591BCC86380BAC16EFF02A9568C78EC255989D76590C530901BC5EA6E8FAF405AD14082446413616FCC2FAB6C7323A047A9D6EB8A526F9A4CCDB8D811776CE8DC179623C44CCFD25B40226E936D61264D3C74F082D0ADE06DC2F723B3F2699A994E8EFBD93E16C173142F18BC9F19E2066BCB4B2906182D6D03C26EDDE147813A6F09F7FBCA78F0F84D6A1ED75ACDCD21A36A9119BDCB29B53C686C4108CD598E170D6A59717E43B77A58E93D6B7368F95415C38646F9D549051E2E87898E991AC58777A2D25BA0B22B82437788ECD92AB9AF0C47EF8661230F93D799DA0E782C04E011071938664C17166C462D91A6C1C2DEE0A3392A72C83C5FB495"),
                Utility.hexToBytes("379D2375DCAD289C364CA2051A24B47C843AFD41F69C81D3DAA9FCF934CAA073CC2DE49700C9404947A4F748820502353BD00960951383F42451154AB71B0CA566E0860795CD4DC38A2414D817174B9562A0E2132C548EC636A7C3806F0058389C37BC421C446FE46B77A0B61E2030E8877028EA5DDB646E9867F392DAE721DAAC0A3EB20885351784A235192BE61D028CDF3505209D97BAFA9B9A00F614862DC82A81DE826CB59DB01796193A1F416C49EE7CA8D2A31C3DEC8D05572B6B20E57E53D8C52EC37FA05EDE4279A2BB249F3BB02AEACE43F9CF47CD4A2338BC35218386E24699961A7C3620780A3FDCA5142E9E3E30B73E228F8C2E8953942F066195D26FE2B8BA6AF5A14AFACA034D6E9FE9BD9DEA58D1AC627B2D3CFD0D4E2C3958335AED080C5E94B2B27341B5894CE9DFCA403C7DB63B0D2FFC2B631A6F46133C3E6D08C5897642C9CE81FA4E450190E4A6044E1B2D34900B2C3ADB64005D974298B367105D6B5EA4346BB65EA95ACAF3C8817135A2D49F501328F064BA85EFEC864C55424FBF0AAA0C8F5E5CDFC7FF4D2A75128F9C2694668219543C907B560CB4D991B29343001D75BA06200290E2302CFBDD7F6172BED18ED6779DCB516F294E5C7CB5F87D5D77FF340A76B2282E9B445FE744F3877CDDD7B2DEA5AA3B6D368448C9E4919516FC596B51BAC0E2E45B7113A70FBBD672013C29F73141382DBF4AB716F8E18B2B38E2D67DC2D1CC3D471C7313A78B36457F660DC71A462F6728EB4DC14D434F06F0450F12DB49D460C819CFDAEE87BF03EABACFA729D2BD47B6B1C3F12B3BF7753DCCA75F87FD6FB5473D7084D8A1FCE62ABE01AA803B605889D98B1E749FC931607103814C0B0525210086853D905D898FCDEC377A106ADB611732B4639BE8B0189A54BC9E17B395DA2DC792342A6BA8498CEBAE814E559938A34A7B25F990C413EF260CAE3DE35119AC6631F81DBA61ACE348BF7732169278F64BD607572625F9A434F7C34F40E336DEBDA27D053E9216305AB1778E19967E51BEE26370B58F2844C40BD6844752CB0F352A34DC851DADC0B85AA239C7BC23932135F3537108415C4BD23B5DFF4D04C63D371D8A0046D946A601CB0841D61CE3C30419B0D4F9FD111B6526675A9109A13079D6E581666574E11DFE1AD5313E5AABDE390C2DE1A8BA9AF6534E80E2AA73F8B64B93C88E2030908C075C6F2A"));

        String address = "VFtmKMZzjx9JbyAgX3G6Y8Ri3Ho9uW";

        LedgerProofOfExistence proofOfExistence = new LedgerProofOfExistence(verticalLayers);

        Assert.assertArrayEquals(proofOfExistence.getLedgerHash(), Utility.hexToBytes("7BEBDCECA669943E16000F3B657322B7AD0D5DD012660A59"));

        Assert.assertEquals(proofOfExistence.getAddress(), address);
    }

    @Test
    public void existenceProof_2() {
        // This proof proves that the address V7DoEWs6tBswEg87gQSvkNuAk8P5GJ does exist in the RHT identified by
        // 921A7A3E30EC7894F2F821F24CE8C898AFDE0F341C137797 by proving that after routing V, 7, D through the tree,
        // a child which completes the address's route (oEWs6tBswEg87gQSvkNuAk8P5GJ) exists.
        // This proof is pulled from a tree with 5000 addresses in it.
        LedgerProofNode[] verticalLayers = new LedgerProofNode[4];

        verticalLayers[0] = new LedgerProofNode("oEWs6tBswEg87gQSvkNuAk8P5GJ".toCharArray(),
                new LedgerValue(5582235, 0, 0));

        verticalLayers[1] = new LedgerProofNode("D".toCharArray(),
                Utility.hexToBytes("7CFC087DB5DCFB61B6C5E71A8C5F90C0E5F1C6D7166749277240DABD6534F574C20681BF87097D0B0D3A8C4E0D4610BFD37D522CEA6AEFEDE0F0BC74E0EF0465E1A849D450068209FACBCD58B0CAEEE975B28A6BB0B9A5080BFC65E362CB9114AE902F8BB684E6EC829B3C1B6B5C29B24341A62C41DD8F2C08FC1646B99B62FFE80804AD2D0D9D43BDACC16FD47CC612860CA121B4579A3358F0217BF10ED17AED01461FECE3A237361A3B3C18C8E339771BDF0F8FEBD9B36F4EF119D2F34BE8"),
                Utility.hexToBytes("4B1102B0B78DDE6DF58B1C0F12A6848EF235EC6997ED9EEB07B0AEA301E3449B"));

        verticalLayers[2] = new LedgerProofNode("7".toCharArray(),
                Utility.hexToBytes("734306D928EDE2DC32308D330124B1F41B159C634468002F067086FC489A90B850E230D6A34F6A33D0CD5D7D9C899C87F433D514BDB5B5781A5E29CD6F779F3E6489373D16DFF1A3FD8E4A97016ADD4F3260C6E6D04EBEB370AF1FB76CF58FE709AEBA1354B947D9F5FC430E52480410A65FE21637AD42D91DB3E5FB2655F1C503AB10D21528D1A7C23A1F034842C26C8023727C85AECE86F893DA232DAD6A8D5EDA3530C6436B9279E679CF1560FDB6A55DC18643B70F8A839DED2C588D88B0DCE94944D8B1AF76FFDB6E0ECD2F2AC993C80CA0D8D1AED26A337D249D1622FE794F7D39E0E6AE9CD7D7DB2900B5FDCF8D908BEB41E473A9AFA2AD0FAF5BB1C1C6E81C56A25F2CD3E88F953E19B483F9ACEC82ED5B752341D97896DCFA5A6D0B34229360E8EC48133AF762DC3A17A89A26FD18111BFF2451C6F34B02F1FD3A0C1032EA595BC63C6A5D8BF9049BCEA8AA35D96C291AF2A7366E503D8F722E158720EADDFDA9AC4A30C1D7B67EC6C12F16C6F15EEC109BE1F70F4B54642CAB188B"),
                Utility.hexToBytes("2C9FB2F6E4FB7040A5AD31229FF920FB70B368B2A2BD474A5C20CD696543E0DCAF11FB6C3D9022D5DEC71A9791A7B9B75A2747CBF2CB7177971BF8DBD67A1FF36CD7D10496D14CAE208856B18AE73ECEB3C5251EE0FDF700CA54A0CDA4E5FD7DF4EEC897702A3D59A7244156523266FE1A1AE15839BD2E9A813415FAD094A0D234E6BBB07875877CF0EDDF22A062D78DBF8B6F6FCCBDD06400FEBD29282BF08FD75A199230DAC7865DE64800A97A49B7F293E24A92BAEF6EC120B77C17A36F815C0D30CC060B4EC7321A12566DDE9C829C8A07EFEC81817D7298BA14A900289BA18EEBB084C1BA51168D0DFE7F48B52282B632705DF1EB86894428FC33538CACCD26B8A9F0FFBF8DEC79E5F1DD3B430CD686097050C89F791CC1C6AF724DBACA51E063098DC9962064FF22FA594DE90BC3551E0A00E9CE3FBA78B6F56BA86BD6C9E4E5A58D2B498BAA29C3F6E714B3E8DB42D6744145F8965767073B4A0FF0FD7729B1E090578481DA315E66ECF467C0D93E8ABB13786E1966DDFC194FD3FAD469D32EB22528D9BD2F1B1666ED8E3D8593CAE208FAAD063E8AD4A2FBA419975C03AF407024DE55372F91A1496CDD11555E01A86E10F29DFA5113D234F2529465B7054CD65FC49F32459BD6A58E4D62FF8B651A34D8670718305E7FFA027DA05069DFAA47835D9115E72DE9AB806EB26A25FC9218FB69388B84AEE7F52E0075342B11A731625AD6F79428F3D0D39344409B41445F4A16071954F2E65961FAEE9E1355506959CEDEB9F82BB5B3089E899A2F868D4ECC54E08F048797DBAC5290769BE544B83024FACC9FCF0D2C818EFBBF1B988E169940B6D68BEFA07FC1D91CC4ABA09FEEF0764172D0F8DBDA0067D7711393E089CA2C3B02359063557E208B89BD81D2883AF7A81591AEFCA29EE286C9271AFA4329FB6F488F56FC95D55F4BE3B9A4C948B9B8C74873C0EAE16FB37EC0D3900C9C7E314CBF6D84C91B877CC84113144F01A1DA402961CC2776341EB8228026A572FC910180F896057B663E4049E8F366086AF23422EEC6B36EEA7ADCB1221F3B7797028CCB8BE5728DEEA38EF5490111B3B6964FF0840BD01E0066789DD1F354AAB33B0DEE97D528B0D415CB4057C454719810E4B98E872297D33B67419198B56B2D29055FB6038A7D552E14B4CE4776A3FBC413EFE3740A8D1BE432A29A0C39F170257674CFEA3CDBFADFA14FCF988D61596B47423F25C2D6643EB5C6CF2783318F3C1FF63A624D5E33286EF8DF6E2346F34AF458635FDD2A0677DDB72E08307E1FFFAACFA30B92B926CB06F0CEA56BB96828710E87282311ECF6FAB73AEB789CBA510754FFC38DEA2CD1F981F97E46655773E7BE9783A62D53B8C0006444EE22342796E2CE7A4D09F5E5CDB68E42C6CA450C9DCB7491CE195276EAD0B30EDC9F51D541862EE1FC8BE2F1537DEF271F5D83BEC9FDF60D7391294FC53B7C2BC14A7D25368081C1F68804AD2BC6800FA60D43482825CE58EE5326F71FEC689E0C14AFA35DF00CD2A5B31E47286795836B76545D8FD5A8AB41771BCD61F0D32F362B97D67D1A408623377B191082F01C74CE7898D04F1073800A5D784CF8FE28426ACC15146376DB3A096B27C135A9BC30779AE7BE7061E414D7BA2C241D601E6394819114FE66E6A205462367857D0ECE1D76C76D4E4396FBEB2039229FC9CDB4DCA95CC93D55123C0D32C086236FCA659F76B4DE82C1BA52107CB01105513C38342E0D30B4DE5BFABE4E34B56A725CDB2690BEB84F1A79AF100D28E8EA1F1340346A5AED5AD7B2572291320008B38CA35A2861BF1B2177CC4ABFDBAC91178099A1297D1CB8ACCC205DD4D4DDADC88115A1BFEF283DFF57DDBD39943A4FDA770049BC44BF5BC5FE5ED0F3C1268F77923418CD2D3872D4EB1E96117BBF13B967DADD75C6801DAD42E8E5A9929FD66CCC614773EEDF65F16E95100D710162C74A10755123426CF9B84787FBB6424D08B390BF25C45A6895E6E4CCE1B4323007CCAC5D75C01590CEABDF167822C07B"));

        verticalLayers[3] = new LedgerProofNode("V".toCharArray(),
                Utility.hexToBytes("2FEDDA860FE494CBEA85D58387DC5CB70D21231ADCF6930861D42067FDEB2B40FF637E9104EBB28052EB26693E318158F2E2510149BCE84ACC79C73872AA05879C69530367A44BB5A1F62D0133C80A74C7B9B93259F0D7C6150B85BE1D8C4228CCEB8DACE785FB9FDCF251773BB31257B10E425F0853CF48CE389EB3D9F2DD952275EC5BC412E65DAF37DEB4804498D3F55031D267BD3616449B0B70BCF625A2ECB3FE599B7009EC0DE78ABA6AD820812C3C6E85E52EDC006202BE92C2E238A1"),
                Utility.hexToBytes("317245FC99B68461A2E71C844295F1DEE2A174D5784FE4DC3B93784D67480382F64F0CF56480554EEEFF6ED91D78398F9DDF103BE1E617CA1ACEAEB16E794C6259CF0DC85152793B55DE495249F26538464BAB9C1C2751F7C5F81BD181FCA93C8D2F86117EA6F109C42B65BBFFB997DCD5DD11A1B2E48B2A2830E71F310666AEEB8DF0A9048602D0844BC435D21B2F97A3F91FB84B70A694F60372DFBDF6AB8AC3777752405873EFF303E16C5EDB7D621785D8826E09DECED9EA6F5BAEC3757AF40FBA4D4F3FDC1D1314B2F8AF752DABD05F5F7AAD1F100F87EF78338C36F509D1B049BD5E6EF96593708D282B68CBD391ABBAF5E3A4E9015C1A611D68A18992691380080A86D7D0885813064D2A3E0343DE6347ECCEA1BC329714E62290EA554FCC93B5966FD70528D7C8B08480BD8D48F882031A8F9B6A2F58C9A4F3C5DB4CF9B5B1CE64E68E2A98F98292009261412F983C0225B6B97F6F01AF3DCE2BBA183C0D7262EBAC0854392EA4DA3F967639DD053D7CE1700B8B82810AC9A6F8A16CB43C22B2BD5F9F3E5B365F58DD9F0FEF92923509F7D9E0AD59ABD6C96B90D515A45CBDF11D3B58E5EC5877EDF0EECEA864D15CBA46E765F7A660D32A8B05FE329EA662804D064237378F66E55841DC27CB433C822198707B8528F3842F206326D7E4E4E961FE8B959EA103F311D8551C52B149096AE1948D5865299CCB2D8B6F388AC806ED3B84646D0D867721DD16E515997E76728C06A9198B5F2F6DE2CB3362D9F3DE33C0765F21B7E747B59E4F0AB9F156F5238A53A580C3D16DAC202837A2A4DA21AE1795DF3EC388DE8F943AA16AF83D6E2F77499FD371845A5C8549A76E1582365A6E5B225A00E69A9C7547F0414BA6754535AAF5B4D22BAC85D023CC1C51357A90FC9D8D718FB2D48BE252E7AD7AA379756F095F248889C2F2D088350C430B25E75CEDC008686CE6053F892426B6609D1F568DB98C5F6CDE57683CE3C64A1C488DACB6D6108A784154538F3D602857DC0658A375D7570DB1A50ABFACE3F7DAB618F2FE4B80B07F38CD33B2744BDCEF69A906ED2B61806E2FC9E840BD5BA68401C26D7C264F72BA4B6D14EDDEFB22B586C885962365D7B81E36BF41C762636FB5F0DB0221EF8EF2D6745688F7B4894EA60473B79E8BCC9F7D5553E0CD659FF2693B4DB0216B5B15CA998B387F3DBABA8D23A88FA8E7E1F28EB95624F1F7DE0DEA28AA36A9D96BA54154EF98C1C890FDD5A5DCDFAAF9ABBEF3E07C3CF623F25FB81CEF04A0B3CD09E1B8862DF88BC05D20EB0675797853A3765D8520A77721CBF4835D33D8B3440DE18556A8DA828A2BDD06385CA367D8F22923E54C0DA02E3B0560634F37534691FF2B485F80BFDD2A97EF6F129D84C55FC2FB01834020425ECAC530F0B73111067575D11056FAAFE342191A2150984C9258BE80AB41C3CCC885A5573C1CAA5DC9A64F8EC9F5782D0FA7D1A40FDE312BAE37B720CCE6FBDE44079166DEFDD8BAEE80180636B892F03D948A699812CBE6860FC90CDE00B83BA5314CCD60B0D1A96A99F0CF7496674D05489517B5D2222E0A52C72693B8270D2D88F9B57EEB1C352606FD3D1468E8A298A05A67D41C4B88DFB627EB6EF170DB27B42F953E06E95970C7555C857959960B0FED2EBB681E229647012070CE32A63CE0F3644066FF8A561E1ACFA3D9F2F033E2BBF5F28BA3C33F5DB2A252D6CFAC9B2154944FDD289532FD5AA33510D5798F9C11DF2914CA808CF083F896CB44B96AE750D67AD0F6C2719F62B9220546AA8E2EFD59D07F331032100E2D36CC2F9E5C4F4625DE40EACB31A359984F968457968E528B5745FD9B0292A0C6F97CC86C24E98E8382EBB2E89B726BB5FE568957056CFD2AC7DBFF552966C9FF2D63DF9CFFC5BC472B8DB05361E4AB29F279AE0FEE80A3884A737772E9232E54681495E4757765EACE96A96A28DA71614CDA27BF11C4EDCD1E878D0BE05A4FC68CB45830051926202E55804FE9EA37D3F0A4AACF19CCEC7F1FA84DD3DB36F7754068387CA62ED1C66E7149FDC6F14980AB5561F0CACBC55CB8EDD69FE7F2D6377AE566FEDC8D083E406E3D69A880EB40966F0B9F5AAE3D6E2E30CCC0DB07A01DE9A8393E3388BC43C23DBB1BA7C576A708814723FFEC2F0586023BB8615C0D876D55005AF29FCDD6D15D5BC7532A1951B60D695F9FDECFC7F7B605F1799B724DFE86C0DB63BF3C36BF81884B640F0B195724039852E7A8F0D3DA447AB57A15E9E454CE7781119E4FB91810EC16CFC9DB9A55E3B197FDA63C1C35231CCBE2E1162B8A"));

        String address = "V7DoEWs6tBswEg87gQSvkNuAk8P5GJ";

        LedgerProofOfExistence proofOfExistence = new LedgerProofOfExistence(verticalLayers);

        Assert.assertArrayEquals(proofOfExistence.getLedgerHash(), Utility.hexToBytes("921A7A3E30EC7894F2F821F24CE8C898AFDE0F341C137797"));

        Assert.assertEquals(proofOfExistence.getAddress(), address);
    }

    @Test
    public void existenceProof_3() {
        // This proof proves that the address VAn2kmEHCpB4PS7bXYbNNeXAsDpmbf does exist in the RHT identified by
        // EECD6CDCFAA005F79497540BC3C1B81445814DA9F3CC4A49 by proving that after routing V, A, n through the tree,
        // a child which completes the address's route (2kmEHCpB4PS7bXYbNNeXAsDpmbf) exists.
        // This proof is pulled from a tree with 10000 addresses in it.
        LedgerProofNode[] verticalLayers = new LedgerProofNode[4];

        verticalLayers[0] = new LedgerProofNode("2kmEHCpB4PS7bXYbNNeXAsDpmbf".toCharArray(),
                new LedgerValue(8244815, 0, 0));

        verticalLayers[1] = new LedgerProofNode("n".toCharArray(),
                Utility.hexToBytes(""),
                Utility.hexToBytes("B4D187F1EE210FC72B514193FA05FB1EEB262F7BE1A5DB7D33DD791034D59AB96DD2D530E40F4735BB67A61E87E6543ADE34A0FA84A3D8A976EBF982497BD87A3A08218DDD1C44C44357ABD7F534B1FEFEF1A4976EEC54378E9AEB70EBE7C522EDA8B9D47F32CFAA619F24185171610D893C11B9D6C87C60786E7C7C129C9F0A72DBC1E69074E0663DF0C33173E1B98B02C26B1EAA55D173E9A896842C0FAF4954745D794F5BCBBDB3D15D2F9067C82FCACA1D1CD45166B550DCA4BA907E7D2C38B84FB3A768468CEF004B5EAEAF82DC5F1ACAA8B70A8946034AB0541269A4D1693B50212633AA3765290CD22C0DFE683BDD8B5420164805DA8573A271710C31"));

        verticalLayers[2] = new LedgerProofNode("A".toCharArray(),
                Utility.hexToBytes("3C2C88951609A4049E62A1635019A227A52C1C362458F6C8C2B52312CF7926B38957C8C2A9F811B16B172F35272654FAA95988F5F67881D291FE41DEDBC2426E58417E7A8EF71EC4B5CE7C6CCBB762725B5B1A97078E1413CEA9C344D4594389CCF0435EC9DBA2D66E78B4D0430251E1DDE73323776D8AECE6F892D27481D5D1E4D1E0BD85CF9B3DF09A71C23EE7E546AA3922847E37F5C83083CADCEC944613F0AB4110317B2C34A8E7C4B8A53B8C7792705B8310873DB4B1EDB38544E03757AEF665E897DC1814491A31969057FB162D8C0E601FE9E8E35AAB7733A104DAB8EB3A7D8FEEBDEE0E1142DFE45513A59FA2C3BB623FA80FB0763A2D6E11438C6A054144CF159EC262164EC73A18EE1CB57D4CAE170AC6155F256A6B1F8B5BC40DBD002A3794EEFC3DDFE2999FF1C65FC0C25C01723D8C9E4A8EC2A0412862E81541999EBDF5CF16FD0B34F85A4D09A4E87C48C335FABF7DFDC2B2CB796566E5F6AFF0A2C160A96167774C7599081864888146F95A98E905042DCC3BA6D36813AB0983F46AD2BA6A3E4D7CBB0037167BC48EF0FDCB94690BBFB0BE624587523F7F4476D0C07467A6E060604CEFB9EF8D9BFAF625890B895A6588050AB471E5A8AF193227525F44B107DD6C6D220814983307AAEDDA59E1C00355D17EDEE6345A4118EDE84EEC5A7073F8B84FCC5FBB985AABA66AE0813AE6EAE09CEE5C6590C8C12ED4E955A6CE439440C3D89A5AE152B6FDBA0F629C167759796A3E9489CF8C0FDA20837F6AD42159F186B46DCCAE94FD57A06579936883AF3A7B30A7BE8C29E311A7DACBA822F9CF4983F8278C404B8148F404A2105BD1253FA88AD0A6342743FC086D296A5C5052E44703DCDADA47AEB4CEC8C28BD4EA8B178441162F3421C65CA8DB4C356FAA7DBFE49441AAB2B4D0D72CBE0F1D4EB51E174A1B8741F8BECD39D720A28C18D8C205A2F67E6236FDECD70FA7491A4D55D66CBA16F061C5B257239E971F878E0D9AF4D743A6B6614918BC6DF178FB20CCD48FBE7E92B07E0D30B95604801267378E05A894BF537600442CE83CC23F8226F5213FDA4E8EE4BCF8960E2C165341CF180529520362BE30629DFA0808CF02A0D2FB4710688ECEAC50F4F6786475905B45F0CD1F52B6833A4FAB5419770BE842914CB298B4319714EF3207B0ABCCF867EA87B484444F9963824ABA8673C762BA3B00BD8C1A88B38F498315FFF4E9A87B5C8C89A8AA6333C78C588DF958FC6A339F2D1DEC3D4C21F1807E74956E56855228B16D390EBE9DD1958096BEA6F0BC7CCEEA3C427A2D539E94FD64567597AD69B55511F6A3BEE2D5FD4395012FE2233250B48A7C813EF9A3004E4623D1724CBDE0F6CBB9EF7E81E24F494A2F3BB1FE9B51738A50ED06FAF4613068D5E708AC04789159A5F00FD4658AD19AA63601F9090296B8F1E6DDA509DCDCCCBBACF5DA2380D738ABA455A60B4CF95C9DF48B696A742D3F44C4A7EE421015E06FA55DD8100B422ECC6AC1DDA82481723B5BEBF11F921FD0633B9463C8E348361D5330AD1F479C5069CE45AFEE7AB5F5F1029EFFFFAD9B8F655C354061AFDE6DC053B6C2DABF27CB199E9D4EDE504BEE4151DFC922647653E5FAAC5928AF97C829917A2D94CCEDF1F61A0390866C015A64BAA2083B2A44C480FFBB85BF1A21FEAF43DF5042EBDBE63603F802B9C90420DBEE260054A4054D1B24857C92F1E9EA589684CC67D276FF542E281BC7622D45A37723768747C3088CF02F391B4F55CABF0C3AB6FC2481FC4D059808DF60C9D97CAD1A8D502C42A3D435739C30EC21D2CCFC0B224261649B343641CAB8E5E15750BD3E954915D7BB6CA43255BB19F272EC9065B159394AA12540C716CF29B7661281207E6E387FD7AD510C58262E9F67448010191D58E4146F3E5B92EE457623E69ED2BBA656ACE085E7DEC1B2313AE3E5D8026861F44D3729496733292C394A322830E786EF0AF2B54BE24F80704E8CA39D9042D8C23BD82C20D1D404D03DCCABAD4F9CBAD6FA0BB7355A572D2E"),
                Utility.hexToBytes("E0911A90098BD4B97D7225B2AD60C399E8D91815236875E5615FB22DA2466DD168E79EE9EA71064249231E88CB71DDBFC206610C74DFBAB9EBFADEA064ABE9F7487DAB81F3500CC44702561F34BAC4D026484FD17C7D8A99C8F8CE58CC40B534C5CC74744D69E4C8EF4C7A58C6C6B2832E0A2B1F414D1A7682DD80DC37A3807E451ED8810F0D317E157527B05E2B65F5E27864C259EADA57E0EEF4739F44AD5B7CE59E44609973309394EE935F6335B5DFFF37F5F248E4ED47433467DB58020E56EF23E14CA32E52267E84EAB9F6B75D3C4D2119F8AF5F51BFA77595F25A145791ED40E190E86781038A0039E9BEE590A8A426CADDA7610F72727F2FA918D9507C5D6E6EFF07B9949F5254508E1EA8CE5C5C0B6A95A5490427A0994F587F3A43EB4EF2B5C27B78950ACF8E932E8467B3D4916DAF604ACCE6E2D1F1BF0843403DA3EB50A5108C238A0C5918595B724895B6A6DC3D0D01C6039E8F25CE896A5D0531276299C1B34080E569A8404A1BEB55B32510351B86C4C5E4D24297D207AFBC"));

        verticalLayers[3] = new LedgerProofNode("V".toCharArray(),
                Utility.hexToBytes("66DE1FAD343704D4B3EFFFC83E067AA028346983C95D062D5C998421D8721BF4BA95587E5027CF3EB74830A1918D8A510A83C1979835F047864EB9307468045CB06A256DCACCE4B3731A1C4BE4C4114917230B1CA3B940365A133555270BFE7BAFBD6788822C2A7F4CB92A196E5E4FF283E07FCC5C4F6E02DEF210D40D0B904C5BD9238425E44A7BD2C6305DCEC1151453801DDA2009FE61C80AD741B9B7BE4329C4D9C7F48139CC621CA27244C6E699AD5F287C43D739042AF7531A62326E41C1AE3C2D6E38267F5F4F33E218B121F34E70C4A72DF6D173717F86902ACEAB10CF986151285B13007FF2874C47CEE738293C78CC18CF515D8509684FAB7669331BF82D22FF923BA43970A311AEEC4A08547B4470B27CA315714DA25EB5142C75"),
                Utility.hexToBytes("73DB1FE6190428C345D442EFA3BECCE630262FCF2E316C67C90E1E22BD3826C4D98D91A621C411D5A79565A0502B0233F2F6C449DA16CF65F6CF41C2E2F9F56A86030A07CA801A8503EF564628235494B938E97E4887A9C4E90464387BDACDFD3640969A80573575622156C8F84D4D2F33E5D08A281B7E391C4A7A6B3A3FB6ADA3619D2460BFFB70C3F1C4D54560BB5D20BEEC0A18990CEA682B6428316AB51A43C1AE42E08BE852AD91EB3D03D37216028C0C3579CB3C4412F24FE471949AA4693F7F701ABF857ED07E98DEAC776B08E69E4085043D30C9972A201590312765EE7176322828FF87F97B4FB0EEC433A84E26611827D0510B50A0F11B76A7C74C277794D2E9C34C13DA35CC172FDD895A66B0A30EC38E5DEB1847DB63B66E85A40D672EDE00AAC7FF914CCD838F7E5CC890B8B711E7A02D3CAE83794510D3576F7C3113DEADE193464A9735DD841B39CB9F1473C2882D5878AA0FFEFD9DC4E9BBB9F40CD453D6149EF872B5E8F3890EF2612C38B315960BAE85BC1A7AEF451ECBE188EC5D86BBB2A1BBD2FD0FB33B39BA47A4E4390CDB6BC5C4E9AEBA03FF505AD0CEB390FB5B2356996C207E4C73E7D57D67A486C3092A2C5B380BF8B39465E1EB308E03F2D289D343297600B687380FD3C47A82D3BA4AC643BDF54C73526987DBCADBC80B3118B35A75326C861335207B78D50D314ADF3CDC8432D3682755D6B2E5F6A3DB80FE7293568DCE1D1025E4F414ED5CAEE1BB0DCDBF3EF7C50E6E43CCDE51285F69100FAA89A784CF5577533490C96186DFE865F9BA2CF6A1AA8657E2854B5A3F8F943C5705C104993B36549EA3F7F3FE44464F983D6E9860CE526AAE7BB18E2DED837537145D56F9FD51F3E2E577DEBCCCC5F9CFED1760804669A023EE7066654A7FE42EA24F2EA82FBFC096878364536FA014B9CC79EB608117697273D7DD487D6D7A2A3E401905A62138296385A56CED8F6B283C5C8D25E3AE16435F58DB5ECBEA3CB5D7F75470955512EE8A9E6AFD7E228A356369925E6AA5A158F82C7C730DC1A69AAD071B2743BF6E39607DFDA0C8F6CA8B6741517C7A38BF6920D804F2A6BF64761608AB91DE7AAAEB504A937F974C643AED4287DA05B240718156F6E4536BA212BD1A95322557FCADA88914CABDEC3AA00CB835CC764E881171AB5C25E6AD6ECCDF051526CFC4D3C79098E2C0ABC9B417D8FE1870641A38EE71ABFEE7CE26D7C6EBAD4031E55BB087AB6AD517A6A14C772E33BA3CFB7BEE885443DE6CE42511AA1D90412718F0DB0A01026D593B582488835503254D1A2E63AD2E9C30C9A16F3291DB7DD0C9CA8B15101C4C74514A43478AE498DBEEF20DCBD810A683015DD33663FC50B481D92C6248D0DCFC2E9104DB4FF5AF83AF6E68AED9E2D3A6CE3DBFEDB0F7EDACE41DF7DC442B3456FA1EEE6EE09A6413FA87525F314B3544D97F2707751051C950A5462FEF739D68C68126BDAEECC87BDB602B8576B27CFD23D14202A321F4BC0C7A7325F6204869E5C3E86473C750C74085D771C4E457F0B2762CD20BFBC54BFA5F2C18C420CAA4B4E972222A834DA464EC3BA6ACDB4CF05F00E4468F5D6E721F8A78BDFE7B9516593EF03FA79CF24A65DD4E666ADA7E271BB844300CBC8748C444228F0B93C7573E2519DB1CCDFC0E1F076BB5FFC02EDD894A9063335513F40914A24B05BA79FA174DD78918C18385A499C2DD7D685B99C019D3D26F3DD5E3B49384A6BAE4747E469FAA59AF023916B243E9434F812C0EEA4714D2A6CB96EC3CB1CA5E4D4436CCFE55A18EF6FCD21674BA6C3D8D565B1FE692913DE97DA1DDE31CB044CFB166C7C3939E2191E776C24A1E9D38D2783ECD7B365D353F0F0FC2B8923EE356FF88EA805BE23276AE11972FA9F839F7898BDFBEB863286B0634EAF89D8FC6AD37A8C9D72839C7A2669EE80805FBF0790F9831DA59F1A1C397127F5FC78B7180817D58897B98AFBCA76E7861514EFD0F732952A42A94714EEDDC468D8A3D5709CEB23530F6BA1A9A474E913B4405124FC60DFB66ECCC2BBD5A2259BE4AEF77BA43C29B0B3F037BC8A0B9CD92B2D8A010A9D3453BAC26E0AAB0C63EB6DC260B772EB0E1E900C8B81FE00F94B80978AFFB0ED60C283ADD36582A0FB73492AD95B1C4CF4F578E851BAFEAF3296D4ACB"));

        String address = "VAn2kmEHCpB4PS7bXYbNNeXAsDpmbf";

        LedgerProofOfExistence proofOfExistence = new LedgerProofOfExistence(verticalLayers);

        Assert.assertArrayEquals(proofOfExistence.getLedgerHash(), Utility.hexToBytes("EECD6CDCFAA005F79497540BC3C1B81445814DA9F3CC4A49"));

        Assert.assertEquals(proofOfExistence.getAddress(), address);
    }

    @Test
    public void existenceProof_4() {
        // This proof proves that the address V7kss89YAAwpLb2znCVt3RAnG8UR7H does exist in the RHT identified by
        // 806013B302BE45009DC09223AE252A66B917E0F7648B2D1A by proving that after routing V, 7, k through the tree,
        // a child which completes the address's route (ss89YAAwpLb2znCVt3RAnG8UR7H) exists.
        // This proof is pulled from a tree with 100000 addresses in it.
        LedgerProofNode[] verticalLayers = new LedgerProofNode[4];

        verticalLayers[0] = new LedgerProofNode("ss89YAAwpLb2znCVt3RAnG8UR7H".toCharArray(),
                new LedgerValue(7104217, 0, 0));

        verticalLayers[1] = new LedgerProofNode("k".toCharArray(),
                Utility.hexToBytes("E670C5F229D458C0AB3B85814FB02CF26A675829580DC119D1EAE0D427C3AE2F676A765F5B54ECF83FF02DA17E75C9F0D1C10ACC44470D9CBC3676389B5E0D35F256066F228AF061F66395B4C07610F0C0EF9EE6CE54E299B3787DD99F5D1DBC3A98B82149436674C6CC7D0B2CCAE56EA22A062DB3A364FCD2C1348E635808A1B0E988DF2A8B02A9E801090C2C7880400985A04C95EA9E310CCC17FF182669CEE084B13BD198255A81FA5135CDAE07953CB09F9869046D616A323F293FC85D22375D3D07726B106F9D33D59E74DB320D6CE0DCD3D44D93457A29B2009A0B078FC6D3A1BF85408DA6528B955ED59265DFC6B68EB57732A15E4D782FB0061BD859A03D40112DCC422661E7A0322BA8AA87E148678FDFC7020E5E86BEA0CFEF0E54E11DA19A013242C4A356C5C5175C9A01434B9CC0E1C9B7A80AF87EAEE8CCA8B30E17F98EB309AAB14A73C916139BD2E26B5B63AE1D58C7AE2032907C2AFFA9600B3214311A48835D866EFAB4B585437D8221829676041FBEE23EAC03B71D2A7CE816861A605AFA72F02E97C69C35D8E954C1E9B049DDF69F3398866CF44B7DD6212EAA58481210FD522570EC7B2FEDD93DE15914A5E6FD5B6C7657523A47E51B539B152A8E22CB5E8B13B6C3C58B740E706D7CC2AA6C52C8E52D9FED12326D273F93C25C4EF8AF532FF6CA7A5F0A2DBA0C2C64BBCE49D14561990F18E38124AB92834698497E39F6B1FF8B248EA9F39BD6E6483564DD963AC1FBF217749BD44CE182AF1EE99F3F9F0AD38EC73514BE188B56C8D3D3F6F17A695D23DC336AD4D376E766BF29FC53EF86E29B81F3E3CF7911B3D7F565B574894DFEF32E3BA18412084E99E36E981408A4D61465CC483A4B0CE99455A770EAA6586E9074C211695EF82949BD1AE9B140F81267BB4671C393A913698E3DE11E592A9FF24287D5E148D40037866A91C3D8DC4ACB4CF6626A5EADE7F25B38A0E253716551F7EBFFC5E2C20D4B707CFAF7B4EA61CF9ABC2FAB5A212E33E9F799E1D27C116524A606E777B87C412250F3107ECD6DB4589EA26737D2BA64FBF242C7F2EC4F53F323D837BABA3D458999517707C4501375250890141C86D5542165443F0E9CDBB79DAF0813E31F7608BE204EE71945A3D9548600BCD91BF66F6D2F65B46B27E6CA422219916BD26423320F50D22F6B807904685DF8C9D56560516F0DEEB26937FCE0A5F89D2CEFD0B380C7D8BD835F5DD82E2B8CB29731EE15EAC50A6D58D85E0D51340095D4DC861190B130A9FCEBB72B594416B804D4654D83A7A7F0E02207B3D4849EEF4B90835AF9B219C5C60C9B573BF7A18A357787B0D1ACB8725AD0ADBFF1204B96BD970B360354F897A1A03D6A3BA70AA87CB049D96592D6781BE99AD392E5CCEE79C2EC51E5C7247C142B5294B4B4AF1E4680714AE10350C795F0AE77858243E1CCC97DA76802C97EF53E6E62533B83F681369A5016D503E2BDBE5F5C6651D0EE0017BD8A6F82039AF128A3ADEDEDCD7E731F4861ADDCDCBD4543D93D6385117CE86147F9AB2291DCCCF29342D3E55E1B4797DC90E5D564EF811810B19CB0D192397B9E170CD74C8A935036AA1CC63EA1514800EA77C602A1ED833D4B218D721EBEE713BD3B6ED1BC98850A5C22F779F580407057B73F9D615155F2FE062D894A3EC96C95A8A63D164C98CDEF759F17530C826D6432B598F08F8C0831801E846706CE185F223523E4981E4942CF67CC0480D3312365D0D88D88688CF1C5278DD19443C70E7C142943555DA969251D601CFD32673AE382069FB09CC5F631841F2ADBE4FF6B5A9A1D9E8A811C44FA90EA5BCB676DBD980F64565499C8F181CCB1798A5C0575FA731ACB8C053F2DAA6D7CDED49FA526A18FDCCDEC70FE57914987C2392D50705D92562612FFA3816DFEBF4579F86124C19E9BDF118AE3758B2FFECF"),
                Utility.hexToBytes("CFBBF012BAE9F0BBE34F7ED8BE6F50B31484899F2BA029CADC5C55BC3FFCA5A5DF1EC8BCF0C03C6DE73015FA25EB0DB49F7B91160ED0907E4358CE9E3E3BF480F653C2197D407776450A301711D6376FC1470F70B85B2C8D7865AF99A1B7CB148755469CC7A4B987A7947EADA5CC330600200A4FFE407FC3C225CAC8F5D517A3"));

        verticalLayers[2] = new LedgerProofNode("7".toCharArray(),
                Utility.hexToBytes("A5125C8524CF242FA8EA4EB66B6FAAA050AD179ABED60072C5235CD43DDE14CE76FCAA99D9DCAD769F9591C1EB9EB722BB6280C29B74ADD21F4636D0EBCD754EB394DB75E60F0AB7DA07FC541ECCE6B16592A097C039A7AE0E165A582B7BF6E27A4E7821281FE038778FEDECD19ED58BBB4A3FD6F455D69CB2B9517239987FA9B91AE7F3365942E4E26E7C9CE815782BC97653A0BBC33A020EEC440335D48B83EFB9952DCC89F0895E9AB25AC82DFC03C4F6930A3FD60318BACBC35C0A1B8F13DDECF24153A6E3AB84272C30A23C50ACBD7A66EE3604DBDFF6D952B85ECF0529CA1B5449AE3E3EC6FEF452FA55807FD8C4211D58F75BF16D8A78717605E17D5B7B0BDE6F3E9F90303DA7CECC6E73E118CF18056BE2B7E16991806CB96D18FD399B6D1A8BB409801546BDD5CD2E9644FBE1E98F8BF82524780A85F3FEEBAC3598C6A08D00B715AEF5987AB71A9B5560BF64C183D35749BDDBDF808FDCB1ECE69AF01E8106F1A00F0C966CFBD54AC84CDE3883E4A197ADA7A5CC485FE318D2CC107C8C4CD4A6FDF5AF90E9544B085EED29F0B064A76A7A9DE042918D55615987E8F674507222CC7452AADB90EDC49058A0110896913988D88319EFD204F09643752EBFB3FCE36626AD98DF139F77D5C6B568C2CB14841CA96119B5B2FA2D7659B4A3DFC9123B7F1DAAD050B119050CF63A7F048EF9A049FCCD227430E4E57FF0F95445F7E733F3D351D6D893B98E409A023B4A618A864F8983B1FA5B81302CB2E7E6F46AC2E1A3E5FB72A33A614B36B3C57444DF0EE40BB04B5837BBE9F2B24545155A9423811E6EC855C65B96721736D997D779D6DECD0D583EE52CDEA3AF00A5D1D1AF545807F7220913EBE9A2D3A93DBE500E28C081361EA47BAE0DBCAF3B7D880D19B437DBD5096570CE311E108F4082F97FDA566A5B3D38D45EAA49D4AD116855EF1A46972133645D5898A5B88364B37AABBE2D5FC8BAA45AD184420F056DB0974D63E0872B852495D463A9B32471270209608859C0BAD69BC98ACF252B78527098FCAB98E726C9BBC78565C374CA03583CAC096201FAC100036D6762A2D0B578D88E38036D2B4D80532F144E11EF0D0FEBBF926D522E377DDDFB9A10BA7FEDE92C398A54AF3426B1B3E8B5F82651B17BCC6806CADC509E0C0D87BF6087A8675025E6EA9DDB7BF2B03D1E3916D12F298C506D50C28B5B4F3B02083125A8080B57357BF06C5525B5ECDB8EF2B2344E9521067DE02CCDD530B8ADF9F3659FD50E6FC4B51DBC0315DB40BEAA65178BD8591AAD44AD820BE8677C37F156F3439842A708F5B2C30F6197EA5FB0BCEDBF17AD067E181E063E35282FE6B3DC5AEBFCB293CF78A1314541C416345034237D5F921AE27E28C23D57441DAE8A6DFCAE2CB1B24B58CC63E81421190D92DCDBA1D249876CA74B88A5207CC95F394F6622DD089EBCA8643A36FB1B983602338B52C72C50E58780A99CF8A1CF3AE36F21FE26A90A0A1DC3A577A0DCF9F54BF791D5D0B427ACE9C521A42B4C7F7FF442A953E25CB4195001F4D8ECF36217C02332D66D01C32C674D6B0DFE0903AAC60AAC1E9367700F651B25CC49B73918FED32D092629841E85912D6A5A3298A35262A1A014F89FA2F5B5F5BAA94BBF9D40BC15119BE7A5821252F5DAD80F6859E7A78C2013095EE3D6B76B80B8E45553CB75E86019D9B327DF8DF304A3E35A1FF2966FB15ACE6F94757872DE2C1DCCCB7434D16D74CF534F603CDAFBED5545A1221E37C5F9655BDA081A436DADFF8A53EE819547269C089D56F2A2847CF53491B18B0C0074058F834955622C451F625C8E949A7AD22332F51AD996F25A559D43BCBFF373461D14E0B20E85C2C8CE351009B32639AB207AF0E997E0BC752D8F66FC13B9CBE11A2C8653F3BCF64324DF0F443534FC71F520B8FFFCF07394A0B141DC14E9CC3A"),
                Utility.hexToBytes("635BA45D1D664A1A59D328C14A906BFF509F0015B0E3269730FA855261CEEF8EE263C52250D93C04CBECD0F0BADD29E6D891CBC911019C46A2275CBA0CCACFE7E5835E2F5127D7EABDD5A51364D36F544BAE30EEBAED431D240E8B3B24C768BAF59E8A5D7C6DD738D1AD1B00F81EC8289DC4BD1104E4E2088E82B0E324AF6273DF04366EA4A22AA5EF0ABCF88E4D2D7ACE4660EB526412A46693F919ACC74567421CF28F3C2691A3E9899E2E13A7001C67F82A6F17BFE0834BD45746402BE5E50E249D3794A6908C77225845262F38132E91627ABD133846FA4632A5D397F0ABD1625DFC924B48F9AE0DDE812C93F6151F5CD1E21D35EB13A3D69D5AE5D99770BDD323774BBE436DEA7CC20894359C37A5BD9FA9BE3DDB482FB62D81B579114D4B86A61D371A8CD7073820C47AA3CFB6C3726F35C5EBB08F4A059E6BF61A27B8672522AA65E5D055AF7AED27F8FBE23CAC440ED0CF4819515425A95CBD6ACDD15E43A8AD90321A88F0B800D30A095533565DEF7D5BE54A48BEC47D81DB0154E71F221838B9D8B96012455085F9C2CA328417574D13E0EC599C2F18B01F3657D3036D580D64406335226BBD917B7F7D5F26F8D07615D50DA7B993E1B652813A99"));

        verticalLayers[3] = new LedgerProofNode("V".toCharArray(),
                Utility.hexToBytes("18A480E67D28718FD25B5C8835EEC67A839109D67EDAFB7ABA68C59543958E95D9B675B3891BAE33F745E9850ED63AEDD7D0AC2A734425E71A20B57D2863BEB8EDAFB723BE2A802AF3303A52D8FEEE9295C1F54389AEDCA98CB128FAC9BB5EA1CF2777F3D2B76AA30D878F194840CB9558FF5AB3056C45F467BBB3580943F7AE2E0CE4AF262373D40C35DD18E7B9BD74B70F8333A9BD4D298AE6AA9C566F27F56533016F4F3E73779D4B9C1D3FDA3247D76347E93730060794B34A5A838B605B"),
                Utility.hexToBytes("CE212CEA7DD2F0894530A923EB63709880E21E965AAF91B85D7F2FC74C75737D28DCC98B1A9A386BE5324B8B3F5D95C1DB676FAA9728CAA021F8516055FDA3725E70FAC9AD75D9A16D065187A6534C0301CEE3453B835B9A6300CE9345714CFAD6FDED82B80C2DA3E01CE1B71ED3CB783292C32F70B971D635E38974F4D7FE460250EE306CF109D7F43084529878B19CE2319BC4AD25F8ACDD18D253C1DC9709F81F5AFDA5202224876B5E7FA53B28ACAB9213B10128F2491239890337E2673FFEBCA3E47C1145025CC0F02366848D365C048C34A13034E98E877A1B0E3EAF8752EC91AB22118DA126567F21BC5FEC0EA8D2447EBB1E4253782F9279F66BD7733E80BDC1CD638C68AFDCA9B5C68E36623C239B4FC4FBDCF65F15AAB2B199BAC9A7515F86DA3CBCDF50865A21E26EB0C21D76A86FB31D523EA2965071BFE23E071F36EAE4DFD6F3A2532519637C5BB50F8BD4C837FBB5DB7B8229A2C482A1686B07C1A81174908E056E8FCFDF38467436B145B862FEEC363B12BD3BCE141BF8B9E5925A4B30AD8D32634FA9C87D18193AE5A79B6F39D2577DA200704240644E280CBD3B7C3893B2A06199CE438EAC494BCF728B470C941F070527B445B7FD0CFEB5AE6408FDA41CDB143DB0027479762D00334D89A28649555DFD16BCA3E42B71BFD44AE6671A26E55E315A90841B86019BA8C3DDF245F62657F756EEC4B47D9EAC7026973590961E56502DB75379792CF6E742D6E3CE4C647A16D1B776446C62CA191EBAFD44FF99434A2D42195AC5549C89C94162ED1CBB52BCE705317C80A7616BDD2D27C1D851A8E876DD4EDC1EF0197478257EB71D36694029ECB8D0BDD342914F46CC60018A9E69C2A46BECAD61F1559117C598640AC2856CF7B7FB27FD6D4EF43B00419EB0795ACA392CBDFA1DAAF8A9A3AEF2CE77D3B011D3C24A5B8C16802EFE031220208CCBE09E1E804A97C20DFA93C8B4C8A39A3134861EBD746433D96E1A72B9D445A8537ADD5D5CD6E900F8A1DD30F7AD923AF6EE19BF2722CB654C0B0DB45B5BE511B3A581449F48029DE1D35D69339C2A399547CEA7B6E662A234AC73FCCA727264E692DD7CA91FD65C8926C7216D4DEF81BA56D844BE9D2FA075105D7FFA6A17B5928A1DF85EC4274F7568F175071AA937B43342BB9C9FD24A63B5DD40F345C2F6AE71EE46B6FE0223A78E9FAD980CA419F4C2A6F1AAAF1B31A1797E4C0C609230D175B42BE1FEE288E10D89A8A0E52A62A7028220E441A1A176C9BCB0493A165A05CA7FFD79DACE5BBCDD1D7DDFDD5EC7C275DF719757667C030FD91DB2411EAC608E5EAA4A365ACA60676DBD2E9B01E74596097FF5F3028B73614F9DAC4E392D70A66FBD30C2A29BA78FFDAE8B2EAFBA2B03D80F44ABF3D798A30E5A984AA774E020456C573B2561DCC121C773CFF0ACE5A9890FCC5C2492802128EA89ECAE0CEE61C99D859A1C2FDD9F511C82027C79BF12AE29D03E025906CA4B8E45D2258B49EBE3508383DE60FB6348B14347E0E13F9455D743EE1F7E1107B2B47BC016753A678723341EE596E66346CF2B1555BA7148E10598E400DB1A887E3104833449AD5A599CF6BC611B1301111995DE845A0B63F1F5F5CD28D37A90C27A71A67B27F4B049BE45BBA164AD7767ED0753AA98741FC3E40974D515510ADAE85CE2A3A0F122754F331EB3DDC885B4A420C270AE0E3C63D361A9529EAC4E1CD950CACC4E8E0A63EB4679C9D3BDDCD74DCE852DD5226F26E015A19EA8FB4E54C654B583A3FB093B2B2020CED4F20217C3DA2D0EE8787097B21B89AC26352E0AD9494A16D230C5EF7F082057A747C9BE6279B615AC517454948138D5151FE89D5373E8123470AB1D68AADCEFB885F4AADF9DF53E03E4F5FF3594D5969DE6CD7A7F70E43240A81FF128B003A6D46433FB0CE74BFE22AC6FDB33406EC4D5DEE6953F29402D076757A021E6EABC83AE73CA5B03444235B7B7BBFCE35152D49DDE9DC0FDA5FFD48DA113C6683415E96ED0705A25B51720F13682223091AFEA2CFC00B495A595A5C167C965C7C1D0BA16AC2F22EB6D6AEC1D1E6EBB5BF234C48402E5D0D5E2020CBDFE0185FDC661ACB1A9DF38320D52B26135C06248EB6B930AA5B34745CD9D27111DFD153E6531585F632C2048863D58E3C87BC736F002B21C2124776F8410B5236FFACE73453E423C0C5B00336C875E444FEA2A4B706731D0E1B3FF7975E2AAF3988ED2D6A1BE32D6F2BBC2ED9C07F31CA57D15B9666FE06C69AD67C190D363A640B813086C0A7796C25008B269A1B3530D4B2143F5A1"));

        String address = "V7kss89YAAwpLb2znCVt3RAnG8UR7H";

        LedgerProofOfExistence proofOfExistence = new LedgerProofOfExistence(verticalLayers);

        Assert.assertArrayEquals(proofOfExistence.getLedgerHash(), Utility.hexToBytes("806013B302BE45009DC09223AE252A66B917E0F7648B2D1A"));

        Assert.assertEquals(proofOfExistence.getAddress(), address);
    }

    @Test
    public void existenceProof_5() {
        // This proof proves that the address V2ZTYvStyEr1drKJuhRDUAjiWHrQ7d does exist in the RHT identified by
        // 912703605340B1AED1F430C38C8DBF9D2F1021F244CF9EAF by proving that after routing V, 2, Z, T, Y through the
        // tree, a child which completes the address's route (vStyEr1drKJuhRDUAjiWHrQ7d) exists.
        // This proof is pulled from a tree with 1000000 addresses in it.
        LedgerProofNode[] verticalLayers = new LedgerProofNode[6];

        verticalLayers[0] = new LedgerProofNode("vStyEr1drKJuhRDUAjiWHrQ7d".toCharArray(),
                new LedgerValue(3797198, 0, 0));

        verticalLayers[1] = new LedgerProofNode("Y".toCharArray(),
                Utility.hexToBytes("B00409F8708B14E23F704076B1839462ADC154AF4A924E4E0D12CA12A3E07887"),
                Utility.hexToBytes(""));

        verticalLayers[2] = new LedgerProofNode("T".toCharArray(),
                Utility.hexToBytes("544CA7117FA75A807DA0971F071DFBBB77C8CB1638767623AF4A1AEE502AB56050B125791C413346F956C88C264C4023F066E2D731C6287270D0CD0E1CC0EF9244B8D16CF9371B9FB6238D375834C139B1FFE88D7A8DDDC3D9A89B6DEFFAADF0A30125EE59DDD79B77A3A9FD7ED2F54D59A20D31B9BEE9FC34FE85B136A21067A0634E8A682F0B793FE2A545A5DF2B53D654C5ABBE50E7736ABEEC5999147FDB2C2425C5D2ED74ED03F4D327AEEC73EDCDC5FA32257C430F2CA5D955F866C8AF835456E068A7A81FB8450B54E986CAAAFF5A2697A2A4465C83000D0E5EB4F4FE7B2D433C20427B474722302A00D9822A17A27A4EDDC379467921BEB119FCF7DC3D1EACA9EEA4431352AB1B93C66B1AFBAE2943C3707FC4E784298D1E6E654E1BCAA93B5230B418F88531FCFC2C6E17D4F2C23A4EBA74A9E3EEE74E49D4AF2095"),
                Utility.hexToBytes("376729CFCF2EA3B827DE324C5850693A758B8048DFEC79EA46D240E9ECEE52910F020067654BC91B5EFA42CFBDB063672C3FAAD4520F293CE7064207B5AFAF91A47E2D0459469AF87B7F00573B7BAA489037F24C923CA725F3CADE51DEA23BBB3A121D65EA0E6D54ACB8FFFB1A0C4A5BB49A1C4B25BA439E982C00AAE249DD70B1F73E8515CC7BC78DDC0F3BFE20E8C3986C057B6833D3CC7778E57944328BEEC9219DE7143D9701AA901809E6F42985B1CCA08841BB26D09D528E1798C9D259EDF6F933B219B5AC8A785C5D4F6C57B8FCBC20F11CED5C7FCA7CE616AE2A93FF98CB1424CE4B36116AAF51484CB86D0E8EB0CEB699934786FABBBD2B0BFABEBD"));

        verticalLayers[3] = new LedgerProofNode("Z".toCharArray(),
                Utility.hexToBytes("905E4B856016640870187E83BF8E059C23A5BD95B278533F3A1892AECE0F0534141C032C0C871C7520A17B1B911B67F157B3DCD4C0A0D0F9073E0051C7EC419180134C0DF3F0BA56A6DCC82144A1238429622D3D6B213723977CA484879E0B296039D3F9D73477E6E8359D0A72342CC24433DB251576C93EB6B73BD205BCE8CC2890C994617D1987819488BDE25788113DA552D760155A0AB838C3228D17C72C6A8E5767677F39E8B2192CC5B366A96DF422828015A3C46E0DE89B74255D4D2DA58BB70BCE78E35A23D017F7D9513B7EF4C022B4A2365093C1B9056877E62C24D699DA97ECE397A9A904D3210AB3F087BAB9DF5462DBD72C82523E3444CAF55F844B899CDA486943FC8A1DF3C519F6EEB1B2862595C7C205973BEC8139A48D32DB785FC38B40989332B4A6E46ACA4A8D8DC117541F4E356277F911DD7B63D58883C0F965929A85251B2858A5B7F2272D8A517BBCA4C5719E321FE7C20DE78DEFC5C0A40FED3E74C89F27F634D229B954CD18F7F5805BF9EEDE58C628758C851B396DC006077B5B6E38A8F0868B48385141DB8F61E3E25EDD0A8DD7A0DB4755A6E353D15F8EBF7F977DDBF4B935B8ADB024E48C6511C4236C5C06EF443B5F5EFF1442B6E7B795F5AE3EC9EF1AB3AB50E793097784E7EFAD7D7664B520B5253681278E148E0E2A71F923EF0C91F755F90D77A52AA2D371A40745BA2BE6258CC5435C06F8306EBDC64C6723C0DC3EA367B02AFEC11D40A21073DD3A52F2A539F76185C6E027D79CEC175D54D22DE7398BE2ABF4C8038809537F16DBA24F7CC2828A0B3F3049061B8B403CAEBB39B97CE703A8BFF63B566CC2BAE6A0D4CF2BB446C8F3C556FB7F4D1531365CAD32433AFFBBC7B5FEBC5917833418069914ADC0E51F1E4C0CA07E942C3830DCD0F670FCCBE4A62A2D8CB7D8756AE684C132C7B602160B932FD82FE6BD98F566120560DF3EB68D5771A593A9C6AD26AA51F8D843EA33B5022E3397E50A92F3E931A503FB7B707D2F8EBDFF767F1316C799FACE852EC65C96646F2BE2D490F4E58D060D149B61B5E029DF881B77C57347568178ED8929BA88B9399CEF8D9F36106E7B62A3923A3CD9A737C4E35CEF6FBD586ACE7CC3D0B97F9B1638335DFB8F7BB81D96AD2A2F27B19EA408EF3C6FEC19BDE6924D7089"),
                Utility.hexToBytes("022A3048DB6CB8BF536CEB7AA67CD223038807D89F1569CD295C8A58F7BF9F634A6908C6604306822768C0E22FCCBF4B9154B6BF16F539180E2672F0DC39C5384C736D53ACBC8188189FF7959B1F6FB205DEA2F5ACD122CFBBA76862135676DAF40AB77165B050C6D055E9B5B15E20CD63A29B20D939D37C635A70B7F77F338048F72A92462DEC9C024319CAFC85ED3987F0F3D1D1BC059F0DF3C5F5A981C7269408D1B8DEE16D193EF0F3FF2C6E2F1B2FB94F831F3A4ECF3B990AC4B17F18E9E56FB973BF2C0F7F54512DB47525D3A4B8A454D907A6E4CA68FC2C2D76130C9ABAF184A2E69132C6CAB28F5100508547ECA6671B2EFB99EF2A56507D6CBC9E1C6EEC04250FA7C23901D06509CC125CA6B9748663343F3CF84641ACCC1CD8033122047FA4609358400B667E5421B8918999670CA4189D206B552765D97082073D6F23FE54F0D2596360805B6CDD7A90A12F9FF45BACE251452A84691A1B6920BFE176B2892A88FDA8281C7D460BB9268DEE5C2056972445A66C19145871D07E6F3ED5CB43467E1215239B24249CA7270705ADD959CDDDB743E247483609DBC50B36D8F413DFDC2FFF8A4E488C827719EF191525C1AB968223B79A9F4AF48BB513262D3CC706B9B70C94007652D424321EFBDF69D9C829959B638869F28605C8EF3A3BFC1335F7292402535BEB3792EAA28F299444891CEA33F9ED6EDF49FF7C3ADF938C341E67C9E2D31F697DC99953822A46EB49425C4DC7AAFE91B3CE8A67B512145E62453548D643E1FE077973E35DBFDF53C720E187C28DDC5A0178670D34AF6B7AA977AFFEC76F8D2627B29E8796786727548217BD2797E48C0CE5CB9E8DBBBF27732646A9F79C2A42B86842F04CFA0ED87715210E0859C291B55E76AE997A43D517573D7AFA1CACEEFA36F528FD7139ED55077DBBACBDF068BE7094E0C864F8C51AC30ED42BEEF1D536ED2A4F304F9C72252AD1B9C1C565425B32E3F39F822C590C93B6EF567CD55E098103992D95612A64276DC8FD98746F4BAE426CA4BD8768748AE5F30279491CF16134A7E8C5D3313C307B8D3103E2E0756ABD9FA000E8D036527388DA9526B51201661BDBB5CD7B532593A1AE09B9B82AB0BF4FC7B71B00056C690CDAB2559B1EFDB1E3A75182ED06CA24727A8B055695FAE97AAE39410B45870BF462B1856B51F71E1EB013F25590D525FCAD31B7F4F7E940BA1CCAA7E1E7DDF5A2069D131EE2DC712F1E27BD04C2AC423C3031A0DF35F49FD00055823842E2C78139FEC956E56DE2ED5098AF82C343B3FAF0E1B6F1606752BD6C7E415BD00E6E0AE1E468C21C9B21F4AABE78A9F85727B81CC0A2AD110258E81B80B13F2AE2DE388BF6B1513FA24239F128F4D99F579F894E70BBE30AD009D90D"));

        verticalLayers[4] = new LedgerProofNode("2".toCharArray(),
                Utility.hexToBytes("98EC46D10AA466288348975BB2FFEBEFD1D862641A3088FF27093B9A92E580802BD54CADB4560353B76EDF18C79741195EEF3D55F2046E1191862E007C1CCEF6C684B9B5D60CE2B8A38D62EF7CA29F40AD019003F0B8A0C41BD771DF1FBF7C9CC4DF043733383C1BCB99E7E1A1D07806875BBC6DF0896E23C2B98D5A420014F440BA12C826A2ECE2949CF6BAABBEFDE0C509DBD0BC69BCFBF9B47444E597D1796066C83BEC2A694BB7DD494F994B198E9FB26AAE5A4D1FD5EA2A6C7677123509E551747FD0198873A31CA4A0A7D6B74BBCBFD1D0432EFF0CE6BA81C71E6A41C0D7A0A69CB3C04780068434D03ABBE84062CD39BC65A002FE0852B229541B96D8E171EEDCE59604DF2955985F7264655C313E10F7FA6BB41E29A66040A6DCBDC77183C934B70A623620E22261F1E1A8DC26CE2C079A8581088FC93FFEBDE2C132D695477EDFF94255A34C04C9F45C0E2DAB0CC4B402C4F6AB8FE9A592CBA1C4E05F81EE81212705C76EE1B15CBD3809A882D771FBA6F83E483DEA05DF8ED3F444854F24454788E10C26B88885713C10017E3D22C122745C82BC685E810074EEF69162943476518D7AF7EB51AF75E458EC4165FF50C130C3E6B8ADD7C503AB2213DC005A273F967FD90A3881A94B292C8F26A3F1E4B5DEE9C6744C80CCBF768E3F676833B2F866BF61CDC8E8650C9F52B99A61BDF2C35166A62D92AB18EE8043DE715F85DE719306A57DC1C47FFC4AF5076677E5B8D9966FA5EBFB7391051DB20D66E692BC6C2F4323A5A1358BF3BF72FB8ED0EC261B7A12CC380D2BF34395874EDEA5B48926F514A1596E11E2C22F56BE80E84AA2AFDF75BA56EB446D09862545AE3111CD26DC7C269871FFD9ACB278EF47B50D3FE65738A0111634D565FAD17EFEB723C7F20DEDED9CF3EC13064EE06B35306C09305FD6B6B4821915ED46C749A20877579FA49D1C819F9C34FE3BB8119C2ED1C9D4F1FEB7D21490EE11E95F97CD8ACA9993F46ABDA4EEC7110ACC7EC3C79CC6FB4FDE81F9F61EEE059A766B446F67CDACF181158EE39B84EDE45519A005A8AB0B16D4658BB3BEF711F5746C3E9FD7FC915AB8CB5A36064C40FE2B961E62A0693EDA340F488908D97937D9CB0B749CED28202E45C29F160B7BE1EFBC677625C87665D8AC5DE11ADA8F853D82A75A83266FFCACFE8F24A664169E08D8FDF74A7A4595AAAAF6E914988953E7279336712C01C646BCCD434B2F920F9F29EB0E9C83A15384C9CE7E6CED05EA28F9273F807D74BEB52CFA108BF313197FD4CBC321205C9F36CBC14B8194ABC24F1B91C54D4BFDF5C941D238B73BE46693F1324C3C9D2BC79BE1083D7C3C9EA338D4842F738422E704EFBD325244824DAD8BECE643D0F886EEA8EBC017FF50D292C965C14D07971B0BD377E21CD6047BF93647D7947EDDF0417AA31BDCA5BA3190B798"),
                Utility.hexToBytes("0906E4ECE10DC7A12F8AD7A79BA482D38D8013D73BF439A9849F7D3071E42EC757B247C8420BAC3B563F1AF1A6EE7259EE2D9C39F5E097DD5B7BFD184E04397B4747E0DC2C2BF8032BCB4A6ADC37FE31CEB6444DB51378C3DC66F398B91A1D13CF50815A3AF91B33C51B6248DFBCFD66F889F6743D069BEBB161F4D6D5734A75D737EE627BA5BF487E84D3F094F69247270140A3C2F947DA935FEC7AB716AB4393FF48987854EE73BBE9F4D7BCE9B50DC9C021F8BFF4BDA741C6AD5AC516668861DAD2ED6EE0F9A7FC37C4A17DFE8B31498975C14FFA3DDB68A43E1D2E15DEDC2BAF3A4C4754C7FF69D22B7D538F2A1D4547B6EFD7A19A56502979DE7259EB88D393AB7ED7A5CC65D182D1C379BF1B5865494A160DE6361D592B28BC281695BC1AABB81668F80BFAF56C991B484BB187E630CD02B6A7ECCF9376B707B6F434DC5F5A44B0E1D0F817B9343E7714EE6AB300A14BB8FEA99BD7527EA51EEF4C3A0BBD8D32015B51812A6C900CF267196193F1F6E26CF1D474D728E1697FC863280E24845A405C17492BC6F42ED6BFE22E25AF553B9E7C249D35B4D544753A2CED005A401345AD3288537DAB5EE5972869090F48BAFA39F95415641F9668960BA920039C52AB5B16CC0C7D674CCFFC743560E697486E452C2001C162845924D4C0D3BB7488E3205FB4B0EB9891C19CACC05DC29AB81770FBEECF37FA2227EF91F276B20EF5DE40835C29D315556E4DA8F045C7662437DB4FD123580BF189B2D3A878D218D65053F2440ACA944BD517F86A469F93A85FA72F94330F6E6E5773EABFC49E3BCA880FA45E1C4C7C26F2132D703F866C92918FA35172B91008AE625B79A267E00BB8EBE25DD23E159F8E1148766DE518545312182CBBA6CE3B63BC63B018B613FD39DD15F1E5BCB7EEC58879ACAFA58A142A5472AAD8C1D844D209A60A995EE8FC5F2DC0DC230F2D6B0620559AA2AC62CA001DA7472B9098982FAD0280DEBAF7536F4C1A96A2DD10A0DDF97526FB4C7F1B13D29F7B29794AEF784DD9C4C08BAF3C82C8D245006F82FCD93C94A60810975C3BC720B2B010640B9BF4B69E3889BE17B4A862256FD7C81100DD189B54945D0BFB01B23138AEF225822D1BD98C"));

        verticalLayers[5] = new LedgerProofNode("V".toCharArray(),
                Utility.hexToBytes("767083A9B847CB3994D674D0C6EA95C5574F55C6A1CAB6EA506CE9BF19EF71E5"),
                Utility.hexToBytes("D8963CC16D6ECC584C2C858F17E78608898E00D4D9D23049232EF3899C879C6E3FC80E2CF536B9B54BF98040697022E72BA2432981C2F6F0DB4A96B24316D179C0CBA514942B848DD5B2360CD90821DE355DF584B8FC39C9CDCE20A3184A8B9E1371696C1404AB63D20C852166B9F0AC38EA4A0EED4834D6FBBF24525CB0209DB332FA6220BC3CC18252779C2A382A75B4EECA209A8502040AC8D2A06FF81437CF4DDDA97355C2D164B0B13EDD8A2299F72E14B0C3AD11BB3760ED6FACFD47B874CD51C6C21EAE527EBD70871D16F654C8A7D5230630B508B30C87C34C8E57FBC6940AFEDDD4E7C73A74A172C1CA3BDB9857E48BAA5A0EE3BAC392D40C44584D4F0311B691DB23D370B415EB78CE0F1B71DB327217F258E0D53D686C8D30EFA2197C3052C6373E5DEF5FBCF8BE684309CB6376981AAB74F68A4B2CF7F340285D2D8BF5AD37337F77C7ED24CC51F351E155454081203A9B3936D6C93EC91AE316FCBFF55BEA0A3A009979A8D214326F7C079AA4C96C389B24FAF4418C7E6A6F97EAB11963005151DF21C02CB9397053612D0EF816C2F26CF32850941A10CE2B4EE93F6C3C581EDFC99237A285718D5573C8A40C4BA1AB02EFE6951ABD8F25BCB553C8BA40CFB0B65B3AAD75670B64E93305677CC6019F9269DD4EFBEBE495AC09ECD484208BAA744689E12600C6EF863881B740DE259D82CD86765BDBC97CDCC7388B22810C460B7AE486DFCD5E7B6805F7DE036FF2F56295E9653FE2BA7FFEE9855D6FB3F0CBABEF7A1F4C2A52001F47E7DC0602E622A632F8F5820256BFCDD20E739F144C4AC07E6F1B4D42309A11E445F97870F1A22B8E2CA332C93E40295278227970977E5E7088D1D1B5705B5F2844A26ABF9A506D6045E42668613C7976775714D6CDB79C32C975B7A160722E642A25848911DBC8450256E63C15B3061DD39509FDC865EE6DE1D46A6EFDA4CFCA515D407F6FBD918FB746582D5B54E947BA27E1D5CF9032DC3150C08E44DDA2A6366A9A449FCCDF0E4E91B0A81C666CF10AE33B23EC2E36CA2B421B605AA63AECE683E8CD08EA58ABDED3308B55143FEA2F18050581BB01843F5290FE8E7466892950E9F8084A25BA9AB4C5F463E442B6DCCFF76CA36783484AB9EBDF388F4330B70E1D496D080447673FB484C042A93A404215991649657FB944D094AB6F0F579DEE9C78B56A89EB611668BAD076882C64A2E094E7DD4549DC0504AD15A7F4F7F011C8ED88916B0D3CE96DDF0F14E996D4E115B5A6001EF1B96B1FBBFEB212BD054CB2EFAD080AA261F9E7D3B4F780DF80F4CD9385795510C8FFDAA04B81FC8A6D63843E850CBEA035FC55CF206B3C3CE0840C9EF06F5B8112D3FB7A61581F6CE0DDF5D4F5FD37C93C33A8EF0D1C498F1238680FAABC0642B926AEC9FCA020F6A9EBFB11FED686F91E8C5BA767FF322122B727E981A63C284E8C0916CB5E6B264E15D6955B7B3B205DA42B1D3B720F20B5DF54E352CBF858985A4B95F3CE2F64014E50B9AB903BB4D665AB9826FCE0BFF7FFF3D19555733637135124ABCF178F5A671E43DF4ADAFABFA11578B82A7428683D24B51A98ECBF20A35DF5D6C796D8E305F0B6CEF988660A12AB0A8532FA76AD4C284CE7636375DD68B696031776389A520E81E8C0193A29CA5A2D4E4D0DD8C72999DF5E166412B0D363718C9260D29D276E56C8BC95914735C4F5C70E97657DDBAEDA13EBDE6D8D0FC51470C3F337B7218CC490F661BB7B47CFAC9C4587706CB1A711E389FACD5013EA7B7315AABB897F661C2195BF2630A6840007A8CE4C82231337F1909DB45BBB2F7950DC8640A7535FBD3176F9B15314269885881BDE8CC0506D274035EFEBAD6706D78A32B3F40374B80B1772A3C7CC404B950602FE83D8D72911AB1556BBC0EB564CD762941CD303E71D2E6EE8C648B66F5337A58F577DE980BC76DF5A9522C5BC40D1446BA14046CBD2F5B0A7FCDCF19116276556FD8C3786B7100C90D615A817C7DF58988C6BFBD6D36250C2A26DB4B1DD72B1F2368B36409FCCD28A1EF18FC970EBE7C5C9B404D09FA3AEC7666AD012B07B29B7A6635CAE1609F5065DA963AE56B8FAC5DB4CDCF0526A9C7B49F4A7B4D5B8E6791912D91E5484CFEB4857FDBBFD4C7A19D0ECABE030E133F384B14BE2D2B2042590E0AC7BBB5F2937022317DDF6F0508206B586069EED18689B6ACCF75CBAEF3F19DFE0E69686FF4F14079A27CDD021CB741EA8E5C535094815762DF45E90D618F269BECA1E04E7C3F3D40344A801C4EE5EBC139EF15C4A1E04B4ECD3862CC241088416F58A925F4F3653C305111D6E0B6C18727860E3AC323A6DD5053D46076DC6EE6893B6ECECAA1A1F362DF6077930F3F5E9E9EBF6757A7C8B6911E746D51E27E4FF9D1D0A47F657A6C936212FEDD6009E46D9A0993345337B26AE42FA69B597E3A0849E116921842CC05C81BE62398DDCB6D71E05B54084D48E1D6E09E810F8D4D11A918822AFB7EF2C5EB22242964323F81F7CAE9040B93E506323096A9F"));

        String address = "V2ZTYvStyEr1drKJuhRDUAjiWHrQ7d";

        LedgerProofOfExistence proofOfExistence = new LedgerProofOfExistence(verticalLayers);

        Assert.assertArrayEquals(proofOfExistence.getLedgerHash(), Utility.hexToBytes("912703605340B1AED1F430C38C8DBF9D2F1021F244CF9EAF"));

        Assert.assertEquals(proofOfExistence.getAddress(), address);
    }

    @Test
    public void existenceProof_6() {
        // This proof proves that the address V4RWhzTJpNfaJuDNSv4odp1ikEm8hb does exist in the RHT identified by
        // 29302920416723E3FACA5E1073A971C3BE5020242CD75F93 by proving that after routing V, 4, R, W, h through the
        // tree, a child which completes the address's route (zTJpNfaJuDNSv4odp1ikEm8hb) exists.
        // This proof is pulled from a tree with 10000000 addresses in it.
        LedgerProofNode[] verticalLayers = new LedgerProofNode[6];

        verticalLayers[0] = new LedgerProofNode("zTJpNfaJuDNSv4odp1ikEm8hb".toCharArray(),
                new LedgerValue(8197459, 0, 0));

        verticalLayers[1] = new LedgerProofNode("h".toCharArray(),
                Utility.hexToBytes("AD5D0ADF7658CCB986FCC9950BB291C2D50A6767B3E9D921F28CC581F4C57E955195A964BE0B957350455F270532FBBB77B2D8B500CCB58A6495AD197ED090488D67FA5653F4820C94F1E465BBC7D1DA24CFAB7D37CDEAF6D494F3D544DAA3F9"),
                Utility.hexToBytes(""));

        verticalLayers[2] = new LedgerProofNode("W".toCharArray(),
                Utility.hexToBytes("48D6A943B064B29FFBF3CA1C9B83496A77E61DDD4FE16EA93EB4A96EFAEF783CE8BD1A821D170DAA8E8FAF3919939D5053BBF48C422ABAD7104688DFF6BF61FE211B3AB1423D7B5422C3DC80D16A1A7D0B04405C44B89C9723C17D1863F2CD86F0261B73E3CFA1332C03FDB9BF0ED3A784F3F89BD463F93E89FFC0B4423B586B1266A82C60D377C48EB1DE8E3852A2D8CB22A7EA0439311BD58B1A21D84E841B61449FBAB9A3FEDD1E1D86D60A1D8F5D255CC61ED489915E7FF34533BD524001C6AEA1E5AAD2664DFEEEFF0882E3B02322D0683AC5FEDF2B2FB13DF7BEDC603407C633280B681A687B85C1B73FFC4E29CF19FA172AD1A6E656F9682D737C50831830B130FAEF37575220263FA6AACA2678CCB395C3C28BE6582FC9982C398C39259220F67E1A979B226F492732B4169AD23E2CED0EE506C027B65822B378479C3A47567DF3B02AA2BE9D6D5016245379A92728ED76908F074D2A365AAB55AD1FE6112F107F1AF42F31CD79A066937E240EE1E93D77010095D7ADF4F20DDD55DC957DC5FA579300A6CCC58DE32D42B11B4E0C5010260689F951946ACCACA31EF5B50EFFACEE6D29DAD4F5C081224CC40D1FE17A209F0F463ABF268F3053532284FBBDB8DB17886E95CDDB943A591A6AC148225DFAFB0AEFAD7B615AFDA7AD671B54DD5F5F57A9750A9F951BC7CBAF573D40D4E4AEF389A9CEF7DBDF279D91901771197FC7E079F7F5C3A99C2651C52776734809B2CE7C7D4C3A2FEFA55A1C4AD8212537E7A55FD16FA95D4002C815FF17173EB434E2F2E74A501C8ABA33FCD11281939E814DFC89561712D572EC41F248A52A40DCCE1611AB4C9D7151A822BD3AAD0EB819468D0C8CEC67587B4249985BB17ECD335343EC0D784666F3140697B07EF48A53B21D85C52574893C6370E426DBF8C9409723795D945B09073B72FA2CBBD34CC6C8520C39F56CDF367A7665166E3D0111C1F55B72126F6E5B2A185BE29C9D371D4868D410833D7DA53AFDCC1031E03DCB0A068AA97F1B8664C7EF77F8167583ED65F9CCCB6BDF490A766F636CCFD9A0DF79FC83162F26112D01856C04FFBBF38686FE4F9CD654F5BC213F0F9A8C3C66C442B1226E937121B2068586181E5BB44EB2681FD9CE1567984F495934C49DAA5C09F0EC12F8087E2DE700083030994ED222CFFB8DD98073D7A3114D85F45D30D2CF7D17833D68AE2FC0EE5DAF18D0C803372463A97A7785A1780F63276F993A836672239B8FDDDBA40E5A2F114A3921B5779E1D61CAFDA178EC0BB84D57E84AAF870BA472DFB80309F56648F5C97E028D93AA65EAC7462E98C19AFE945D2F04B69E99D99B92B71158B8E7C6233C8846BB6C8496E2733974E2D60ED8C0126014F177B7EA507C15E54F0D3E545747F8A2BB2369AF88873E18D4D3C04746979272EE5E75F4CF204DD79223507DBF5FDF69D92691165E0B88DD19656CEC9B4032ABFDF0797352D214D429A81DBA3767E0952FCDC4802D286259411DA1C3EEBE78F5DF19D47FD7741356525795F20CC5B6651E78D2EC1FC219C4DF81A9E68504B49BD01BAA40B339CC3F7EFF7C79AE8BB56A0200782D6085A147D0057802F35A9456C65DBB7C8BBC95D2C0172E1EA639E46FEA01E56C595D12F661F7447D6DF6A7E67C5AFA120E4ABB1EC0800B50DD3BD3C9C9110E7791C46A8FFA160720DDB5F1CC2BE1B74B686DB3C07327CC4AADD72B9B2B1EFEC911940B0F2F5A25C57B03797B506551D58FB05B89A42448E363"),
                Utility.hexToBytes("B36CF99E8B4633A74A20CDABE2CA3D9EE8D76A6828DF90F039644332AC1D756BD30662D17641DC01075FFF3EB54892AC643CA69391217688F23583F723C35B83F621567A345D62FAC8D859F3D1E88E23ABE7CDE2D038886EC875A8031EEB2C615511BBA1A7100C04E1BCB24AB8BA6D03C2480B6FF6F4547AFBE69C293D6503C142D24FB5D4711DED58936CD425BBB239EFC3454841AE8C33F7EEA99B3E4EB9C031BBB31ED02ABC6B4EA3017F950E5910CE87D93484EAF05BBAF4A9976CFABF0C3DA49100C81F5C6A9A8A7935D317EE11C49D3BFACA35C75BCBF50D9BAC79AF2E516095A2F9E2C69A2EAB774C0F4E80989C657377E3561413067A8EBDD7B3C84D56F86CDAF3EF88C85C91B2CD5E1E4EB8B3D9AAEF7E5C010F1B5A0B93EDF84579F4EC6470BF9857B7905943E11117EAAA86EDAC9828E4B6BF7759BA294A50D51EF70EA4E486CF9FA5744B9D4AE1419EB2AC0FA18A1335D04BC83F5165C118CEB3262D69F72108C0E17D7FB82C53E47831A567FA3B34C99833717840426D5BA03E3920618726B0017B96AE5BA66B0D7712AA7E8637B64E2D0E36CD9CF8AC8EA8DECB935FF44418A5337AA048EEA387A6942F9CB0DBB164DB353F5052E1A574B54656080EE6D569070BFCB5F66EE1EBABCB442B121D7A7E8A43490D0D0FDEC8050E"));

        verticalLayers[3] = new LedgerProofNode("R".toCharArray(),
                Utility.hexToBytes("91612C962B82447233BE839957E823BF8C030C74154D961436E693C3E045B4B5A1257E0CA7429A437CA1B44A0ABCDA08F53C4DF970C6AAA44ECD491DD7BA1C632D60F0D897105954A499E64B6450D86A2B4B2F61713E4DDAC2289A24FF4A902F88B281758334AE6886CB2EB19F236ED6EF20E9598DBE318C1D45310EF903EA3AB18E0B41259D9F71F5390D6C8F4FB88A772589B5624523614A7A59A9FA54EDD6823745E565EA81BC43640AF0B7BA85A6A01EC4F14CE24D4B8AF1385F477E5BC12BC9C4F282256D8709AAABEB0ED85CF11FA763B29AEA983E72FEDFB8F88E9B0C51070F1C4A575661231E786A807F4C868AAC17FE9325D31AEDBFEEC4D74CD45172EDB91589727E1F65DE4D8D79EC3DDD4EE6A6C912E09FF2D675FF73CC1ABD23F83232DDA53C032063877D9E338FBD3A7EBD0ABAF87BB17EEA0CCA86D276527817AD395499A6A7A52DE27881B48232005A7FE0578FB208A6E3272C19D11D714EA0472D31567C823812988E432692A5E157DC689FD4F0F3234795FA0DED441947772F1A429655308387BD04D8AB3C1AFE96C7611E1953D7EB11A1626ED6DCF574028D7AFA1B4C57EE2B592116E6205FE02828A3C05FFABE7D1C9FCA8DB391FC8D1CEB0D0833F75E687073FB166978171476168462A1F08689C6A06B89440024B80E3F94E5E5301F5A9C97A93661D4F1866E358C72AC76E39CF4DC173AAE4F7939701ABE5C244F0E6E1219A077489764F04BC5B866F796FC7C042E535147A1C5282E6A5162BB3F88C8F931DA25157B7FA750B64E1A1C42C6D3A4E00D0ABA78A4236F310D4249A0BF3A28CE5E3EC18A09FC060A47ADC106231E305E0791376970911847F892AFF4EE043CEF6CD3F3EBEAF6BC6B8F164B007F32D5DA91B132AEAD39A4F299BC9F53FE2394049C21F056078A8DF84728E2D95E6FE720DF9585EED8A66197A78E9BC2E9F24FAACB6C32184568377D10733E6B0328251DD8554F737BAD47514830D28CB0BC182A55F1DEAC163FC9D193945C7F6F1337D41DE89EA6541899D4B7991BD4A830083DB8DB51C7AEC1665AD299BCF7C10DAA5B5900694EFA9E28F909B95994F6DE8AA3720367D8E822C89C3DEACC27FFEAF2C9D2609AD9A5D8AB9F905E462D06488E82BF12BC6D1931669D502623ECCABADCBEBB5C98DAF53DD72887754B87F4457C90D652291FD49672A22F23BC726E39D4FA6F06FCA5D8A2EE004D7EB7FF6E5B1716276DF38F65CF2CA9591024FA13008007B35732097B865327836317D71AE459DD0AFB7F26FE2E39993D99D60A5A42941663AC4C57C18F"),
                Utility.hexToBytes("455A1697155847DF63B8A4C68454FFA6503F766F1EA17C727D3A612B7160D9DAD69C742A30D753ED804830A6090EC3AC70CE603A8DB6E1C88D4EE70C21B09A9E1A9E635087EAA660E52A607843433D90DD2E830B3CA9B7E9B2374956B160AB81DFCBB3784FBBFA9EAD127C367BC969A68BA28FAE678713D848BE7E9D388BBB76CD7E2A26E4355CF875E12537B78BCBDB4E6D814F1680E13F7A55F47C6004BA1AD37F4D8D39842B348E08EE10D76C27BD561BA1122971069E64A4845A0677A78EBC9D0ED2DC21EDFA3F5E084C1E8F957E952A1AD2435B8551EBA24CA31371C396FAAD8EA40FD404EF6D746406C720F1075C94567A6DEE41B3AF4FA4D685EE09359CF5E1540DF35F5CC8ABC3EAB09A36FB455C1B5520EA7A261E4C2D6C698174512FA37B92DC8C9E9032B823C8798FC9EBF6A11DD5848B1A56A8810A0F9D0FDE360127B85D852A752E610B540296CF6F39798D2FE41DB5BA7DFCBFBBDD05BAD2932A9F1E50F493AF751D506B19406D16BF5D0ED845D2C1D56F4B07132345FA88956160BA00A59406A155792AA06B4F222CB6631E8C4D9C634B041D297FB9BC2750BD8103EC18CCE48E8680FE0FE9BF357E2917C86344B003C167B4B056DA76BB1879269C8A691B120904D68007B09A000C14273605FF33E6FE15786A9FA8A998D5A98F83D63675C21AD671F76C4D37A574D2B8329C5C1A729FE9A0B22A4715DC5D299AC2DEFB40D541920CFA9F835696E23124B55DCC8454E2629324903500AC176DE9B1A91C04C6E7727733BC1FCA76A5F1149517F5DCC7D4F79F093EF09EAB5A68BAD31A6493142E2E6CED67CBB8285ECF4B568F14C879ED67751A5834AF7A4274F43D5DF3CF8C2E2409B57966370584CA0CB8C06B4618C357DA2581E9F9B4FE9F254D13C7E310AA02A63A0ED46E1CBD5E97ECEDC9CBF8995AB0B65E9AF0C5C5A0379B377D0217A901EBEBDC7F154F5216DBE362A119D7268C0668881BE11D30DCC9C02D5DB7E001D68B33C6025404F2150C841EB96798B0AF13712F85B8F313359BD4966197CCF3CEBCB072EA194E94145BA2EF290AB60E78A146247C27D33D2980987ACF7F1DE12DD219462A22E9266634359C07A4FA43F8CAE8418F4B8CC882D5C41127B3CB0B6B29BF9630EC1B32E4227EF5D5BE133C9700335153CA32C4C04EBC59D1A140F88211543CC8923B49A26A3CA6F978C6F836E68D2E3B95C745DA201278645AD6CB34AA0C15FDC173AFCBE717AADA84C5F668881D97384A83BC"));

        verticalLayers[4] = new LedgerProofNode("4".toCharArray(),
                Utility.hexToBytes("1DB521990506EC9D3E3672BC6025ADCA4015DD54CBFD224A05D3AC98949CFABFAAF02D489A15EB9E3C063D71815B56791815A1653E39A8B511EAB10CAE3E7BB61618B019323294C9504212FFC2C4180432CCA5F3302A4E66F791C4DC6804F9AC570970D150A527F1669D1A26F3E6D1608B4EE80A96C5EC517ADE1F42D04AC292D9AFB3D0BB681759E36F56DA361C3038808D3D25EA9C592C33A6141336DE3F43C72734552AF0C0B887B53DB1D13ADDA5B9F24C33BDACB6CCC59611F170C68B26A91FCB92B9291343DD8FEB0D91EBF810FF997681A71B0CF12AD5332DFA64635A7B0CBDFD751FCCFE2D50C262631B2F29B4EF66244833C19C7BD9C69E499AE55169BC87A0AC85F6FA83147CA213B1B1AD10A25B38928FB5ADA3DBAB29C64418E5D21D86A02C1B188C272A750EB342DAC8BCBDE715EDB2D5DF17E4C7AD500E7E8B90CC99CBFD4BECAE9D1A17BC596EF0B50FF1CBE75F8F0E60049452B557D54BD74518DCAC611EDC7AC928EBAF706DF82C4ED2C4EF98E70AB6C7F030BCFA0F45803A029931EFFD872AC141A382EA3BC7A87F69294512080B5824A81929178574ADB67F418856F53FFD51A28E856195890BBF731A0C9960B9D122003BC7DDDE72FECB260F4AFD60B1A2728BD099E8F1D38EFD2A6402858C2D92FF8B252ADE8F0F5FF7DF0F8D3E85B2D5238D6002713FBE5B28C8427F40A4EE6035186E3AF35E2923B328C0C4E18E08C9DC9849386089EFECADDFF29D3C9EA04DECB4DA47E4E2D7CF181CB75B6AB1F4EBF73FBD79BCDB1A980588436131763858FA8D09945DC219999518FAB178E633E8044DBC6DAC23E792B536A8A75E5782F2B865FE717E6D0645F64EE1409115C174B0CAC2CB35E1B3533B8B222D603943057A603518F7F8503CBE7EE3AD035C1C20EB302D77581F2972176C340BC5508D6631F6F8F6B952C2DBB5E4DE5155BE7E0AC20FDD78EE2D0547D90536B5836C91662703A3501AC78C4E862CD3D40F06091D6AED4671505844E1569A6A1B7A1C016017CA0C81A98D5289940E4DA86068E118FF146FCC44D4B402C9DC33751D925E600E230DCE4D327792"),
                Utility.hexToBytes("DE931A614E89D96A7A53FDA89A9DF674A4988D4072D04A1424574E1F797200987A2C53653B83D93BB51C904D4EA6C7296E2A92036CF5C0936F944E5602A902152DBE675D809969F31998A3F8EED9246533BC2C716899B1AC668C1CAFB502763BB95F3639F00C30B20746BB52A68BBD465CF780864050E4CC23C9C4FF7D12B039A9FC7A7F30D4DC6E06155AA5A3079771854E1E4F325606ED45122C6BF550E06586377A62F5D5CC3239A04886B87709EA2AD06F8261E6D12B226D501436414AAD64C4D785F1F6B285FE68F6C5C0DAA6D23DD4EC70D0C1CCC3620B353EC09B77F77F8FEB02484F10317A45BE2003B3325D18DA399DD32B87319B65ECB78D175372214016D4692F0F54B1CA9077B4EB33F5A4B63069CD809D02493EC177175E8E827F37999E461A137F54ABAC04ECD8233053CEBA912D89E39A38F16E27D73D2FC4DF9528BA957AE13DD1F4C0B5CFBB70858AFA841F46D4244920CC8DF38A521805B94F3D4DC53104D886BF94B32F2AEE513F6BFF1AE273AFCFDB0A5B41A9B856B450043069E762BD13D4294BACBEC2A608DECE267D0FA9492967985C7C950A057A97097FF7E293C8EB8C801BEC6F962B2560CC233F01458976CA4131869D54063F0CA1606F59D3A990CBBDBCF0D5D11415A773F285548F69399C7F3423439DCFE8AF0C9513F17B19674A05311393582759DA6F8FE6CE32839A2461D1125D0966DC39834C629DCBF72386CD3729BA48348375EE472045DD3051B4F39ABBD8BD66771E14BE9157C569124B929BD779102242FEE747FF0EF140714EC3FB81471830644E8F2BB7B3DEBD3855E5FC37E5198AED93BA708C18EBB738E8F8FC1AF325EBE7C01DB5104129327E4D041F199147FC42DE680BAC3C3E96BDC53005CC729B222146F06497C3F293D29C472E3D2BF78E02CF98306677A22ECB714BB2F66D422129DE1F9F2286E13413996C33DE5F0DE26206F2D72EBB74F004D3378867D6B919ACE0178C5DC2829E9040E8AD61497A330419E41BFC1F38FA6F4F2CB5C5EC6ACCB715B003736BFF1F82392D0AEE69E6E8DB7EEE05B4DC7A7DB87D65F2A680849A9749A6D27D9F33DC83A324FF5EB82B9A3931BF1950A30C9151459492A067FD81B3C61EE8FAAEA05F118EADCDBC43A22A1D789DF4AC69D28A42B927F9B191A15C5DE2E99DD57CFB448049B20FA23CFC7EEC46FF18757AA90F3C98366F0058C4CA2EFEC7D1D9C8302B3CA3210CC58365E72D7B18B335995F4821D2B15F8CD3029FC28D8D206F1C43FC245E7F428AB6205AA0B1C1613E41328956DC648E11499D5BF80DFE781672A1AB3A873E7496680CD6587D38951514E91441FDE8470A30E86E3600AFEF58D0638C76459692F20F7D68E709D6899E2C1085F143470BF52DEF2355EA22408ECA51FE4F77BCA7A155A177430A77B9349CC7800C848DFF9F8731606A636F861A1CE6E09F56981AFEC45DEA8A77BB4035607FE0DC40DBA41A3B50B49A"));

        verticalLayers[5] = new LedgerProofNode("V".toCharArray(),
                Utility.hexToBytes("8F5E14D78890B7E269E74F15ED15D7ECB011EF330B7CC3389FCA7435FBDC6C10C2AD5C26C7913F4A8053CFCE8B60AB1BFE34976D0DDA2BB68663ED74D2D139840224F47E0F6BE31EB11A28C9E33AB4769BD8B565C187B47EBD34E53C1496FB2B"),
                Utility.hexToBytes("6684F81F1EB3DB3A5EA244A1B1195E9690BA6B21FA4DCAEB7E20CFC29F953CD0B4381B6D06E54BDC6FC0A837014920F50EBE6458DE880540D26BA485927F779F81233EC6711D6001C892ED215C0A4D8EA8ADD80875C2A9D1542A780D3573E98FB98F5570B3011A43E7B6AB0913C141C479CCD5A4E901180F58398D6C70062586D7CB440AFBC8F24C68B9D863FBD3B70F53D59D7F408579C876C7FF531287CEEC9ADBAB81B677B3BEC60680909A23D7010F0B63BD3891953AD8C79F8090BDDAF171F9F6D10186390DAEBABAD1D35F4F26F4AAB46212D824E795FF487071A7D975592F59C2FF61623A3B539AD77F5560ABB6A59733E37D2F612FB57E71D74F7D89B6271930503E7EF9E7F698CF80165D29677FB74B8062E704D6E8231CA39D19A4BF4530D7AFA0A86D76CE959953E7720DA580214EDFD55BD179F0AD41270E814EA9257E55A6C2F9AA3E0B2A61DD247CA0807F61700DFC8244237924E7A99590436FEF19030F6098C68A3D8B39F420FA409C3DA2491521102D73C44902700CCF63F242BD42BE47C9B57EFA59B31FF5E163F245C8CDB7F389E4B7B7DDE12B84BD25C716B3C4D243550607439F5CC5F6FC31EDAD2F56D080740FED06E524382A62193CDC8BFAD1E3CDCFA3EFF2F2903DA1446608A52A665160CFDB72CA27D25424A5E71483DC0B194FB962783FF939BADC7C0F8025E9A1B6953A5B845FAC9B85E3C80E8A4BC3A528FA48B535390801B302A3AC7C268B25D7A012284D5DA058F5E6FA91D3F0AFD3F158E14D84EB8E89E1F27ED511BCB529FDB1E1D3520A29BF15A47216E5FFB531A5472920FF31598C15C5F46F057B4581844D71012144ABFB011B51B6BF90297D6D1C44568C3F7698B2402DB791EF708F85EB0B37FE1DE91E70EF6C1AFEAFEDF25C7A9A2060FD5F3D71053001FC760D50BDC62FCC3C3C57B287B69EF10BCED060AA9798409162E2CF8B9DDA050A8FEC2BF6BAB2C2D7B194D7A4599F73183D386FC19277B61130591A283C630AE19D57CC5C8CBA34CC5D0E85D26D1357CEE0FB695DA69D5F1D9F37B9D48907DE31D6092CE2AB2A32E7AF161C3BA41E717F0DEB6BF48ED65E6591D124E601DB537E721170F969D20A81F8699BD3C4A143B9DB5361B8E5A0033065EE136FCF1C3854C97B64B1E0D6A1351559D44E5027516ADC211C0EE21E2F5ACC9CA3E0A7311E0C72D0264DE370CABB61100F9C728ED506D3CB2883E16EEA919E80D41607573737CC33F1B14ED09F758292F89901EAB425B8B5C7BF1927B4CE6DCAF2C83560DB8A2720E1E4104445065BC5DB8C4807F53B6715994E9DF95B09BE835D74CF312DF9978C4E14BF68590B4E948845C6473BFA6C0A073507E8D9CBFE2A8626D2FDEB3022BF74F2E598810666AE2BFD0791BED238C36C5A7A22F934BA6FDCA234A4DE1FB47B5196A8C108DFC4C66F0CB316951258013663BABEF0CFCE30C91E1C7B3C16B00976CC24431DE83D83DB7C7368F9FA6DF24C951327C0007736EAC3EAA56A6C448762FAE8060D43C799E9ABEC3F292D4A78F68030B2AF7A473E84D45E3CFF0319DE24E7958B52EAED05746AC268DEFF20D37D57B553A08A976F1DEB647FCAA99AE84354AA0A6744A386F64978A3CD05ECBDE7D5281B07E65B4439C54F9EAD5A308517816691FAC30C5DB17A4C0E54DC9A112692510E11CDBE4C1B272EF9058482434A72B3E4284EA548D3DB24588B5583D6E01F10619B400070E8D771D919BD9737EBCB51D8D63DB1E77B78B971BE75AEA690EF19C4074CC00C7D05292D70ED5C90C1E81FA4CA3DC1872685AB3128F03118E0CFB222F78A51B1BB3E838E4105A878133DC08272517D1F3861ECBE4D6874F9137A56288D7894E8928D6E5196BC16806D7DF3E99DD128D67DE156FACBBF86F8ACC7D38822EACDCE61C0D0D3FD608529E1AEF3C5E41583216D6295360F36131415E628904746817E77796B9E0BFB4E90C5B11EDE42727F10AD1B8F1DE8621EC1BFD3652BB3266324B3FC494B89AE9D1B99C6C125F8E994AE26F502CE06BA9BD030957C16E82DD6EE08F2308740E8CB15B92EA34C4585AEA863249F62FD3D717F07652303E5353706971D87E763BEC59FEF983F2140FB1A78EF22A5DCF96F52E9BD57BF7D51483FF21324679854F40A116A76832864E674D93D3D292ADE3C1D218EC83E0872A635CD86ED8DEB5A5CD669F9D022B569B5054A8E347B2FDDE47C54F7928C9AEC61175D486F2B70970600C2A956DBB1AF2DEFCCE7B783F5D1CBEE7840F6C07D12EEBD7CEC97B3401B8EED12F576016AEF472FB9C53137395D1B3333D1FA1AE7EF25817A6C82E4D11BC2090170040DA5289A638547E7F6CBBF8290B60F72E4F62B45176ACF1806EEA7305FB06D55BEF796B3E11CDD2BCF365BD632DAD3CBA89EC46E990939371409ED67C6205B8C6192F1A21FF3B9EDACB4"));

        String address = "V4RWhzTJpNfaJuDNSv4odp1ikEm8hb";

        LedgerProofOfExistence proofOfExistence = new LedgerProofOfExistence(verticalLayers);

        Assert.assertArrayEquals(proofOfExistence.getLedgerHash(), Utility.hexToBytes("29302920416723E3FACA5E1073A971C3BE5020242CD75F93"));

        Assert.assertEquals(proofOfExistence.getAddress(), address);
    }

    @Test
    public void existenceProof_7() {
        // This proof proves that the address VCCCCCCCCAAAAAAAAAAAAAAAAAGuKM does exist in the RHT identified by
        // 790253715A6B9CD32D1C40D135729D877B8EB8A460AE8EE0 by proving that after routing V, C, C, C, C, C, C, C
        // through the tree, a child which completes the address's route (CAAAAAAAAAAAAAAAAAGuKM) exists.
        // This proof is pulled from a specially-crafted tree where the route VCCCCCCC is highly crowded.
        LedgerProofNode[] verticalLayers = new LedgerProofNode[9];

        verticalLayers[0] = new LedgerProofNode("CAAAAAAAAAAAAAAAAAGuKM".toCharArray(),
                new LedgerValue(100, 0, 0));

        verticalLayers[1] = new LedgerProofNode("C".toCharArray(),
                Utility.hexToBytes("038EF46F430479A936678855A65076E3B01691D73C5164E15245E808CD393CB7A38FAD5C4B87480C6BAB6568165B3E24364042BD9756F856EAF6D0E4D3A28CD7"),
                Utility.hexToBytes("F1060DC28BB382B62D6BFF09DB86129B9C987C1EB944A6D5BED45CBBC05EB99CFA3B93271A8D28CA1BA8FD5C9EC24228F6A24877A3D013E9F8512A35601A44C3"));

        verticalLayers[2] = new LedgerProofNode("C".toCharArray(),
                Utility.hexToBytes("432153776E126065FC28E5A1A2BA8A0987BDE5CB80B04FDBC20E3DDE7B19F6F48D8CE4B1F9A2056229B414BCD360913A62F434E8B81635C8909256409A477478"),
                Utility.hexToBytes("9142E7BD8A1B8AD55744FA0F4002A201AB08F0F7F26D61192C9A076270A49F1BFD18EF80199DDED2E0242D38D28952B2BC4E29855B5A8787C7D06F28606C4AF2"));

        verticalLayers[3] = new LedgerProofNode("C".toCharArray(),
                Utility.hexToBytes("30A378227B0BC0CD1ABFD353639BF4206461D040322979E33781532112FE0EC3"),
                Utility.hexToBytes(""));

        verticalLayers[4] = new LedgerProofNode("C".toCharArray(),
                Utility.hexToBytes("FBC97EA60D3B73C1A50DC1871F554E6BDD75C26DB52483A6FE79E852D5E5A699DF8AC78792576B92D446D2A3A5BDADD0990AC821697F469DE262B6CC52A8655E"),
                Utility.hexToBytes("5F0607C6037D4460B4B9E45B9A0F3E1B5CE5F10C9F83758EC3ED5CCA4AFDD9C63D95087C088FD5C9D49A765E1AE2C257CB181A86F688880B17F41B7EB0762BD0"));

        verticalLayers[5] = new LedgerProofNode("C".toCharArray(),
                Utility.hexToBytes("61B115A2300EB01294D251DB3A652A86493BE22F08EAB26C2969AA57D7BE3572"),
                Utility.hexToBytes(""));

        verticalLayers[6] = new LedgerProofNode("C".toCharArray(),
                Utility.hexToBytes("DA98C362924E8ED3D35EBEB536FC30F6E1DCC4836041A0763B409D0C78A145338FCC4E5CCDDE9187326E43EF802EE03686608EA80075E558C1585FCCE48AABCF"),
                Utility.hexToBytes("C44E22901463226A7F1589AE1F16C8737A002092A8C821A1C17AC062F74B4060CD42C1B04753D07B566CFF6053BA51DB56395AEBCE881D7663FFF93D20A7D43A"));

        verticalLayers[7] = new LedgerProofNode("C".toCharArray(),
                Utility.hexToBytes("E346280FAA244CB6A03B5EF46CC0BD26ACB83629ECD7E15CE686349326222F5B6834CA62E073FBD7BC0A8ED7D2AA991F0F9C69B6BECF4ED983999EE73E3DB6C2"),
                Utility.hexToBytes("CF675AACD8A71662B4B6EE7474A1C01FC162EB9B6F7B9A5AE146B2342E8D8FC277D10EC5AECAF587EE77B99368AA77E3F7CB75DE5B76E8ABFED64EB194427BD242AB06CF3BD8066C55E6DBE8A447AD329C1A18C74F900E8D129694320932527C"));

        verticalLayers[8] = new LedgerProofNode("V".toCharArray(),
                Utility.hexToBytes("261B09BE63B5BD5824E268FDA4C8D0A0E3083ADF00ECAFB035C495D896DD2979FD735AC272B28EC699550399C6FD248ECBE82771297CB906C455E8639F0DEA68"),
                Utility.hexToBytes("19059B8C0D35F0DEA8A92F84CD80C4D12D4EE9B707B338B87B66B6461348D3F777D115804B7B7491EB5AF45504DBCEDD9DB9A61FE32DC42B53D85C766EF82E42FC5A1E8C51F164D56782659E1FBC08C835B9D4A7A2169F2B0F3894CB6B421E9C"));

        String address = "VCCCCCCCCAAAAAAAAAAAAAAAAAGuKM";

        LedgerProofOfExistence proofOfExistence = new LedgerProofOfExistence(verticalLayers);

        Assert.assertArrayEquals(proofOfExistence.getLedgerHash(), Utility.hexToBytes("790253715A6B9CD32D1C40D135729D877B8EB8A460AE8EE0"));

        Assert.assertEquals(proofOfExistence.getAddress(), address);
    }

    @Test
    public void invalidExistenceProof_1() {
        LedgerProofNode[] verticalLayers = new LedgerProofNode[4];

        verticalLayers[0] = new LedgerProofNode("mKMZzjx9JbyAgX3G6Y8Ri3Ho9uW".toCharArray(),
                new LedgerValue(9370812, 0, 0));

        // Invalid route
        verticalLayers[1] = new LedgerProofNode("v".toCharArray(),
                Utility.hexToBytes(""),
                Utility.hexToBytes("E65653591A85030C479432F80D0412D0234FFFC3083746CBE88281ECB65B3204"));

        verticalLayers[2] = new LedgerProofNode("F".toCharArray(),
                Utility.hexToBytes("4A5163B1682399D168D5216382E72BAF0E20C369BBC91306F5BF5FF54FEA7FCAE5E97FDF29406E8A7E99D4C5694804092464E932478FD174926801BAF4D7C31F552FE48569410CA7579111FF4359D29D3F980C276CB08F2524AB2CAAEC208AF3A8BD0B65CCB50B7A2ADE64B8A0B5BB0CA63B778834C5E156DC55BC7904B7295A27CC7A7D3B39E3C3E07D680A1336C931081D190080F7AC06A06EB1F6FE2EBEEEEDE1D97CCD97A5FD0887E5507F0646C773DF5E60B93E76DFD4A3015281DA6682E16F07D812829BCA0051C2C96655A9EA53AC353AD8B7DE814B9ABF8DF249122102958AE0016DB97509A3038A3812AE431B9F2B222DD81BCF657F16D1449463896DE15581B089F866F9FC65F6F77BD1D6A3845D2565F70D6A8219DDA79274208BACEB768A49F64EFAA7AB9F20C24191188E8785325DE3D5590EDCD7A0C890645FF0D5708F6A0F0F6BA699C75F8AEFD7479BC9D02CE2F41CDBCDC1B0535B0324F7970C4B88DB9877261A4874BD2CCF0BF60C809C85E8DC370E138A0B3C3F59003D4D06606B1750FCCC43A543743E878A3E87431CE2368D12261EB3235A3835705E51E78593C1FA52B8425663021A20F50B656F61AAA36AFD65E0DC9059559EB77739B9D7F73B136547FC4FC298C0A7B9A9F6C1664600D44072A38EAB76E0D335B64D04B763457199599D75A88ACA7ADBA3A2987AC2DE3449D7E3A481432DDAAB8AA7580072BFC1ACAE6C810D57771C773D6CB727058AC27F5AE8AC06FB2034ECC93DFD971008BE0FF99F767C645D1F35DE6F6FC9FACD388133BCACE9B6C9A819F4B8C01E3FFD7D3D8B9D2B8B4FA7971AF45849D1DD8DB30E01902FF31ED32C7D632E42463FC8D424D387672ED4DB30367EBD01A7C4475C3B500A6B6E191CD1E015CC3761A8A7C7DA34FA941ADB254C3C3EC300984D25850097F5754CC1F12E69D20EDADBFC5ED4A56494A63BB462CA2DC1E3DBAC8CDB8879E230E2C20B7D5D99F6D63BDE2704C8E94E979DD325ABD4E382EB22EDA8D80D2DA393D156A1F67F599422A6FDB7DF4D1F69C1EA3D5CB5E1CE641725076305C089C1A281EE445911FCBAEA753EB05CE4CFA0755398BAC8B85192AFDF9B2B7ADC545DF36B3EABEC61640856CD174A5D9E0E1107B37E61DAAD47A0702D2F5EDDAFB4FA299D98FC7E300091C0FB56BB0CEA1DB529204590294AA41B5CA483181A36FB312C16262859289A0E61B3822EAF119D6EE0CBB1FE6FBA2FC8799102C92E16A1570F2E701B8E07ACF7E0F03904EBE2B8001BF5F095F54789898233F790352297E9472D1AC2328BB9C8B223B24C2A76EDD11382FC4F20851A5D0749D0063A64333EE531546740C9C84C"),
                Utility.hexToBytes("62D5512D3329AF12D38707D7DF3D327A8CE4D91807962ACE770AF157599596CC2C002880EAC7DDE92378437EEB0E0C59192671A647953955FEEEB5B079A20421C936BA4AF425879B42B3A5394A8EA467F3C2693444CFFC5AB430EFA6D6849881C7C0F05DDB350F05F45CB973EA0EB0676E19084192BE18B6A81799CD02311D2E3530CDCC1E5BDFA3655D083166A85FC50D28668595DC9A9B24C8B96737C324B5"));

        verticalLayers[3] = new LedgerProofNode("V".toCharArray(),
                Utility.hexToBytes("5F40073859A8A4E4FEF7DE6BB13902967E491D8471C8DA4B8DD3A95B8755E2E4810C18A5F1D9E9A273931345FF4BDD4F5E64980C861FF74EE7B4AD76A44F043DAA3CD5AD220063907C5B184F1F9045491B01340CF3F422E02FD66C99DCDCE6193CAD49F3136780017ACC39DB6F031041F9DCEF1AE32EFABBA9542EBC94E9A29057F43CD7A164F7A11B75A74949965BE67286AC84EB9AC550D97B7EB229BFDBE1EB4E797DC3CEBE849AA1178E7F93F16108FBB58BDAF0ED8AABFC9C1BE23D7D0DE5E53AA591BCC86380BAC16EFF02A9568C78EC255989D76590C530901BC5EA6E8FAF405AD14082446413616FCC2FAB6C7323A047A9D6EB8A526F9A4CCDB8D811776CE8DC179623C44CCFD25B40226E936D61264D3C74F082D0ADE06DC2F723B3F2699A994E8EFBD93E16C173142F18BC9F19E2066BCB4B2906182D6D03C26EDDE147813A6F09F7FBCA78F0F84D6A1ED75ACDCD21A36A9119BDCB29B53C686C4108CD598E170D6A59717E43B77A58E93D6B7368F95415C38646F9D549051E2E87898E991AC58777A2D25BA0B22B82437788ECD92AB9AF0C47EF8661230F93D799DA0E782C04E011071938664C17166C462D91A6C1C2DEE0A3392A72C83C5FB495"),
                Utility.hexToBytes("379D2375DCAD289C364CA2051A24B47C843AFD41F69C81D3DAA9FCF934CAA073CC2DE49700C9404947A4F748820502353BD00960951383F42451154AB71B0CA566E0860795CD4DC38A2414D817174B9562A0E2132C548EC636A7C3806F0058389C37BC421C446FE46B77A0B61E2030E8877028EA5DDB646E9867F392DAE721DAAC0A3EB20885351784A235192BE61D028CDF3505209D97BAFA9B9A00F614862DC82A81DE826CB59DB01796193A1F416C49EE7CA8D2A31C3DEC8D05572B6B20E57E53D8C52EC37FA05EDE4279A2BB249F3BB02AEACE43F9CF47CD4A2338BC35218386E24699961A7C3620780A3FDCA5142E9E3E30B73E228F8C2E8953942F066195D26FE2B8BA6AF5A14AFACA034D6E9FE9BD9DEA58D1AC627B2D3CFD0D4E2C3958335AED080C5E94B2B27341B5894CE9DFCA403C7DB63B0D2FFC2B631A6F46133C3E6D08C5897642C9CE81FA4E450190E4A6044E1B2D34900B2C3ADB64005D974298B367105D6B5EA4346BB65EA95ACAF3C8817135A2D49F501328F064BA85EFEC864C55424FBF0AAA0C8F5E5CDFC7FF4D2A75128F9C2694668219543C907B560CB4D991B29343001D75BA06200290E2302CFBDD7F6172BED18ED6779DCB516F294E5C7CB5F87D5D77FF340A76B2282E9B445FE744F3877CDDD7B2DEA5AA3B6D368448C9E4919516FC596B51BAC0E2E45B7113A70FBBD672013C29F73141382DBF4AB716F8E18B2B38E2D67DC2D1CC3D471C7313A78B36457F660DC71A462F6728EB4DC14D434F06F0450F12DB49D460C819CFDAEE87BF03EABACFA729D2BD47B6B1C3F12B3BF7753DCCA75F87FD6FB5473D7084D8A1FCE62ABE01AA803B605889D98B1E749FC931607103814C0B0525210086853D905D898FCDEC377A106ADB611732B4639BE8B0189A54BC9E17B395DA2DC792342A6BA8498CEBAE814E559938A34A7B25F990C413EF260CAE3DE35119AC6631F81DBA61ACE348BF7732169278F64BD607572625F9A434F7C34F40E336DEBDA27D053E9216305AB1778E19967E51BEE26370B58F2844C40BD6844752CB0F352A34DC851DADC0B85AA239C7BC23932135F3537108415C4BD23B5DFF4D04C63D371D8A0046D946A601CB0841D61CE3C30419B0D4F9FD111B6526675A9109A13079D6E581666574E11DFE1AD5313E5AABDE390C2DE1A8BA9AF6534E80E2AA73F8B64B93C88E2030908C075C6F2A"));

        String address = "VFtmKMZzjx9JbyAgX3G6Y8Ri3Ho9uW";

        LedgerProofOfExistence proofOfExistence = new LedgerProofOfExistence(verticalLayers);

        Assert.assertNotEquals(Utility.bytesToHex(proofOfExistence.getLedgerHash()).toUpperCase(), Utility.hexToBytes("7BEBDCECA669943E16000F3B657322B7AD0D5DD012660A59"));

        Assert.assertNotEquals(proofOfExistence.getAddress(), address);
    }

    @Test
    public void invalidExistenceProof_2() {
        LedgerProofNode[] verticalLayers = new LedgerProofNode[4];

        // Invalid route
        verticalLayers[0] = new LedgerProofNode("mKMZzjx9JbyAgX3G6Y8Ri3Ho9uv".toCharArray(),
                new LedgerValue(9370812, 0, 0));

        verticalLayers[1] = new LedgerProofNode("t".toCharArray(),
                Utility.hexToBytes(""),
                Utility.hexToBytes("E65653591A85030C479432F80D0412D0234FFFC3083746CBE88281ECB65B3204"));

        verticalLayers[2] = new LedgerProofNode("F".toCharArray(),
                Utility.hexToBytes("4A5163B1682399D168D5216382E72BAF0E20C369BBC91306F5BF5FF54FEA7FCAE5E97FDF29406E8A7E99D4C5694804092464E932478FD174926801BAF4D7C31F552FE48569410CA7579111FF4359D29D3F980C276CB08F2524AB2CAAEC208AF3A8BD0B65CCB50B7A2ADE64B8A0B5BB0CA63B778834C5E156DC55BC7904B7295A27CC7A7D3B39E3C3E07D680A1336C931081D190080F7AC06A06EB1F6FE2EBEEEEDE1D97CCD97A5FD0887E5507F0646C773DF5E60B93E76DFD4A3015281DA6682E16F07D812829BCA0051C2C96655A9EA53AC353AD8B7DE814B9ABF8DF249122102958AE0016DB97509A3038A3812AE431B9F2B222DD81BCF657F16D1449463896DE15581B089F866F9FC65F6F77BD1D6A3845D2565F70D6A8219DDA79274208BACEB768A49F64EFAA7AB9F20C24191188E8785325DE3D5590EDCD7A0C890645FF0D5708F6A0F0F6BA699C75F8AEFD7479BC9D02CE2F41CDBCDC1B0535B0324F7970C4B88DB9877261A4874BD2CCF0BF60C809C85E8DC370E138A0B3C3F59003D4D06606B1750FCCC43A543743E878A3E87431CE2368D12261EB3235A3835705E51E78593C1FA52B8425663021A20F50B656F61AAA36AFD65E0DC9059559EB77739B9D7F73B136547FC4FC298C0A7B9A9F6C1664600D44072A38EAB76E0D335B64D04B763457199599D75A88ACA7ADBA3A2987AC2DE3449D7E3A481432DDAAB8AA7580072BFC1ACAE6C810D57771C773D6CB727058AC27F5AE8AC06FB2034ECC93DFD971008BE0FF99F767C645D1F35DE6F6FC9FACD388133BCACE9B6C9A819F4B8C01E3FFD7D3D8B9D2B8B4FA7971AF45849D1DD8DB30E01902FF31ED32C7D632E42463FC8D424D387672ED4DB30367EBD01A7C4475C3B500A6B6E191CD1E015CC3761A8A7C7DA34FA941ADB254C3C3EC300984D25850097F5754CC1F12E69D20EDADBFC5ED4A56494A63BB462CA2DC1E3DBAC8CDB8879E230E2C20B7D5D99F6D63BDE2704C8E94E979DD325ABD4E382EB22EDA8D80D2DA393D156A1F67F599422A6FDB7DF4D1F69C1EA3D5CB5E1CE641725076305C089C1A281EE445911FCBAEA753EB05CE4CFA0755398BAC8B85192AFDF9B2B7ADC545DF36B3EABEC61640856CD174A5D9E0E1107B37E61DAAD47A0702D2F5EDDAFB4FA299D98FC7E300091C0FB56BB0CEA1DB529204590294AA41B5CA483181A36FB312C16262859289A0E61B3822EAF119D6EE0CBB1FE6FBA2FC8799102C92E16A1570F2E701B8E07ACF7E0F03904EBE2B8001BF5F095F54789898233F790352297E9472D1AC2328BB9C8B223B24C2A76EDD11382FC4F20851A5D0749D0063A64333EE531546740C9C84C"),
                Utility.hexToBytes("62D5512D3329AF12D38707D7DF3D327A8CE4D91807962ACE770AF157599596CC2C002880EAC7DDE92378437EEB0E0C59192671A647953955FEEEB5B079A20421C936BA4AF425879B42B3A5394A8EA467F3C2693444CFFC5AB430EFA6D6849881C7C0F05DDB350F05F45CB973EA0EB0676E19084192BE18B6A81799CD02311D2E3530CDCC1E5BDFA3655D083166A85FC50D28668595DC9A9B24C8B96737C324B5"));

        verticalLayers[3] = new LedgerProofNode("V".toCharArray(),
                Utility.hexToBytes("5F40073859A8A4E4FEF7DE6BB13902967E491D8471C8DA4B8DD3A95B8755E2E4810C18A5F1D9E9A273931345FF4BDD4F5E64980C861FF74EE7B4AD76A44F043DAA3CD5AD220063907C5B184F1F9045491B01340CF3F422E02FD66C99DCDCE6193CAD49F3136780017ACC39DB6F031041F9DCEF1AE32EFABBA9542EBC94E9A29057F43CD7A164F7A11B75A74949965BE67286AC84EB9AC550D97B7EB229BFDBE1EB4E797DC3CEBE849AA1178E7F93F16108FBB58BDAF0ED8AABFC9C1BE23D7D0DE5E53AA591BCC86380BAC16EFF02A9568C78EC255989D76590C530901BC5EA6E8FAF405AD14082446413616FCC2FAB6C7323A047A9D6EB8A526F9A4CCDB8D811776CE8DC179623C44CCFD25B40226E936D61264D3C74F082D0ADE06DC2F723B3F2699A994E8EFBD93E16C173142F18BC9F19E2066BCB4B2906182D6D03C26EDDE147813A6F09F7FBCA78F0F84D6A1ED75ACDCD21A36A9119BDCB29B53C686C4108CD598E170D6A59717E43B77A58E93D6B7368F95415C38646F9D549051E2E87898E991AC58777A2D25BA0B22B82437788ECD92AB9AF0C47EF8661230F93D799DA0E782C04E011071938664C17166C462D91A6C1C2DEE0A3392A72C83C5FB495"),
                Utility.hexToBytes("379D2375DCAD289C364CA2051A24B47C843AFD41F69C81D3DAA9FCF934CAA073CC2DE49700C9404947A4F748820502353BD00960951383F42451154AB71B0CA566E0860795CD4DC38A2414D817174B9562A0E2132C548EC636A7C3806F0058389C37BC421C446FE46B77A0B61E2030E8877028EA5DDB646E9867F392DAE721DAAC0A3EB20885351784A235192BE61D028CDF3505209D97BAFA9B9A00F614862DC82A81DE826CB59DB01796193A1F416C49EE7CA8D2A31C3DEC8D05572B6B20E57E53D8C52EC37FA05EDE4279A2BB249F3BB02AEACE43F9CF47CD4A2338BC35218386E24699961A7C3620780A3FDCA5142E9E3E30B73E228F8C2E8953942F066195D26FE2B8BA6AF5A14AFACA034D6E9FE9BD9DEA58D1AC627B2D3CFD0D4E2C3958335AED080C5E94B2B27341B5894CE9DFCA403C7DB63B0D2FFC2B631A6F46133C3E6D08C5897642C9CE81FA4E450190E4A6044E1B2D34900B2C3ADB64005D974298B367105D6B5EA4346BB65EA95ACAF3C8817135A2D49F501328F064BA85EFEC864C55424FBF0AAA0C8F5E5CDFC7FF4D2A75128F9C2694668219543C907B560CB4D991B29343001D75BA06200290E2302CFBDD7F6172BED18ED6779DCB516F294E5C7CB5F87D5D77FF340A76B2282E9B445FE744F3877CDDD7B2DEA5AA3B6D368448C9E4919516FC596B51BAC0E2E45B7113A70FBBD672013C29F73141382DBF4AB716F8E18B2B38E2D67DC2D1CC3D471C7313A78B36457F660DC71A462F6728EB4DC14D434F06F0450F12DB49D460C819CFDAEE87BF03EABACFA729D2BD47B6B1C3F12B3BF7753DCCA75F87FD6FB5473D7084D8A1FCE62ABE01AA803B605889D98B1E749FC931607103814C0B0525210086853D905D898FCDEC377A106ADB611732B4639BE8B0189A54BC9E17B395DA2DC792342A6BA8498CEBAE814E559938A34A7B25F990C413EF260CAE3DE35119AC6631F81DBA61ACE348BF7732169278F64BD607572625F9A434F7C34F40E336DEBDA27D053E9216305AB1778E19967E51BEE26370B58F2844C40BD6844752CB0F352A34DC851DADC0B85AA239C7BC23932135F3537108415C4BD23B5DFF4D04C63D371D8A0046D946A601CB0841D61CE3C30419B0D4F9FD111B6526675A9109A13079D6E581666574E11DFE1AD5313E5AABDE390C2DE1A8BA9AF6534E80E2AA73F8B64B93C88E2030908C075C6F2A"));

        String address = "VFtmKMZzjx9JbyAgX3G6Y8Ri3Ho9uW";

        LedgerProofOfExistence proofOfExistence = new LedgerProofOfExistence(verticalLayers);

        Assert.assertNotEquals(Utility.bytesToHex(proofOfExistence.getLedgerHash()).toUpperCase(), Utility.hexToBytes("7BEBDCECA669943E16000F3B657322B7AD0D5DD012660A59"));

        Assert.assertNotEquals(proofOfExistence.getAddress(), address);
    }

    @Test
    public void invalidExistenceProof_3() {
        LedgerProofNode[] verticalLayers = new LedgerProofNode[4];

        // Invalid balance
        verticalLayers[0] = new LedgerProofNode("mKMZzjx9JbyAgX3G6Y8Ri3Ho9uW".toCharArray(),
                new LedgerValue(9370810, 0, 0));

        verticalLayers[1] = new LedgerProofNode("t".toCharArray(),
                Utility.hexToBytes(""),
                Utility.hexToBytes("E65653591A85030C479432F80D0412D0234FFFC3083746CBE88281ECB65B3204"));

        verticalLayers[2] = new LedgerProofNode("F".toCharArray(),
                Utility.hexToBytes("4A5163B1682399D168D5216382E72BAF0E20C369BBC91306F5BF5FF54FEA7FCAE5E97FDF29406E8A7E99D4C5694804092464E932478FD174926801BAF4D7C31F552FE48569410CA7579111FF4359D29D3F980C276CB08F2524AB2CAAEC208AF3A8BD0B65CCB50B7A2ADE64B8A0B5BB0CA63B778834C5E156DC55BC7904B7295A27CC7A7D3B39E3C3E07D680A1336C931081D190080F7AC06A06EB1F6FE2EBEEEEDE1D97CCD97A5FD0887E5507F0646C773DF5E60B93E76DFD4A3015281DA6682E16F07D812829BCA0051C2C96655A9EA53AC353AD8B7DE814B9ABF8DF249122102958AE0016DB97509A3038A3812AE431B9F2B222DD81BCF657F16D1449463896DE15581B089F866F9FC65F6F77BD1D6A3845D2565F70D6A8219DDA79274208BACEB768A49F64EFAA7AB9F20C24191188E8785325DE3D5590EDCD7A0C890645FF0D5708F6A0F0F6BA699C75F8AEFD7479BC9D02CE2F41CDBCDC1B0535B0324F7970C4B88DB9877261A4874BD2CCF0BF60C809C85E8DC370E138A0B3C3F59003D4D06606B1750FCCC43A543743E878A3E87431CE2368D12261EB3235A3835705E51E78593C1FA52B8425663021A20F50B656F61AAA36AFD65E0DC9059559EB77739B9D7F73B136547FC4FC298C0A7B9A9F6C1664600D44072A38EAB76E0D335B64D04B763457199599D75A88ACA7ADBA3A2987AC2DE3449D7E3A481432DDAAB8AA7580072BFC1ACAE6C810D57771C773D6CB727058AC27F5AE8AC06FB2034ECC93DFD971008BE0FF99F767C645D1F35DE6F6FC9FACD388133BCACE9B6C9A819F4B8C01E3FFD7D3D8B9D2B8B4FA7971AF45849D1DD8DB30E01902FF31ED32C7D632E42463FC8D424D387672ED4DB30367EBD01A7C4475C3B500A6B6E191CD1E015CC3761A8A7C7DA34FA941ADB254C3C3EC300984D25850097F5754CC1F12E69D20EDADBFC5ED4A56494A63BB462CA2DC1E3DBAC8CDB8879E230E2C20B7D5D99F6D63BDE2704C8E94E979DD325ABD4E382EB22EDA8D80D2DA393D156A1F67F599422A6FDB7DF4D1F69C1EA3D5CB5E1CE641725076305C089C1A281EE445911FCBAEA753EB05CE4CFA0755398BAC8B85192AFDF9B2B7ADC545DF36B3EABEC61640856CD174A5D9E0E1107B37E61DAAD47A0702D2F5EDDAFB4FA299D98FC7E300091C0FB56BB0CEA1DB529204590294AA41B5CA483181A36FB312C16262859289A0E61B3822EAF119D6EE0CBB1FE6FBA2FC8799102C92E16A1570F2E701B8E07ACF7E0F03904EBE2B8001BF5F095F54789898233F790352297E9472D1AC2328BB9C8B223B24C2A76EDD11382FC4F20851A5D0749D0063A64333EE531546740C9C84C"),
                Utility.hexToBytes("62D5512D3329AF12D38707D7DF3D327A8CE4D91807962ACE770AF157599596CC2C002880EAC7DDE92378437EEB0E0C59192671A647953955FEEEB5B079A20421C936BA4AF425879B42B3A5394A8EA467F3C2693444CFFC5AB430EFA6D6849881C7C0F05DDB350F05F45CB973EA0EB0676E19084192BE18B6A81799CD02311D2E3530CDCC1E5BDFA3655D083166A85FC50D28668595DC9A9B24C8B96737C324B5"));

        verticalLayers[3] = new LedgerProofNode("V".toCharArray(),
                Utility.hexToBytes("5F40073859A8A4E4FEF7DE6BB13902967E491D8471C8DA4B8DD3A95B8755E2E4810C18A5F1D9E9A273931345FF4BDD4F5E64980C861FF74EE7B4AD76A44F043DAA3CD5AD220063907C5B184F1F9045491B01340CF3F422E02FD66C99DCDCE6193CAD49F3136780017ACC39DB6F031041F9DCEF1AE32EFABBA9542EBC94E9A29057F43CD7A164F7A11B75A74949965BE67286AC84EB9AC550D97B7EB229BFDBE1EB4E797DC3CEBE849AA1178E7F93F16108FBB58BDAF0ED8AABFC9C1BE23D7D0DE5E53AA591BCC86380BAC16EFF02A9568C78EC255989D76590C530901BC5EA6E8FAF405AD14082446413616FCC2FAB6C7323A047A9D6EB8A526F9A4CCDB8D811776CE8DC179623C44CCFD25B40226E936D61264D3C74F082D0ADE06DC2F723B3F2699A994E8EFBD93E16C173142F18BC9F19E2066BCB4B2906182D6D03C26EDDE147813A6F09F7FBCA78F0F84D6A1ED75ACDCD21A36A9119BDCB29B53C686C4108CD598E170D6A59717E43B77A58E93D6B7368F95415C38646F9D549051E2E87898E991AC58777A2D25BA0B22B82437788ECD92AB9AF0C47EF8661230F93D799DA0E782C04E011071938664C17166C462D91A6C1C2DEE0A3392A72C83C5FB495"),
                Utility.hexToBytes("379D2375DCAD289C364CA2051A24B47C843AFD41F69C81D3DAA9FCF934CAA073CC2DE49700C9404947A4F748820502353BD00960951383F42451154AB71B0CA566E0860795CD4DC38A2414D817174B9562A0E2132C548EC636A7C3806F0058389C37BC421C446FE46B77A0B61E2030E8877028EA5DDB646E9867F392DAE721DAAC0A3EB20885351784A235192BE61D028CDF3505209D97BAFA9B9A00F614862DC82A81DE826CB59DB01796193A1F416C49EE7CA8D2A31C3DEC8D05572B6B20E57E53D8C52EC37FA05EDE4279A2BB249F3BB02AEACE43F9CF47CD4A2338BC35218386E24699961A7C3620780A3FDCA5142E9E3E30B73E228F8C2E8953942F066195D26FE2B8BA6AF5A14AFACA034D6E9FE9BD9DEA58D1AC627B2D3CFD0D4E2C3958335AED080C5E94B2B27341B5894CE9DFCA403C7DB63B0D2FFC2B631A6F46133C3E6D08C5897642C9CE81FA4E450190E4A6044E1B2D34900B2C3ADB64005D974298B367105D6B5EA4346BB65EA95ACAF3C8817135A2D49F501328F064BA85EFEC864C55424FBF0AAA0C8F5E5CDFC7FF4D2A75128F9C2694668219543C907B560CB4D991B29343001D75BA06200290E2302CFBDD7F6172BED18ED6779DCB516F294E5C7CB5F87D5D77FF340A76B2282E9B445FE744F3877CDDD7B2DEA5AA3B6D368448C9E4919516FC596B51BAC0E2E45B7113A70FBBD672013C29F73141382DBF4AB716F8E18B2B38E2D67DC2D1CC3D471C7313A78B36457F660DC71A462F6728EB4DC14D434F06F0450F12DB49D460C819CFDAEE87BF03EABACFA729D2BD47B6B1C3F12B3BF7753DCCA75F87FD6FB5473D7084D8A1FCE62ABE01AA803B605889D98B1E749FC931607103814C0B0525210086853D905D898FCDEC377A106ADB611732B4639BE8B0189A54BC9E17B395DA2DC792342A6BA8498CEBAE814E559938A34A7B25F990C413EF260CAE3DE35119AC6631F81DBA61ACE348BF7732169278F64BD607572625F9A434F7C34F40E336DEBDA27D053E9216305AB1778E19967E51BEE26370B58F2844C40BD6844752CB0F352A34DC851DADC0B85AA239C7BC23932135F3537108415C4BD23B5DFF4D04C63D371D8A0046D946A601CB0841D61CE3C30419B0D4F9FD111B6526675A9109A13079D6E581666574E11DFE1AD5313E5AABDE390C2DE1A8BA9AF6534E80E2AA73F8B64B93C88E2030908C075C6F2A"));

        String address = "VFtmKMZzjx9JbyAgX3G6Y8Ri3Ho9uW";

        LedgerProofOfExistence proofOfExistence = new LedgerProofOfExistence(verticalLayers);

        Assert.assertNotEquals(Utility.bytesToHex(proofOfExistence.getLedgerHash()).toUpperCase(), Utility.hexToBytes("7BEBDCECA669943E16000F3B657322B7AD0D5DD012660A59"));
    }

    @Test
    public void invalidExistenceProof_4() {
        LedgerProofNode[] verticalLayers = new LedgerProofNode[4];

        // Invalid signature index
        verticalLayers[0] = new LedgerProofNode("mKMZzjx9JbyAgX3G6Y8Ri3Ho9uW".toCharArray(),
                new LedgerValue(9370812, 0, -1));

        verticalLayers[1] = new LedgerProofNode("t".toCharArray(),
                Utility.hexToBytes(""),
                Utility.hexToBytes("E65653591A85030C479432F80D0412D0234FFFC3083746CBE88281ECB65B3204"));

        verticalLayers[2] = new LedgerProofNode("F".toCharArray(),
                Utility.hexToBytes("4A5163B1682399D168D5216382E72BAF0E20C369BBC91306F5BF5FF54FEA7FCAE5E97FDF29406E8A7E99D4C5694804092464E932478FD174926801BAF4D7C31F552FE48569410CA7579111FF4359D29D3F980C276CB08F2524AB2CAAEC208AF3A8BD0B65CCB50B7A2ADE64B8A0B5BB0CA63B778834C5E156DC55BC7904B7295A27CC7A7D3B39E3C3E07D680A1336C931081D190080F7AC06A06EB1F6FE2EBEEEEDE1D97CCD97A5FD0887E5507F0646C773DF5E60B93E76DFD4A3015281DA6682E16F07D812829BCA0051C2C96655A9EA53AC353AD8B7DE814B9ABF8DF249122102958AE0016DB97509A3038A3812AE431B9F2B222DD81BCF657F16D1449463896DE15581B089F866F9FC65F6F77BD1D6A3845D2565F70D6A8219DDA79274208BACEB768A49F64EFAA7AB9F20C24191188E8785325DE3D5590EDCD7A0C890645FF0D5708F6A0F0F6BA699C75F8AEFD7479BC9D02CE2F41CDBCDC1B0535B0324F7970C4B88DB9877261A4874BD2CCF0BF60C809C85E8DC370E138A0B3C3F59003D4D06606B1750FCCC43A543743E878A3E87431CE2368D12261EB3235A3835705E51E78593C1FA52B8425663021A20F50B656F61AAA36AFD65E0DC9059559EB77739B9D7F73B136547FC4FC298C0A7B9A9F6C1664600D44072A38EAB76E0D335B64D04B763457199599D75A88ACA7ADBA3A2987AC2DE3449D7E3A481432DDAAB8AA7580072BFC1ACAE6C810D57771C773D6CB727058AC27F5AE8AC06FB2034ECC93DFD971008BE0FF99F767C645D1F35DE6F6FC9FACD388133BCACE9B6C9A819F4B8C01E3FFD7D3D8B9D2B8B4FA7971AF45849D1DD8DB30E01902FF31ED32C7D632E42463FC8D424D387672ED4DB30367EBD01A7C4475C3B500A6B6E191CD1E015CC3761A8A7C7DA34FA941ADB254C3C3EC300984D25850097F5754CC1F12E69D20EDADBFC5ED4A56494A63BB462CA2DC1E3DBAC8CDB8879E230E2C20B7D5D99F6D63BDE2704C8E94E979DD325ABD4E382EB22EDA8D80D2DA393D156A1F67F599422A6FDB7DF4D1F69C1EA3D5CB5E1CE641725076305C089C1A281EE445911FCBAEA753EB05CE4CFA0755398BAC8B85192AFDF9B2B7ADC545DF36B3EABEC61640856CD174A5D9E0E1107B37E61DAAD47A0702D2F5EDDAFB4FA299D98FC7E300091C0FB56BB0CEA1DB529204590294AA41B5CA483181A36FB312C16262859289A0E61B3822EAF119D6EE0CBB1FE6FBA2FC8799102C92E16A1570F2E701B8E07ACF7E0F03904EBE2B8001BF5F095F54789898233F790352297E9472D1AC2328BB9C8B223B24C2A76EDD11382FC4F20851A5D0749D0063A64333EE531546740C9C84C"),
                Utility.hexToBytes("62D5512D3329AF12D38707D7DF3D327A8CE4D91807962ACE770AF157599596CC2C002880EAC7DDE92378437EEB0E0C59192671A647953955FEEEB5B079A20421C936BA4AF425879B42B3A5394A8EA467F3C2693444CFFC5AB430EFA6D6849881C7C0F05DDB350F05F45CB973EA0EB0676E19084192BE18B6A81799CD02311D2E3530CDCC1E5BDFA3655D083166A85FC50D28668595DC9A9B24C8B96737C324B5"));

        verticalLayers[3] = new LedgerProofNode("V".toCharArray(),
                Utility.hexToBytes("5F40073859A8A4E4FEF7DE6BB13902967E491D8471C8DA4B8DD3A95B8755E2E4810C18A5F1D9E9A273931345FF4BDD4F5E64980C861FF74EE7B4AD76A44F043DAA3CD5AD220063907C5B184F1F9045491B01340CF3F422E02FD66C99DCDCE6193CAD49F3136780017ACC39DB6F031041F9DCEF1AE32EFABBA9542EBC94E9A29057F43CD7A164F7A11B75A74949965BE67286AC84EB9AC550D97B7EB229BFDBE1EB4E797DC3CEBE849AA1178E7F93F16108FBB58BDAF0ED8AABFC9C1BE23D7D0DE5E53AA591BCC86380BAC16EFF02A9568C78EC255989D76590C530901BC5EA6E8FAF405AD14082446413616FCC2FAB6C7323A047A9D6EB8A526F9A4CCDB8D811776CE8DC179623C44CCFD25B40226E936D61264D3C74F082D0ADE06DC2F723B3F2699A994E8EFBD93E16C173142F18BC9F19E2066BCB4B2906182D6D03C26EDDE147813A6F09F7FBCA78F0F84D6A1ED75ACDCD21A36A9119BDCB29B53C686C4108CD598E170D6A59717E43B77A58E93D6B7368F95415C38646F9D549051E2E87898E991AC58777A2D25BA0B22B82437788ECD92AB9AF0C47EF8661230F93D799DA0E782C04E011071938664C17166C462D91A6C1C2DEE0A3392A72C83C5FB495"),
                Utility.hexToBytes("379D2375DCAD289C364CA2051A24B47C843AFD41F69C81D3DAA9FCF934CAA073CC2DE49700C9404947A4F748820502353BD00960951383F42451154AB71B0CA566E0860795CD4DC38A2414D817174B9562A0E2132C548EC636A7C3806F0058389C37BC421C446FE46B77A0B61E2030E8877028EA5DDB646E9867F392DAE721DAAC0A3EB20885351784A235192BE61D028CDF3505209D97BAFA9B9A00F614862DC82A81DE826CB59DB01796193A1F416C49EE7CA8D2A31C3DEC8D05572B6B20E57E53D8C52EC37FA05EDE4279A2BB249F3BB02AEACE43F9CF47CD4A2338BC35218386E24699961A7C3620780A3FDCA5142E9E3E30B73E228F8C2E8953942F066195D26FE2B8BA6AF5A14AFACA034D6E9FE9BD9DEA58D1AC627B2D3CFD0D4E2C3958335AED080C5E94B2B27341B5894CE9DFCA403C7DB63B0D2FFC2B631A6F46133C3E6D08C5897642C9CE81FA4E450190E4A6044E1B2D34900B2C3ADB64005D974298B367105D6B5EA4346BB65EA95ACAF3C8817135A2D49F501328F064BA85EFEC864C55424FBF0AAA0C8F5E5CDFC7FF4D2A75128F9C2694668219543C907B560CB4D991B29343001D75BA06200290E2302CFBDD7F6172BED18ED6779DCB516F294E5C7CB5F87D5D77FF340A76B2282E9B445FE744F3877CDDD7B2DEA5AA3B6D368448C9E4919516FC596B51BAC0E2E45B7113A70FBBD672013C29F73141382DBF4AB716F8E18B2B38E2D67DC2D1CC3D471C7313A78B36457F660DC71A462F6728EB4DC14D434F06F0450F12DB49D460C819CFDAEE87BF03EABACFA729D2BD47B6B1C3F12B3BF7753DCCA75F87FD6FB5473D7084D8A1FCE62ABE01AA803B605889D98B1E749FC931607103814C0B0525210086853D905D898FCDEC377A106ADB611732B4639BE8B0189A54BC9E17B395DA2DC792342A6BA8498CEBAE814E559938A34A7B25F990C413EF260CAE3DE35119AC6631F81DBA61ACE348BF7732169278F64BD607572625F9A434F7C34F40E336DEBDA27D053E9216305AB1778E19967E51BEE26370B58F2844C40BD6844752CB0F352A34DC851DADC0B85AA239C7BC23932135F3537108415C4BD23B5DFF4D04C63D371D8A0046D946A601CB0841D61CE3C30419B0D4F9FD111B6526675A9109A13079D6E581666574E11DFE1AD5313E5AABDE390C2DE1A8BA9AF6534E80E2AA73F8B64B93C88E2030908C075C6F2A"));

        String address = "VFtmKMZzjx9JbyAgX3G6Y8Ri3Ho9uW";

        LedgerProofOfExistence proofOfExistence = new LedgerProofOfExistence(verticalLayers);

        Assert.assertNotEquals(Utility.bytesToHex(proofOfExistence.getLedgerHash()).toUpperCase(), Utility.hexToBytes("7BEBDCECA669943E16000F3B657322B7AD0D5DD012660A59"));
    }

    @Test
    public void invalidExistenceProof_5() {
        LedgerProofNode[] verticalLayers = new LedgerProofNode[4];

        verticalLayers[0] = new LedgerProofNode("mKMZzjx9JbyAgX3G6Y8Ri3Ho9uW".toCharArray(),
                new LedgerValue(9370812, 0, 0));

        // Invalid left and right child headers
        verticalLayers[1] = new LedgerProofNode("t".toCharArray(),
                Utility.hexToBytes("E65653591A85030C479432F80D0412D0234FFFC3083746CBE88281ECB65B3204"),
                Utility.hexToBytes(""));

        verticalLayers[2] = new LedgerProofNode("F".toCharArray(),
                Utility.hexToBytes("4A5163B1682399D168D5216382E72BAF0E20C369BBC91306F5BF5FF54FEA7FCAE5E97FDF29406E8A7E99D4C5694804092464E932478FD174926801BAF4D7C31F552FE48569410CA7579111FF4359D29D3F980C276CB08F2524AB2CAAEC208AF3A8BD0B65CCB50B7A2ADE64B8A0B5BB0CA63B778834C5E156DC55BC7904B7295A27CC7A7D3B39E3C3E07D680A1336C931081D190080F7AC06A06EB1F6FE2EBEEEEDE1D97CCD97A5FD0887E5507F0646C773DF5E60B93E76DFD4A3015281DA6682E16F07D812829BCA0051C2C96655A9EA53AC353AD8B7DE814B9ABF8DF249122102958AE0016DB97509A3038A3812AE431B9F2B222DD81BCF657F16D1449463896DE15581B089F866F9FC65F6F77BD1D6A3845D2565F70D6A8219DDA79274208BACEB768A49F64EFAA7AB9F20C24191188E8785325DE3D5590EDCD7A0C890645FF0D5708F6A0F0F6BA699C75F8AEFD7479BC9D02CE2F41CDBCDC1B0535B0324F7970C4B88DB9877261A4874BD2CCF0BF60C809C85E8DC370E138A0B3C3F59003D4D06606B1750FCCC43A543743E878A3E87431CE2368D12261EB3235A3835705E51E78593C1FA52B8425663021A20F50B656F61AAA36AFD65E0DC9059559EB77739B9D7F73B136547FC4FC298C0A7B9A9F6C1664600D44072A38EAB76E0D335B64D04B763457199599D75A88ACA7ADBA3A2987AC2DE3449D7E3A481432DDAAB8AA7580072BFC1ACAE6C810D57771C773D6CB727058AC27F5AE8AC06FB2034ECC93DFD971008BE0FF99F767C645D1F35DE6F6FC9FACD388133BCACE9B6C9A819F4B8C01E3FFD7D3D8B9D2B8B4FA7971AF45849D1DD8DB30E01902FF31ED32C7D632E42463FC8D424D387672ED4DB30367EBD01A7C4475C3B500A6B6E191CD1E015CC3761A8A7C7DA34FA941ADB254C3C3EC300984D25850097F5754CC1F12E69D20EDADBFC5ED4A56494A63BB462CA2DC1E3DBAC8CDB8879E230E2C20B7D5D99F6D63BDE2704C8E94E979DD325ABD4E382EB22EDA8D80D2DA393D156A1F67F599422A6FDB7DF4D1F69C1EA3D5CB5E1CE641725076305C089C1A281EE445911FCBAEA753EB05CE4CFA0755398BAC8B85192AFDF9B2B7ADC545DF36B3EABEC61640856CD174A5D9E0E1107B37E61DAAD47A0702D2F5EDDAFB4FA299D98FC7E300091C0FB56BB0CEA1DB529204590294AA41B5CA483181A36FB312C16262859289A0E61B3822EAF119D6EE0CBB1FE6FBA2FC8799102C92E16A1570F2E701B8E07ACF7E0F03904EBE2B8001BF5F095F54789898233F790352297E9472D1AC2328BB9C8B223B24C2A76EDD11382FC4F20851A5D0749D0063A64333EE531546740C9C84C"),
                Utility.hexToBytes("62D5512D3329AF12D38707D7DF3D327A8CE4D91807962ACE770AF157599596CC2C002880EAC7DDE92378437EEB0E0C59192671A647953955FEEEB5B079A20421C936BA4AF425879B42B3A5394A8EA467F3C2693444CFFC5AB430EFA6D6849881C7C0F05DDB350F05F45CB973EA0EB0676E19084192BE18B6A81799CD02311D2E3530CDCC1E5BDFA3655D083166A85FC50D28668595DC9A9B24C8B96737C324B5"));

        verticalLayers[3] = new LedgerProofNode("V".toCharArray(),
                Utility.hexToBytes("5F40073859A8A4E4FEF7DE6BB13902967E491D8471C8DA4B8DD3A95B8755E2E4810C18A5F1D9E9A273931345FF4BDD4F5E64980C861FF74EE7B4AD76A44F043DAA3CD5AD220063907C5B184F1F9045491B01340CF3F422E02FD66C99DCDCE6193CAD49F3136780017ACC39DB6F031041F9DCEF1AE32EFABBA9542EBC94E9A29057F43CD7A164F7A11B75A74949965BE67286AC84EB9AC550D97B7EB229BFDBE1EB4E797DC3CEBE849AA1178E7F93F16108FBB58BDAF0ED8AABFC9C1BE23D7D0DE5E53AA591BCC86380BAC16EFF02A9568C78EC255989D76590C530901BC5EA6E8FAF405AD14082446413616FCC2FAB6C7323A047A9D6EB8A526F9A4CCDB8D811776CE8DC179623C44CCFD25B40226E936D61264D3C74F082D0ADE06DC2F723B3F2699A994E8EFBD93E16C173142F18BC9F19E2066BCB4B2906182D6D03C26EDDE147813A6F09F7FBCA78F0F84D6A1ED75ACDCD21A36A9119BDCB29B53C686C4108CD598E170D6A59717E43B77A58E93D6B7368F95415C38646F9D549051E2E87898E991AC58777A2D25BA0B22B82437788ECD92AB9AF0C47EF8661230F93D799DA0E782C04E011071938664C17166C462D91A6C1C2DEE0A3392A72C83C5FB495"),
                Utility.hexToBytes("379D2375DCAD289C364CA2051A24B47C843AFD41F69C81D3DAA9FCF934CAA073CC2DE49700C9404947A4F748820502353BD00960951383F42451154AB71B0CA566E0860795CD4DC38A2414D817174B9562A0E2132C548EC636A7C3806F0058389C37BC421C446FE46B77A0B61E2030E8877028EA5DDB646E9867F392DAE721DAAC0A3EB20885351784A235192BE61D028CDF3505209D97BAFA9B9A00F614862DC82A81DE826CB59DB01796193A1F416C49EE7CA8D2A31C3DEC8D05572B6B20E57E53D8C52EC37FA05EDE4279A2BB249F3BB02AEACE43F9CF47CD4A2338BC35218386E24699961A7C3620780A3FDCA5142E9E3E30B73E228F8C2E8953942F066195D26FE2B8BA6AF5A14AFACA034D6E9FE9BD9DEA58D1AC627B2D3CFD0D4E2C3958335AED080C5E94B2B27341B5894CE9DFCA403C7DB63B0D2FFC2B631A6F46133C3E6D08C5897642C9CE81FA4E450190E4A6044E1B2D34900B2C3ADB64005D974298B367105D6B5EA4346BB65EA95ACAF3C8817135A2D49F501328F064BA85EFEC864C55424FBF0AAA0C8F5E5CDFC7FF4D2A75128F9C2694668219543C907B560CB4D991B29343001D75BA06200290E2302CFBDD7F6172BED18ED6779DCB516F294E5C7CB5F87D5D77FF340A76B2282E9B445FE744F3877CDDD7B2DEA5AA3B6D368448C9E4919516FC596B51BAC0E2E45B7113A70FBBD672013C29F73141382DBF4AB716F8E18B2B38E2D67DC2D1CC3D471C7313A78B36457F660DC71A462F6728EB4DC14D434F06F0450F12DB49D460C819CFDAEE87BF03EABACFA729D2BD47B6B1C3F12B3BF7753DCCA75F87FD6FB5473D7084D8A1FCE62ABE01AA803B605889D98B1E749FC931607103814C0B0525210086853D905D898FCDEC377A106ADB611732B4639BE8B0189A54BC9E17B395DA2DC792342A6BA8498CEBAE814E559938A34A7B25F990C413EF260CAE3DE35119AC6631F81DBA61ACE348BF7732169278F64BD607572625F9A434F7C34F40E336DEBDA27D053E9216305AB1778E19967E51BEE26370B58F2844C40BD6844752CB0F352A34DC851DADC0B85AA239C7BC23932135F3537108415C4BD23B5DFF4D04C63D371D8A0046D946A601CB0841D61CE3C30419B0D4F9FD111B6526675A9109A13079D6E581666574E11DFE1AD5313E5AABDE390C2DE1A8BA9AF6534E80E2AA73F8B64B93C88E2030908C075C6F2A"));

        String address = "VFtmKMZzjx9JbyAgX3G6Y8Ri3Ho9uW";

        LedgerProofOfExistence proofOfExistence = new LedgerProofOfExistence(verticalLayers);

        Assert.assertNotEquals(Utility.bytesToHex(proofOfExistence.getLedgerHash()).toUpperCase(), Utility.hexToBytes("7BEBDCECA669943E16000F3B657322B7AD0D5DD012660A59"));
    }

    @Test
    public void invalidExistenceProof_6() {
        LedgerProofNode[] verticalLayers = new LedgerProofNode[4];

        verticalLayers[0] = new LedgerProofNode("mKMZzjx9JbyAgX3G6Y8Ri3Ho9uW".toCharArray(),
                new LedgerValue(9370812, 0, 0));

        // Invalid right child hashes
        verticalLayers[1] = new LedgerProofNode("t".toCharArray(),
                Utility.hexToBytes(""),
                Utility.hexToBytes("E65653591A85030C479432F80D0412D0234FFFC3083746CBE88281ECB65B3205"));

        verticalLayers[2] = new LedgerProofNode("F".toCharArray(),
                Utility.hexToBytes("4A5163B1682399D168D5216382E72BAF0E20C369BBC91306F5BF5FF54FEA7FCAE5E97FDF29406E8A7E99D4C5694804092464E932478FD174926801BAF4D7C31F552FE48569410CA7579111FF4359D29D3F980C276CB08F2524AB2CAAEC208AF3A8BD0B65CCB50B7A2ADE64B8A0B5BB0CA63B778834C5E156DC55BC7904B7295A27CC7A7D3B39E3C3E07D680A1336C931081D190080F7AC06A06EB1F6FE2EBEEEEDE1D97CCD97A5FD0887E5507F0646C773DF5E60B93E76DFD4A3015281DA6682E16F07D812829BCA0051C2C96655A9EA53AC353AD8B7DE814B9ABF8DF249122102958AE0016DB97509A3038A3812AE431B9F2B222DD81BCF657F16D1449463896DE15581B089F866F9FC65F6F77BD1D6A3845D2565F70D6A8219DDA79274208BACEB768A49F64EFAA7AB9F20C24191188E8785325DE3D5590EDCD7A0C890645FF0D5708F6A0F0F6BA699C75F8AEFD7479BC9D02CE2F41CDBCDC1B0535B0324F7970C4B88DB9877261A4874BD2CCF0BF60C809C85E8DC370E138A0B3C3F59003D4D06606B1750FCCC43A543743E878A3E87431CE2368D12261EB3235A3835705E51E78593C1FA52B8425663021A20F50B656F61AAA36AFD65E0DC9059559EB77739B9D7F73B136547FC4FC298C0A7B9A9F6C1664600D44072A38EAB76E0D335B64D04B763457199599D75A88ACA7ADBA3A2987AC2DE3449D7E3A481432DDAAB8AA7580072BFC1ACAE6C810D57771C773D6CB727058AC27F5AE8AC06FB2034ECC93DFD971008BE0FF99F767C645D1F35DE6F6FC9FACD388133BCACE9B6C9A819F4B8C01E3FFD7D3D8B9D2B8B4FA7971AF45849D1DD8DB30E01902FF31ED32C7D632E42463FC8D424D387672ED4DB30367EBD01A7C4475C3B500A6B6E191CD1E015CC3761A8A7C7DA34FA941ADB254C3C3EC300984D25850097F5754CC1F12E69D20EDADBFC5ED4A56494A63BB462CA2DC1E3DBAC8CDB8879E230E2C20B7D5D99F6D63BDE2704C8E94E979DD325ABD4E382EB22EDA8D80D2DA393D156A1F67F599422A6FDB7DF4D1F69C1EA3D5CB5E1CE641725076305C089C1A281EE445911FCBAEA753EB05CE4CFA0755398BAC8B85192AFDF9B2B7ADC545DF36B3EABEC61640856CD174A5D9E0E1107B37E61DAAD47A0702D2F5EDDAFB4FA299D98FC7E300091C0FB56BB0CEA1DB529204590294AA41B5CA483181A36FB312C16262859289A0E61B3822EAF119D6EE0CBB1FE6FBA2FC8799102C92E16A1570F2E701B8E07ACF7E0F03904EBE2B8001BF5F095F54789898233F790352297E9472D1AC2328BB9C8B223B24C2A76EDD11382FC4F20851A5D0749D0063A64333EE531546740C9C84C"),
                Utility.hexToBytes("62D5512D3329AF12D38707D7DF3D327A8CE4D91807962ACE770AF157599596CC2C002880EAC7DDE92378437EEB0E0C59192671A647953955FEEEB5B079A20421C936BA4AF425879B42B3A5394A8EA467F3C2693444CFFC5AB430EFA6D6849881C7C0F05DDB350F05F45CB973EA0EB0676E19084192BE18B6A81799CD02311D2E3530CDCC1E5BDFA3655D083166A85FC50D28668595DC9A9B24C8B96737C324B5"));

        verticalLayers[3] = new LedgerProofNode("V".toCharArray(),
                Utility.hexToBytes("5F40073859A8A4E4FEF7DE6BB13902967E491D8471C8DA4B8DD3A95B8755E2E4810C18A5F1D9E9A273931345FF4BDD4F5E64980C861FF74EE7B4AD76A44F043DAA3CD5AD220063907C5B184F1F9045491B01340CF3F422E02FD66C99DCDCE6193CAD49F3136780017ACC39DB6F031041F9DCEF1AE32EFABBA9542EBC94E9A29057F43CD7A164F7A11B75A74949965BE67286AC84EB9AC550D97B7EB229BFDBE1EB4E797DC3CEBE849AA1178E7F93F16108FBB58BDAF0ED8AABFC9C1BE23D7D0DE5E53AA591BCC86380BAC16EFF02A9568C78EC255989D76590C530901BC5EA6E8FAF405AD14082446413616FCC2FAB6C7323A047A9D6EB8A526F9A4CCDB8D811776CE8DC179623C44CCFD25B40226E936D61264D3C74F082D0ADE06DC2F723B3F2699A994E8EFBD93E16C173142F18BC9F19E2066BCB4B2906182D6D03C26EDDE147813A6F09F7FBCA78F0F84D6A1ED75ACDCD21A36A9119BDCB29B53C686C4108CD598E170D6A59717E43B77A58E93D6B7368F95415C38646F9D549051E2E87898E991AC58777A2D25BA0B22B82437788ECD92AB9AF0C47EF8661230F93D799DA0E782C04E011071938664C17166C462D91A6C1C2DEE0A3392A72C83C5FB495"),
                Utility.hexToBytes("379D2375DCAD289C364CA2051A24B47C843AFD41F69C81D3DAA9FCF934CAA073CC2DE49700C9404947A4F748820502353BD00960951383F42451154AB71B0CA566E0860795CD4DC38A2414D817174B9562A0E2132C548EC636A7C3806F0058389C37BC421C446FE46B77A0B61E2030E8877028EA5DDB646E9867F392DAE721DAAC0A3EB20885351784A235192BE61D028CDF3505209D97BAFA9B9A00F614862DC82A81DE826CB59DB01796193A1F416C49EE7CA8D2A31C3DEC8D05572B6B20E57E53D8C52EC37FA05EDE4279A2BB249F3BB02AEACE43F9CF47CD4A2338BC35218386E24699961A7C3620780A3FDCA5142E9E3E30B73E228F8C2E8953942F066195D26FE2B8BA6AF5A14AFACA034D6E9FE9BD9DEA58D1AC627B2D3CFD0D4E2C3958335AED080C5E94B2B27341B5894CE9DFCA403C7DB63B0D2FFC2B631A6F46133C3E6D08C5897642C9CE81FA4E450190E4A6044E1B2D34900B2C3ADB64005D974298B367105D6B5EA4346BB65EA95ACAF3C8817135A2D49F501328F064BA85EFEC864C55424FBF0AAA0C8F5E5CDFC7FF4D2A75128F9C2694668219543C907B560CB4D991B29343001D75BA06200290E2302CFBDD7F6172BED18ED6779DCB516F294E5C7CB5F87D5D77FF340A76B2282E9B445FE744F3877CDDD7B2DEA5AA3B6D368448C9E4919516FC596B51BAC0E2E45B7113A70FBBD672013C29F73141382DBF4AB716F8E18B2B38E2D67DC2D1CC3D471C7313A78B36457F660DC71A462F6728EB4DC14D434F06F0450F12DB49D460C819CFDAEE87BF03EABACFA729D2BD47B6B1C3F12B3BF7753DCCA75F87FD6FB5473D7084D8A1FCE62ABE01AA803B605889D98B1E749FC931607103814C0B0525210086853D905D898FCDEC377A106ADB611732B4639BE8B0189A54BC9E17B395DA2DC792342A6BA8498CEBAE814E559938A34A7B25F990C413EF260CAE3DE35119AC6631F81DBA61ACE348BF7732169278F64BD607572625F9A434F7C34F40E336DEBDA27D053E9216305AB1778E19967E51BEE26370B58F2844C40BD6844752CB0F352A34DC851DADC0B85AA239C7BC23932135F3537108415C4BD23B5DFF4D04C63D371D8A0046D946A601CB0841D61CE3C30419B0D4F9FD111B6526675A9109A13079D6E581666574E11DFE1AD5313E5AABDE390C2DE1A8BA9AF6534E80E2AA73F8B64B93C88E2030908C075C6F2A"));

        String address = "VFtmKMZzjx9JbyAgX3G6Y8Ri3Ho9uW";

        LedgerProofOfExistence proofOfExistence = new LedgerProofOfExistence(verticalLayers);

        Assert.assertNotEquals(Utility.bytesToHex(proofOfExistence.getLedgerHash()).toUpperCase(), Utility.hexToBytes("7BEBDCECA669943E16000F3B657322B7AD0D5DD012660A59"));
    }

    @Test
    public void invalidExistenceProof_7() {
        LedgerProofNode[] verticalLayers = new LedgerProofNode[4];

        verticalLayers[0] = new LedgerProofNode("mKMZzjx9JbyAgX3G6Y8Ri3Ho9uW".toCharArray(),
                new LedgerValue(9370812, 0, 0));

        verticalLayers[1] = new LedgerProofNode("t".toCharArray(),
                Utility.hexToBytes(""),
                Utility.hexToBytes("E65653591A85030C479432F80D0412D0234FFFC3083746CBE88281ECB65B3204"));

        // Invalid right child hashes
        verticalLayers[2] = new LedgerProofNode("F".toCharArray(),
                Utility.hexToBytes("4A5163B1682399D168D5216382E72BAF0E20C369BBC91306F5BF5FF54FEA7FCAE5E97FDF29406E8A7E99D4C5694804092464E932478FD174926801BAF4D7C31F552FE48569410CA7579111FF4359D29D3F980C276CB08F2524AB2CAAEC208AF3A8BD0B65CCB50B7A2ADE64B8A0B5BB0CA63B778834C5E156DC55BC7904B7295A27CC7A7D3B39E3C3E07D680A1336C931081D190080F7AC06A06EB1F6FE2EBEEEEDE1D97CCD97A5FD0887E5507F0646C773DF5E60B93E76DFD4A3015281DA6682E16F07D812829BCA0051C2C96655A9EA53AC353AD8B7DE814B9ABF8DF249122102958AE0016DB97509A3038A3812AE431B9F2B222DD81BCF657F16D1449463896DE15581B089F866F9FC65F6F77BD1D6A3845D2565F70D6A8219DDA79274208BACEB768A49F64EFAA7AB9F20C24191188E8785325DE3D5590EDCD7A0C890645FF0D5708F6A0F0F6BA699C75F8AEFD7479BC9D02CE2F41CDBCDC1B0535B0324F7970C4B88DB9877261A4874BD2CCF0BF60C809C85E8DC370E138A0B3C3F59003D4D06606B1750FCCC43A543743E878A3E87431CE2368D12261EB3235A3835705E51E78593C1FA52B8425663021A20F50B656F61AAA36AFD65E0DC9059559EB77739B9D7F73B136547FC4FC298C0A7B9A9F6C1664600D44072A38EAB76E0D335B64D04B763457199599D75A88ACA7ADBA3A2987AC2DE3449D7E3A481432DDAAB8AA7580072BFC1ACAE6C810D57771C773D6CB727058AC27F5AE8AC06FB2034ECC93DFD971008BE0FF99F767C645D1F35DE6F6FC9FACD388133BCACE9B6C9A819F4B8C01E3FFD7D3D8B9D2B8B4FA7971AF45849D1DD8DB30E01902FF31ED32C7D632E42463FC8D424D387672ED4DB30367EBD01A7C4475C3B500A6B6E191CD1E015CC3761A8A7C7DA34FA941ADB254C3C3EC300984D25850097F5754CC1F12E69D20EDADBFC5ED4A56494A63BB462CA2DC1E3DBAC8CDB8879E230E2C20B7D5D99F6D63BDE2704C8E94E979DD325ABD4E382EB22EDA8D80D2DA393D156A1F67F599422A6FDB7DF4D1F69C1EA3D5CB5E1CE641725076305C089C1A281EE445911FCBAEA753EB05CE4CFA0755398BAC8B85192AFDF9B2B7ADC545DF36B3EABEC61640856CD174A5D9E0E1107B37E61DAAD47A0702D2F5EDDAFB4FA299D98FC7E300091C0FB56BB0CEA1DB529204590294AA41B5CA483181A36FB312C16262859289A0E61B3822EAF119D6EE0CBB1FE6FBA2FC8799102C92E16A1570F2E701B8E07ACF7E0F03904EBE2B8001BF5F095F54789898233F790352297E9472D1AC2328BB9C8B223B24C2A76EDD11382FC4F20851A5D0749D0063A64333EE531546740C9C84C"),
                Utility.hexToBytes("62D5512D3329AF12D38707D7DF3D327A8CE4D91807962ACE770AF157599596CC2C002880EAC7DDE92378437EEB0E0C59192671A647953955FEE0B5B079A20421C936BA4AF425879B42B3A5394A8EA467F3C2693444CFFC5AB430EFA6D6849881C7C0F05DDB350F05F45CB973EA0EB0676E19084192BE18B6A81799CD02311D2E3530CDCC1E5BDFA3655D083166A85FC50D28668595DC9A9B24C8B96737C324B5"));

        verticalLayers[3] = new LedgerProofNode("V".toCharArray(),
                Utility.hexToBytes("5F40073859A8A4E4FEF7DE6BB13902967E491D8471C8DA4B8DD3A95B8755E2E4810C18A5F1D9E9A273931345FF4BDD4F5E64980C861FF74EE7B4AD76A44F043DAA3CD5AD220063907C5B184F1F9045491B01340CF3F422E02FD66C99DCDCE6193CAD49F3136780017ACC39DB6F031041F9DCEF1AE32EFABBA9542EBC94E9A29057F43CD7A164F7A11B75A74949965BE67286AC84EB9AC550D97B7EB229BFDBE1EB4E797DC3CEBE849AA1178E7F93F16108FBB58BDAF0ED8AABFC9C1BE23D7D0DE5E53AA591BCC86380BAC16EFF02A9568C78EC255989D76590C530901BC5EA6E8FAF405AD14082446413616FCC2FAB6C7323A047A9D6EB8A526F9A4CCDB8D811776CE8DC179623C44CCFD25B40226E936D61264D3C74F082D0ADE06DC2F723B3F2699A994E8EFBD93E16C173142F18BC9F19E2066BCB4B2906182D6D03C26EDDE147813A6F09F7FBCA78F0F84D6A1ED75ACDCD21A36A9119BDCB29B53C686C4108CD598E170D6A59717E43B77A58E93D6B7368F95415C38646F9D549051E2E87898E991AC58777A2D25BA0B22B82437788ECD92AB9AF0C47EF8661230F93D799DA0E782C04E011071938664C17166C462D91A6C1C2DEE0A3392A72C83C5FB495"),
                Utility.hexToBytes("379D2375DCAD289C364CA2051A24B47C843AFD41F69C81D3DAA9FCF934CAA073CC2DE49700C9404947A4F748820502353BD00960951383F42451154AB71B0CA566E0860795CD4DC38A2414D817174B9562A0E2132C548EC636A7C3806F0058389C37BC421C446FE46B77A0B61E2030E8877028EA5DDB646E9867F392DAE721DAAC0A3EB20885351784A235192BE61D028CDF3505209D97BAFA9B9A00F614862DC82A81DE826CB59DB01796193A1F416C49EE7CA8D2A31C3DEC8D05572B6B20E57E53D8C52EC37FA05EDE4279A2BB249F3BB02AEACE43F9CF47CD4A2338BC35218386E24699961A7C3620780A3FDCA5142E9E3E30B73E228F8C2E8953942F066195D26FE2B8BA6AF5A14AFACA034D6E9FE9BD9DEA58D1AC627B2D3CFD0D4E2C3958335AED080C5E94B2B27341B5894CE9DFCA403C7DB63B0D2FFC2B631A6F46133C3E6D08C5897642C9CE81FA4E450190E4A6044E1B2D34900B2C3ADB64005D974298B367105D6B5EA4346BB65EA95ACAF3C8817135A2D49F501328F064BA85EFEC864C55424FBF0AAA0C8F5E5CDFC7FF4D2A75128F9C2694668219543C907B560CB4D991B29343001D75BA06200290E2302CFBDD7F6172BED18ED6779DCB516F294E5C7CB5F87D5D77FF340A76B2282E9B445FE744F3877CDDD7B2DEA5AA3B6D368448C9E4919516FC596B51BAC0E2E45B7113A70FBBD672013C29F73141382DBF4AB716F8E18B2B38E2D67DC2D1CC3D471C7313A78B36457F660DC71A462F6728EB4DC14D434F06F0450F12DB49D460C819CFDAEE87BF03EABACFA729D2BD47B6B1C3F12B3BF7753DCCA75F87FD6FB5473D7084D8A1FCE62ABE01AA803B605889D98B1E749FC931607103814C0B0525210086853D905D898FCDEC377A106ADB611732B4639BE8B0189A54BC9E17B395DA2DC792342A6BA8498CEBAE814E559938A34A7B25F990C413EF260CAE3DE35119AC6631F81DBA61ACE348BF7732169278F64BD607572625F9A434F7C34F40E336DEBDA27D053E9216305AB1778E19967E51BEE26370B58F2844C40BD6844752CB0F352A34DC851DADC0B85AA239C7BC23932135F3537108415C4BD23B5DFF4D04C63D371D8A0046D946A601CB0841D61CE3C30419B0D4F9FD111B6526675A9109A13079D6E581666574E11DFE1AD5313E5AABDE390C2DE1A8BA9AF6534E80E2AA73F8B64B93C88E2030908C075C6F2A"));

        String address = "VFtmKMZzjx9JbyAgX3G6Y8Ri3Ho9uW";

        LedgerProofOfExistence proofOfExistence = new LedgerProofOfExistence(verticalLayers);

        Assert.assertNotEquals(Utility.bytesToHex(proofOfExistence.getLedgerHash()).toUpperCase(), Utility.hexToBytes("7BEBDCECA669943E16000F3B657322B7AD0D5DD012660A59"));
    }

    @Test
    public void invalidExistenceProof_8() {
        LedgerProofNode[] verticalLayers = new LedgerProofNode[4];

        verticalLayers[0] = new LedgerProofNode("mKMZzjx9JbyAgX3G6Y8Ri3Ho9uW".toCharArray(),
                new LedgerValue(9370812, 0, 0));

        verticalLayers[1] = new LedgerProofNode("t".toCharArray(),
                Utility.hexToBytes(""),
                Utility.hexToBytes("E65653591A85030C479432F80D0412D0234FFFC3083746CBE88281ECB65B3204"));

        // Invalid route
        verticalLayers[2] = new LedgerProofNode("E".toCharArray(),
                Utility.hexToBytes("4A5163B1682399D168D5216382E72BAF0E20C369BBC91306F5BF5FF54FEA7FCAE5E97FDF29406E8A7E99D4C5694804092464E932478FD174926801BAF4D7C31F552FE48569410CA7579111FF4359D29D3F980C276CB08F2524AB2CAAEC208AF3A8BD0B65CCB50B7A2ADE64B8A0B5BB0CA63B778834C5E156DC55BC7904B7295A27CC7A7D3B39E3C3E07D680A1336C931081D190080F7AC06A06EB1F6FE2EBEEEEDE1D97CCD97A5FD0887E5507F0646C773DF5E60B93E76DFD4A3015281DA6682E16F07D812829BCA0051C2C96655A9EA53AC353AD8B7DE814B9ABF8DF249122102958AE0016DB97509A3038A3812AE431B9F2B222DD81BCF657F16D1449463896DE15581B089F866F9FC65F6F77BD1D6A3845D2565F70D6A8219DDA79274208BACEB768A49F64EFAA7AB9F20C24191188E8785325DE3D5590EDCD7A0C890645FF0D5708F6A0F0F6BA699C75F8AEFD7479BC9D02CE2F41CDBCDC1B0535B0324F7970C4B88DB9877261A4874BD2CCF0BF60C809C85E8DC370E138A0B3C3F59003D4D06606B1750FCCC43A543743E878A3E87431CE2368D12261EB3235A3835705E51E78593C1FA52B8425663021A20F50B656F61AAA36AFD65E0DC9059559EB77739B9D7F73B136547FC4FC298C0A7B9A9F6C1664600D44072A38EAB76E0D335B64D04B763457199599D75A88ACA7ADBA3A2987AC2DE3449D7E3A481432DDAAB8AA7580072BFC1ACAE6C810D57771C773D6CB727058AC27F5AE8AC06FB2034ECC93DFD971008BE0FF99F767C645D1F35DE6F6FC9FACD388133BCACE9B6C9A819F4B8C01E3FFD7D3D8B9D2B8B4FA7971AF45849D1DD8DB30E01902FF31ED32C7D632E42463FC8D424D387672ED4DB30367EBD01A7C4475C3B500A6B6E191CD1E015CC3761A8A7C7DA34FA941ADB254C3C3EC300984D25850097F5754CC1F12E69D20EDADBFC5ED4A56494A63BB462CA2DC1E3DBAC8CDB8879E230E2C20B7D5D99F6D63BDE2704C8E94E979DD325ABD4E382EB22EDA8D80D2DA393D156A1F67F599422A6FDB7DF4D1F69C1EA3D5CB5E1CE641725076305C089C1A281EE445911FCBAEA753EB05CE4CFA0755398BAC8B85192AFDF9B2B7ADC545DF36B3EABEC61640856CD174A5D9E0E1107B37E61DAAD47A0702D2F5EDDAFB4FA299D98FC7E300091C0FB56BB0CEA1DB529204590294AA41B5CA483181A36FB312C16262859289A0E61B3822EAF119D6EE0CBB1FE6FBA2FC8799102C92E16A1570F2E701B8E07ACF7E0F03904EBE2B8001BF5F095F54789898233F790352297E9472D1AC2328BB9C8B223B24C2A76EDD11382FC4F20851A5D0749D0063A64333EE531546740C9C84C"),
                Utility.hexToBytes("62D5512D3329AF12D38707D7DF3D327A8CE4D91807962ACE770AF157599596CC2C002880EAC7DDE92378437EEB0E0C59192671A647953955FEEEB5B079A20421C936BA4AF425879B42B3A5394A8EA467F3C2693444CFFC5AB430EFA6D6849881C7C0F05DDB350F05F45CB973EA0EB0676E19084192BE18B6A81799CD02311D2E3530CDCC1E5BDFA3655D083166A85FC50D28668595DC9A9B24C8B96737C324B5"));

        verticalLayers[3] = new LedgerProofNode("V".toCharArray(),
                Utility.hexToBytes("5F40073859A8A4E4FEF7DE6BB13902967E491D8471C8DA4B8DD3A95B8755E2E4810C18A5F1D9E9A273931345FF4BDD4F5E64980C861FF74EE7B4AD76A44F043DAA3CD5AD220063907C5B184F1F9045491B01340CF3F422E02FD66C99DCDCE6193CAD49F3136780017ACC39DB6F031041F9DCEF1AE32EFABBA9542EBC94E9A29057F43CD7A164F7A11B75A74949965BE67286AC84EB9AC550D97B7EB229BFDBE1EB4E797DC3CEBE849AA1178E7F93F16108FBB58BDAF0ED8AABFC9C1BE23D7D0DE5E53AA591BCC86380BAC16EFF02A9568C78EC255989D76590C530901BC5EA6E8FAF405AD14082446413616FCC2FAB6C7323A047A9D6EB8A526F9A4CCDB8D811776CE8DC179623C44CCFD25B40226E936D61264D3C74F082D0ADE06DC2F723B3F2699A994E8EFBD93E16C173142F18BC9F19E2066BCB4B2906182D6D03C26EDDE147813A6F09F7FBCA78F0F84D6A1ED75ACDCD21A36A9119BDCB29B53C686C4108CD598E170D6A59717E43B77A58E93D6B7368F95415C38646F9D549051E2E87898E991AC58777A2D25BA0B22B82437788ECD92AB9AF0C47EF8661230F93D799DA0E782C04E011071938664C17166C462D91A6C1C2DEE0A3392A72C83C5FB495"),
                Utility.hexToBytes("379D2375DCAD289C364CA2051A24B47C843AFD41F69C81D3DAA9FCF934CAA073CC2DE49700C9404947A4F748820502353BD00960951383F42451154AB71B0CA566E0860795CD4DC38A2414D817174B9562A0E2132C548EC636A7C3806F0058389C37BC421C446FE46B77A0B61E2030E8877028EA5DDB646E9867F392DAE721DAAC0A3EB20885351784A235192BE61D028CDF3505209D97BAFA9B9A00F614862DC82A81DE826CB59DB01796193A1F416C49EE7CA8D2A31C3DEC8D05572B6B20E57E53D8C52EC37FA05EDE4279A2BB249F3BB02AEACE43F9CF47CD4A2338BC35218386E24699961A7C3620780A3FDCA5142E9E3E30B73E228F8C2E8953942F066195D26FE2B8BA6AF5A14AFACA034D6E9FE9BD9DEA58D1AC627B2D3CFD0D4E2C3958335AED080C5E94B2B27341B5894CE9DFCA403C7DB63B0D2FFC2B631A6F46133C3E6D08C5897642C9CE81FA4E450190E4A6044E1B2D34900B2C3ADB64005D974298B367105D6B5EA4346BB65EA95ACAF3C8817135A2D49F501328F064BA85EFEC864C55424FBF0AAA0C8F5E5CDFC7FF4D2A75128F9C2694668219543C907B560CB4D991B29343001D75BA06200290E2302CFBDD7F6172BED18ED6779DCB516F294E5C7CB5F87D5D77FF340A76B2282E9B445FE744F3877CDDD7B2DEA5AA3B6D368448C9E4919516FC596B51BAC0E2E45B7113A70FBBD672013C29F73141382DBF4AB716F8E18B2B38E2D67DC2D1CC3D471C7313A78B36457F660DC71A462F6728EB4DC14D434F06F0450F12DB49D460C819CFDAEE87BF03EABACFA729D2BD47B6B1C3F12B3BF7753DCCA75F87FD6FB5473D7084D8A1FCE62ABE01AA803B605889D98B1E749FC931607103814C0B0525210086853D905D898FCDEC377A106ADB611732B4639BE8B0189A54BC9E17B395DA2DC792342A6BA8498CEBAE814E559938A34A7B25F990C413EF260CAE3DE35119AC6631F81DBA61ACE348BF7732169278F64BD607572625F9A434F7C34F40E336DEBDA27D053E9216305AB1778E19967E51BEE26370B58F2844C40BD6844752CB0F352A34DC851DADC0B85AA239C7BC23932135F3537108415C4BD23B5DFF4D04C63D371D8A0046D946A601CB0841D61CE3C30419B0D4F9FD111B6526675A9109A13079D6E581666574E11DFE1AD5313E5AABDE390C2DE1A8BA9AF6534E80E2AA73F8B64B93C88E2030908C075C6F2A"));

        String address = "VFtmKMZzjx9JbyAgX3G6Y8Ri3Ho9uW";

        LedgerProofOfExistence proofOfExistence = new LedgerProofOfExistence(verticalLayers);

        Assert.assertNotEquals(Utility.bytesToHex(proofOfExistence.getLedgerHash()).toUpperCase(), Utility.hexToBytes("7BEBDCECA669943E16000F3B657322B7AD0D5DD012660A59"));

        Assert.assertNotEquals(proofOfExistence.getAddress(), address);
    }
}
